,db_id,original_sql,rewritten_sql_gpt,activated_rules_gpt,prompt_sql_similar,prompt_rules_similar
0,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 20 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 20 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 45 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
1,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'MACHINERY' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-07' and l_shipdate > date '1995-03-07' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'MACHINERY' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-07' and l_shipdate > date '1995-03-07' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('37', '24', '41', '21', '36', '28', '22') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('37', '24', '41', '21', '36', '28', '22') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
2,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1994-01-01' and o_orderdate < date '1994-01-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1994-01-01' and o_orderdate < date '1994-01-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 43 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
3,tpch,"select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and o_orderdate >= date '1994-01-01' and o_orderdate < date '1994-01-01' + interval '1' year group by n_name order by revenue desc;","SELECT nation.n_name, SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS revenue FROM customer INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1994-01-01' AND o_orderdate < (DATE '1994-01-01' + INTERVAL '1' YEAR)) AS t ON customer.c_custkey = t.o_custkey INNER JOIN lineitem ON t.o_orderkey = lineitem.l_orderkey INNER JOIN supplier ON lineitem.l_suppkey = supplier.s_suppkey AND customer.c_nationkey = supplier.s_nationkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'EUROPE') AS t0 ON nation.n_regionkey = t0.r_regionkey GROUP BY nation.n_name ORDER BY SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) DESC","['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_AGGREGATE_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE', 'SORT_PROJECT_TRANSPOSE']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#42' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 1 and l_quantity <= 1 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#53' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 19 and l_quantity <= 19 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#34' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 28 and l_quantity <= 28 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_INTO_JOIN', 'PROJECT_CORRELATE_TRANSPOSE', 'FILTER_AGGREGATE_TRANSPOSE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'JOIN_CONDITION_PUSH', 'AGGREGATE_PROJECT_MERGE']""]"
4,tpch,select sum(l_extendedprice * l_discount) as revenue from lineitem where l_shipdate >= date '1994-01-01' and l_shipdate < date '1994-01-01' + interval '1' year and l_discount between 0.07 - 0.01 and 0.07 + 0.01 and l_quantity < 25;,SELECT SUM(l_extendedprice * l_discount) AS revenue FROM lineitem WHERE l_shipdate >= DATE '1994-01-01' AND l_shipdate < (DATE '1994-01-01' + INTERVAL '1' YEAR) AND l_discount >= 0.07 - 0.01 AND l_discount <= 0.07 + 0.01 AND l_quantity < 25,"['FILTER_REDUCE_EXPRESSIONS', 'FILTER_SCAN', 'AGGREGATE_PROJECT_MERGE']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#43' and p_type not like 'MEDIUM BURNISHED%' and p_size in (50, 6, 34, 48, 12, 37, 27, 45) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_INTO_JOIN', 'FILTER_SCAN', 'FILTER_MERGE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE']""]"
5,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'PERU' and n2.n_name = 'ROMANIA') or (n1.n_name = 'ROMANIA' and n2.n_name = 'PERU') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation.n_name AS supp_nation, nation0.n_name AS cust_nation, EXTRACT(YEAR FROM lineitem.l_shipdate) AS l_year, SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS revenue FROM supplier, lineitem, orders, customer, nation, nation AS nation0 WHERE supplier.s_suppkey = lineitem.l_suppkey AND orders.o_orderkey = lineitem.l_orderkey AND (customer.c_custkey = orders.o_custkey AND supplier.s_nationkey = nation.n_nationkey) AND (customer.c_nationkey = nation0.n_nationkey AND (nation.n_name = 'PERU' AND nation0.n_name = 'ROMANIA' OR nation.n_name = 'ROMANIA' AND nation0.n_name = 'PERU') AND (lineitem.l_shipdate >= DATE '1995-01-01' AND lineitem.l_shipdate <= DATE '1996-12-31')) GROUP BY nation.n_name, nation0.n_name, EXTRACT(YEAR FROM lineitem.l_shipdate) ORDER BY nation.n_name, nation0.n_name, EXTRACT(YEAR FROM lineitem.l_shipdate)","['JOIN_CONDITION_PUSH', 'FILTER_MERGE', 'AGGREGATE_PROJECT_MERGE', 'SORT_REMOVE_CONSTANT_KEYS']","[""select c_count, count(*) as custdist from ( select c_custkey, count(o_orderkey) from customer left outer join orders on c_custkey = o_custkey and o_comment not like '%express%deposits%' group by c_custkey ) as c_orders (c_custkey, c_count) group by c_count order by custdist desc, c_count desc;""]","[""['FILTER_TABLE_FUNCTION_TRANSPOSE', 'JOIN_CONDITION_PUSH', 'AGGREGATE_PROJECT_MERGE', 'FILTER_AGGREGATE_TRANSPOSE', 'FILTER_CORRELATE', 'PROJECT_CORRELATE_TRANSPOSE', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE']""]"
6,tpch,"select o_year, sum(case when nation = 'ROMANIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE POLISHED STEEL' ) as all_nations group by o_year order by o_year;","select o_year, sum(case when nation = 'ROMANIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE POLISHED STEEL' ) as all_nations group by o_year order by o_year",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 17 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
7,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%olive%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation.n_name AS nation, EXTRACT(YEAR FROM orders.o_orderdate) AS o_year, SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount) - partsupp.ps_supplycost * lineitem.l_quantity) AS sum_profit FROM part, supplier, lineitem, partsupp, orders, nation WHERE supplier.s_suppkey = lineitem.l_suppkey AND (partsupp.ps_suppkey = lineitem.l_suppkey AND partsupp.ps_partkey = lineitem.l_partkey) AND (part.p_partkey = lineitem.l_partkey AND orders.o_orderkey = lineitem.l_orderkey AND (supplier.s_nationkey = nation.n_nationkey AND part.p_name LIKE '%olive%')) GROUP BY nation.n_name, EXTRACT(YEAR FROM orders.o_orderdate) ORDER BY nation.n_name, EXTRACT(YEAR FROM orders.o_orderdate) DESC","['FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_PROJECT_TRANSPOSE', 'JOIN_CONDITION_PUSH', 'AGGREGATE_PROJECT_MERGE']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#53' and p_type not like 'LARGE POLISHED%' and p_size in (42, 9, 44, 7, 34, 26, 14, 36) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_MERGE', 'FILTER_INTO_JOIN', 'FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_PROJECT_TRANSPOSE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_REMOVE', 'FILTER_CORRELATE']""]"
8,tpch,"select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from customer, orders, lineitem, nation where c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate >= date '1993-10-01' and o_orderdate < date '1993-10-01' + interval '3' month and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc;","SELECT customer.c_custkey, customer.c_name, SUM(t0.l_extendedprice * (1 - t0.l_discount)) AS revenue, customer.c_acctbal, nation.n_name, customer.c_address, customer.c_phone, customer.c_comment FROM customer INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1993-10-01' AND o_orderdate < (DATE '1993-10-01' + INTERVAL '3' MONTH)) AS t ON customer.c_custkey = t.o_custkey INNER JOIN (SELECT * FROM lineitem WHERE l_returnflag = 'R') AS t0 ON t.o_orderkey = t0.l_orderkey INNER JOIN nation ON customer.c_nationkey = nation.n_nationkey GROUP BY customer.c_custkey, customer.c_name, customer.c_acctbal, customer.c_phone, nation.n_name, customer.c_address, customer.c_comment ORDER BY SUM(t0.l_extendedprice * (1 - t0.l_discount)) DESC","['FILTER_PROJECT_TRANSPOSE', 'FILTER_INTO_JOIN', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'JOIN_CONDITION_PUSH', 'PROJECT_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE', 'SORT_PROJECT_TRANSPOSE']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#53' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 8 and l_quantity <= 8 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#11' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 14 and l_quantity <= 14 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#52' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 27 and l_quantity <= 27 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_PROJECT_TRANSPOSE', 'FILTER_INTO_JOIN', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'JOIN_CONDITION_PUSH', 'PROJECT_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES']""]"
9,tpch,"select ps_partkey, sum(ps_supplycost * ps_availqty) as value from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'PERU' group by ps_partkey having sum(ps_supplycost * ps_availqty) > ( select sum(ps_supplycost * ps_availqty) * 0.0001000000 from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'PERU' ) order by value desc;","select ps_partkey, sum(ps_supplycost * ps_availqty) as value from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'PERU' group by ps_partkey having sum(ps_supplycost * ps_availqty) > ( select sum(ps_supplycost * ps_availqty) * 0.0001000000 from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'PERU' ) order by value desc",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('43', '36', '22', '29', '33', '25', '35') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('43', '36', '22', '29', '33', '25', '35') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
10,tpch,"select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('SHIP', 'REG AIR') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1997-01-01' and l_receiptdate < date '1997-01-01' + interval '1' year group by l_shipmode order by l_shipmode;","select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('SHIP', 'REG AIR') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1997-01-01' and l_receiptdate < date '1997-01-01' + interval '1' year group by l_shipmode order by l_shipmode",[],"[""select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'ARGENTINA' group by s_name order by numwait desc, s_name;""]","[""['Empty List']""]"
11,tpch,"select c_count, count(*) as custdist from ( select c_custkey, count(o_orderkey) from customer left outer join orders on c_custkey = o_custkey and o_comment not like '%express%packages%' group by c_custkey ) as c_orders (c_custkey, c_count) group by c_count order by custdist desc, c_count desc;","SELECT t.EXPR1, COUNT(*) AS custdist FROM (SELECT customer.c_custkey, COUNT(orders.o_orderkey) AS EXPR1 FROM customer LEFT JOIN orders ON customer.c_custkey = orders.o_custkey AND orders.o_comment NOT LIKE '%express%packages%' GROUP BY customer.c_custkey) AS t GROUP BY t.EXPR1 ORDER BY COUNT(*) DESC, t.EXPR1 DESC","['AGGREGATE_PROJECT_MERGE', 'FILTER_AGGREGATE_TRANSPOSE']","[""select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from customer, orders, lineitem, nation where c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate >= date '1993-05-01' and o_orderdate < date '1993-05-01' + interval '3' month and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc;""]","[""['FILTER_INTO_JOIN', 'PROJECT_TO_CALC', 'JOIN_EXTRACT_FILTER']""]"
12,tpch,"select 100.00 * sum(case when p_type like 'PROMO%' then l_extendedprice * (1 - l_discount) else 0 end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from lineitem, part where l_partkey = p_partkey and l_shipdate >= date '1993-03-01' and l_shipdate < date '1993-03-01' + interval '1' month;",SELECT 100.00 * SUM(CASE WHEN part.p_type LIKE 'PROMO%' THEN t.l_extendedprice * (1 - t.l_discount) ELSE 0 END) / SUM(t.l_extendedprice * (1 - t.l_discount)) AS promo_revenue FROM (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1993-03-01' AND l_shipdate < (DATE '1993-03-01' + INTERVAL '1' MONTH)) AS t INNER JOIN part ON t.l_partkey = part.p_partkey,"['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'PROJECT_REDUCE_EXPRESSIONS', 'AGGREGATE_ANY_PULL_UP_CONSTANTS']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#41' and p_type not like 'STANDARD BRUSHED%' and p_size in (4, 35, 50, 23, 45, 30, 25, 28) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'FILTER_MERGE', 'JOIN_CONDITION_PUSH', 'PROJECT_CALC_MERGE', 'PROJECT_REDUCE_EXPRESSIONS', 'CALC_MERGE', 'SORT_JOIN_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE']""]"
13,tpch,"select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#55' and p_type not like 'SMALL BRUSHED%' and p_size in (28, 10, 32, 30, 11, 33, 4, 24) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;","select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#55' and p_type not like 'SMALL BRUSHED%' and p_size in (28, 10, 32, 30, 11, 33, 4, 24) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 47 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
14,tpch,"select sum(l_extendedprice) / 7.0 as avg_yearly from lineitem, part where p_partkey = l_partkey and p_brand = 'Brand#52' and p_container = 'MED CAN' and l_quantity < ( select 0.2 * avg(l_quantity) from lineitem where l_partkey = p_partkey );","select sum(l_extendedprice) / 7.0 as avg_yearly from lineitem, part where p_partkey = l_partkey and p_brand = 'Brand#52' and p_container = 'MED CAN' and l_quantity < ( select 0.2 * avg(l_quantity) from lineitem where l_partkey = p_partkey )",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 33 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
15,tpch,"select c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, sum(l_quantity) from customer, orders, lineitem where o_orderkey in ( select l_orderkey from lineitem group by l_orderkey having sum(l_quantity) > 313 ) and c_custkey = o_custkey and o_orderkey = l_orderkey group by c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice order by o_totalprice desc, o_orderdate;","select c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, sum(l_quantity) from customer, orders, lineitem where o_orderkey in ( select l_orderkey from lineitem group by l_orderkey having sum(l_quantity) > 313 ) and c_custkey = o_custkey and o_orderkey = l_orderkey group by c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice order by o_totalprice desc, o_orderdate",[],"[""select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'MOROCCO' group by s_name order by numwait desc, s_name;""]","[""['Empty List']""]"
16,tpch,"select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#31' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 6 and l_quantity <= 6 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#43' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 14 and l_quantity <= 14 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#14' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 29 and l_quantity <= 29 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );",SELECT SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS revenue FROM lineitem INNER JOIN part ON lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#31' AND ((part.p_container = 'SM CASE' OR part.p_container = 'SM BOX' OR part.p_container = 'SM PACK' OR part.p_container = 'SM PKG') AND lineitem.l_quantity >= 6) AND (lineitem.l_quantity <= 6 + 10 AND part.p_size >= 1 AND (part.p_size <= 5 AND ((lineitem.l_shipmode = 'AIR' OR lineitem.l_shipmode = 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))) OR lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#43' AND ((part.p_container = 'MED BAG' OR part.p_container = 'MED BOX' OR part.p_container = 'MED PKG' OR part.p_container = 'MED PACK') AND lineitem.l_quantity >= 14) AND (lineitem.l_quantity <= 14 + 10 AND part.p_size >= 1 AND (part.p_size <= 10 AND ((lineitem.l_shipmode = 'AIR' OR lineitem.l_shipmode = 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))) OR lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#14' AND ((part.p_container = 'LG CASE' OR part.p_container = 'LG BOX' OR part.p_container = 'LG PACK' OR part.p_container = 'LG PKG') AND lineitem.l_quantity >= 29) AND (lineitem.l_quantity <= 29 + 10 AND part.p_size >= 1 AND (part.p_size <= 15 AND ((lineitem.l_shipmode = 'AIR' OR lineitem.l_shipmode = 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))),"['FILTER_MERGE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#45' and p_type not like 'STANDARD PLATED%' and p_size in (24, 5, 34, 22, 27, 23, 40, 9) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_PROJECT_MERGE', 'FILTER_INTO_JOIN', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH', 'SORT_JOIN_TRANSPOSE']""]"
17,tpch,"select s_name, s_address from supplier, nation where s_suppkey in ( select ps_suppkey from partsupp where ps_partkey in ( select p_partkey from part where p_name like 'coral%' ) and ps_availqty > ( select 0.5 * sum(l_quantity) from lineitem where l_partkey = ps_partkey and l_suppkey = ps_suppkey and l_shipdate >= date '1996-01-01' and l_shipdate < date '1996-01-01' + interval '1' year ) ) and s_nationkey = n_nationkey and n_name = 'JORDAN' order by s_name;","SELECT t0.s_name, t0.s_address FROM (SELECT * FROM supplier, (SELECT * FROM nation WHERE n_name = 'JORDAN') AS t WHERE supplier.s_nationkey = t.n_nationkey) AS t0, (SELECT t4.ps_suppkey FROM (SELECT * FROM partsupp, (SELECT p_partkey FROM part WHERE p_name LIKE 'coral%' GROUP BY p_partkey) AS t3 WHERE partsupp.ps_partkey = t3.p_partkey) AS t4, (SELECT l_partkey, l_suppkey, SUM(l_quantity) AS f2 FROM lineitem WHERE l_shipdate >= DATE '1996-01-01' AND l_shipdate < (DATE '1996-01-01' + INTERVAL '1' YEAR) GROUP BY l_partkey, l_suppkey) AS t7 WHERE t4.ps_partkey = t7.l_partkey AND t4.ps_suppkey = t7.l_suppkey AND t4.ps_availqty > 0.5 * t7.f2 GROUP BY t4.ps_suppkey) AS t11 WHERE t0.s_suppkey = t11.ps_suppkey ORDER BY t0.s_name","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_REDUCE_EXPRESSIONS']","[""select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'FURNITURE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-06' and l_shipdate > date '1995-03-06' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;""]","[""['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'PROJECT_TO_CALC', 'JOIN_EXTRACT_FILTER']""]"
18,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'MOROCCO' group by s_name order by numwait desc, s_name;","select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'MOROCCO' group by s_name order by numwait desc, s_name",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('33', '34', '23', '26', '35', '43', '24') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('33', '34', '23', '26', '35', '43', '24') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
19,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('33', '24', '36', '34', '32', '42', '26') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('33', '24', '36', '34', '32', '42', '26') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(t.c_phone) + 1) < 1 THEN CHAR_LENGTH(t.c_phone) + 1 ELSE 1 END FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '33' OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '24' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '36') OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '34' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '32' OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '42' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '26'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '33' OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '24' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '36') OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '34' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '32' OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '42' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '26')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, MIN(TRUE) AS f1 FROM orders GROUP BY o_custkey) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f1 IS NULL GROUP BY SUBSTR(t.c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(t.c_phone) + 1) < 1 THEN CHAR_LENGTH(t.c_phone) + 1 ELSE 1 END FOR 2) ORDER BY SUBSTR(t.c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(t.c_phone) + 1) < 1 THEN CHAR_LENGTH(t.c_phone) + 1 ELSE 1 END FOR 2)","['AGGREGATE_PROJECT_MERGE', 'FILTER_AGGREGATE_TRANSPOSE', 'FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#52' and p_type not like 'MEDIUM ANODIZED%' and p_size in (24, 43, 30, 46, 21, 27, 6, 15) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_PROJECT_MERGE', 'FILTER_AGGREGATE_TRANSPOSE', 'FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'JOIN_EXTRACT_FILTER', 'JOIN_REDUCE_EXPRESSIONS', 'SORT_REMOVE']""]"
20,tpch,"select l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order from lineitem where l_shipdate <= date '1998-12-01' - interval '64' day (3) group by l_returnflag, l_linestatus order by l_returnflag, l_linestatus;","select l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order from lineitem where l_shipdate <= date '1998-12-01' - interval '64' day (3) group by l_returnflag, l_linestatus order by l_returnflag, l_linestatus",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('34', '23', '27', '28', '20', '31', '40') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('34', '23', '27', '28', '20', '31', '40') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
21,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 43 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 43 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey",[],"[""select o_year, sum(case when nation = 'IRAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO BRUSHED BRASS' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
22,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'AUTOMOBILE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-01' and l_shipdate > date '1995-03-01' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'AUTOMOBILE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-01' and l_shipdate > date '1995-03-01' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 48 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
23,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1993-02-01' and o_orderdate < date '1993-02-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","SELECT t.o_orderpriority, COUNT(*) AS order_count FROM (SELECT * FROM orders WHERE o_orderdate >= DATE '1993-02-01' AND o_orderdate < (DATE '1993-02-01' + INTERVAL '3' MONTH)) AS t INNER JOIN (SELECT l_orderkey, MIN(TRUE) AS f1 FROM lineitem WHERE l_commitdate < l_receiptdate GROUP BY l_orderkey) AS t2 ON t.o_orderkey = t2.l_orderkey GROUP BY t.o_orderpriority ORDER BY t.o_orderpriority","['FILTER_AGGREGATE_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#53' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 1 and l_quantity <= 1 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#43' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 14 and l_quantity <= 14 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#21' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 29 and l_quantity <= 29 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_INTO_JOIN', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_REMOVE']""]"
24,tpch,"select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and o_orderdate >= date '1993-01-01' and o_orderdate < date '1993-01-01' + interval '1' year group by n_name order by revenue desc;","select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and o_orderdate >= date '1993-01-01' and o_orderdate < date '1993-01-01' + interval '1' year group by n_name order by revenue desc",[],"[""select o_year, sum(case when nation = 'ARGENTINA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE BRUSHED BRASS' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
25,tpch,select sum(l_extendedprice * l_discount) as revenue from lineitem where l_shipdate >= date '1993-01-01' and l_shipdate < date '1993-01-01' + interval '1' year and l_discount between 0.07 - 0.01 and 0.07 + 0.01 and l_quantity < 25;,select sum(l_extendedprice * l_discount) as revenue from lineitem where l_shipdate >= date '1993-01-01' and l_shipdate < date '1993-01-01' + interval '1' year and l_discount between 0.07 - 0.01 and 0.07 + 0.01 and l_quantity < 25,[],"[""select o_year, sum(case when nation = 'CANADA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL POLISHED COPPER' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
26,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'MOROCCO' and n2.n_name = 'PERU') or (n1.n_name = 'PERU' and n2.n_name = 'MOROCCO') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation.n_name AS supp_nation, nation0.n_name AS cust_nation, EXTRACT(YEAR FROM t.l_shipdate) AS l_year, SUM(t.l_extendedprice * (1 - t.l_discount)) AS revenue FROM supplier INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t ON supplier.s_suppkey = t.l_suppkey INNER JOIN orders ON t.l_orderkey = orders.o_orderkey INNER JOIN customer ON orders.o_custkey = customer.c_custkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey INNER JOIN nation AS nation0 ON customer.c_nationkey = nation0.n_nationkey AND (nation.n_name = 'MOROCCO' AND nation0.n_name = 'PERU' OR nation.n_name = 'PERU' AND nation0.n_name = 'MOROCCO') GROUP BY nation.n_name, nation0.n_name, EXTRACT(YEAR FROM t.l_shipdate) ORDER BY nation.n_name, nation0.n_name, EXTRACT(YEAR FROM t.l_shipdate)","['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_MERGE', 'AGGREGATE_PROJECT_MERGE']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#35' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 9 and l_quantity <= 9 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#35' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 19 and l_quantity <= 19 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#41' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 30 and l_quantity <= 30 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH']""]"
27,tpch,"select o_year, sum(case when nation = 'PERU' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD ANODIZED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t5.o_orderdate) AS o_year, SUM(CASE WHEN t5.n_name0 = 'PERU' THEN t5.l_extendedprice * (1 - t5.l_discount) ELSE 0 END) / SUM(t5.l_extendedprice * (1 - t5.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD ANODIZED NICKEL') AS t, supplier, lineitem WHERE t.p_partkey = lineitem.l_partkey AND supplier.s_suppkey = lineitem.l_suppkey) AS t0, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t1 WHERE t0.l_orderkey = t1.o_orderkey) AS t2, customer WHERE t2.o_custkey = customer.c_custkey) AS t3, nation WHERE t3.c_nationkey = nation.n_nationkey) AS t4, nation AS nation0 WHERE t4.s_nationkey = nation0.n_nationkey) AS t5, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t6 WHERE t5.n_regionkey = t6.r_regionkey GROUP BY EXTRACT(YEAR FROM t5.o_orderdate) ORDER BY EXTRACT(YEAR FROM t5.o_orderdate)","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS']","[""select o_year, sum(case when nation = 'CANADA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL POLISHED NICKEL' ) as all_nations group by o_year order by o_year;""]","[""['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_TO_CALC', 'FILTER_INTO_JOIN']""]"
28,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%antique%' ) as profit group by nation, o_year order by nation, o_year desc;","select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%antique%' ) as profit group by nation, o_year order by nation, o_year desc",[],"[""select o_year, sum(case when nation = 'MOZAMBIQUE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM ANODIZED NICKEL' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
29,tpch,"select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from customer, orders, lineitem, nation where c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate >= date '1993-02-01' and o_orderdate < date '1993-02-01' + interval '3' month and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc;","select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from customer, orders, lineitem, nation where c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate >= date '1993-02-01' and o_orderdate < date '1993-02-01' + interval '3' month and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('24', '44', '23', '35', '31', '43', '28') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('24', '44', '23', '35', '31', '43', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
30,tpch,"select ps_partkey, sum(ps_supplycost * ps_availqty) as value from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'KENYA' group by ps_partkey having sum(ps_supplycost * ps_availqty) > ( select sum(ps_supplycost * ps_availqty) * 0.0001000000 from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'KENYA' ) order by value desc;","SELECT t1.ps_partkey, t1.value FROM (SELECT partsupp.ps_partkey, SUM(partsupp.ps_supplycost * partsupp.ps_availqty) AS value FROM partsupp INNER JOIN supplier ON partsupp.ps_suppkey = supplier.s_suppkey INNER JOIN (SELECT * FROM nation WHERE n_name = 'KENYA') AS t ON supplier.s_nationkey = t.n_nationkey GROUP BY partsupp.ps_partkey) AS t1 INNER JOIN (SELECT SUM(partsupp0.ps_supplycost * partsupp0.ps_availqty) * 0.0001000000 AS EXPR0 FROM partsupp AS partsupp0 INNER JOIN supplier AS supplier0 ON partsupp0.ps_suppkey = supplier0.s_suppkey INNER JOIN (SELECT * FROM nation WHERE n_name = 'KENYA') AS t2 ON supplier0.s_nationkey = t2.n_nationkey) AS t5 ON t1.value > t5.EXPR0 ORDER BY t1.value DESC","['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'AGGREGATE_ANY_PULL_UP_CONSTANTS', 'AGGREGATE_REMOVE', 'PROJECT_REDUCE_EXPRESSIONS', 'SORT_REMOVE_CONSTANT_KEYS']","[""select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('RAIL', 'MAIL') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1993-01-01' and l_receiptdate < date '1993-01-01' + interval '1' year group by l_shipmode order by l_shipmode;""]","[""['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'SORT_REMOVE_CONSTANT_KEYS']""]"
31,tpch,"select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('SHIP', 'MAIL') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1996-01-01' and l_receiptdate < date '1996-01-01' + interval '1' year group by l_shipmode order by l_shipmode;","select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('SHIP', 'MAIL') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1996-01-01' and l_receiptdate < date '1996-01-01' + interval '1' year group by l_shipmode order by l_shipmode",[],"[""select o_year, sum(case when nation = 'CANADA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY BURNISHED STEEL' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
32,tpch,"select c_count, count(*) as custdist from ( select c_custkey, count(o_orderkey) from customer left outer join orders on c_custkey = o_custkey and o_comment not like '%unusual%accounts%' group by c_custkey ) as c_orders (c_custkey, c_count) group by c_count order by custdist desc, c_count desc;","SELECT t.EXPR1, COUNT(*) AS custdist FROM (SELECT customer.c_custkey, COUNT(orders.o_orderkey) AS EXPR1 FROM customer LEFT JOIN orders ON customer.c_custkey = orders.o_custkey AND orders.o_comment NOT LIKE '%unusual%accounts%' GROUP BY customer.c_custkey) AS t GROUP BY t.EXPR1 ORDER BY COUNT(*) DESC, t.EXPR1 DESC","['AGGREGATE_PROJECT_MERGE', 'FILTER_AGGREGATE_TRANSPOSE']","[""select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'SAUDI ARABIA' and n2.n_name = 'UNITED KINGDOM') or (n1.n_name = 'UNITED KINGDOM' and n2.n_name = 'SAUDI ARABIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;""]","[""['FILTER_INTO_JOIN']""]"
33,tpch,"select 100.00 * sum(case when p_type like 'PROMO%' then l_extendedprice * (1 - l_discount) else 0 end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from lineitem, part where l_partkey = p_partkey and l_shipdate >= date '1996-08-01' and l_shipdate < date '1996-08-01' + interval '1' month;",SELECT 100.00 * SUM(CASE WHEN part.p_type LIKE 'PROMO%' THEN t.l_extendedprice * (1 - t.l_discount) ELSE 0 END) / SUM(t.l_extendedprice * (1 - t.l_discount)) AS promo_revenue FROM (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1996-08-01' AND l_shipdate < (DATE '1996-08-01' + INTERVAL '1' MONTH)) AS t INNER JOIN part ON t.l_partkey = part.p_partkey,"['FILTER_INTO_JOIN', 'PROJECT_REDUCE_EXPRESSIONS']","[""select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'EGYPT' and n2.n_name = 'JORDAN') or (n1.n_name = 'JORDAN' and n2.n_name = 'EGYPT') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;""]","[""['FILTER_INTO_JOIN']""]"
34,tpch,"select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#55' and p_type not like 'STANDARD ANODIZED%' and p_size in (8, 34, 26, 4, 30, 5, 23, 44) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;","select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#55' and p_type not like 'STANDARD ANODIZED%' and p_size in (8, 34, 26, 4, 30, 5, 23, 44) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size",[],"[""select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'HOUSEHOLD' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-18' and l_shipdate > date '1995-03-18' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;""]","[""['Empty List']""]"
35,tpch,"select sum(l_extendedprice) / 7.0 as avg_yearly from lineitem, part where p_partkey = l_partkey and p_brand = 'Brand#51' and p_container = 'SM CAN' and l_quantity < ( select 0.2 * avg(l_quantity) from lineitem where l_partkey = p_partkey );","SELECT SUM(lineitem.l_extendedprice) / 7.0 AS avg_yearly FROM lineitem INNER JOIN (SELECT * FROM part WHERE p_brand = 'Brand#51' AND p_container = 'SM CAN') AS t ON lineitem.l_partkey = t.p_partkey INNER JOIN (SELECT l_partkey, AVG(l_quantity) AS f1 FROM lineitem GROUP BY l_partkey) AS t1 ON t.p_partkey = t1.l_partkey AND lineitem.l_quantity < 0.2 * t1.f1","['FILTER_INTO_JOIN', 'FILTER_REDUCE_EXPRESSIONS', 'AGGREGATE_ANY_PULL_UP_CONSTANTS']","[""select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'BUILDING' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-16' and l_shipdate > date '1995-03-16' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;""]","[""['FILTER_INTO_JOIN', 'PROJECT_TO_CALC', 'JOIN_EXTRACT_FILTER']""]"
36,tpch,"select c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, sum(l_quantity) from customer, orders, lineitem where o_orderkey in ( select l_orderkey from lineitem group by l_orderkey having sum(l_quantity) > 312 ) and c_custkey = o_custkey and o_orderkey = l_orderkey group by c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice order by o_totalprice desc, o_orderdate;","SELECT t0.c_name, t0.c_custkey, t0.o_orderkey, t0.o_orderdate, t0.o_totalprice, SUM(t0.l_quantity) FROM (SELECT * FROM (SELECT * FROM customer, orders WHERE customer.c_custkey = orders.o_custkey) AS t, lineitem WHERE t.o_orderkey = lineitem.l_orderkey) AS t0, (SELECT l_orderkey FROM (SELECT l_orderkey, SUM(l_quantity) AS f1 FROM lineitem GROUP BY l_orderkey HAVING SUM(l_quantity) > 312) AS t2 GROUP BY l_orderkey) AS t3 WHERE t0.o_orderkey = t3.l_orderkey GROUP BY t0.c_custkey, t0.c_name, t0.o_orderkey, t0.o_totalprice, t0.o_orderdate ORDER BY t0.o_totalprice DESC, t0.o_orderdate","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'AGGREGATE_PROJECT_MERGE', 'SORT_PROJECT_TRANSPOSE']","[""select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'AUTOMOBILE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-29' and l_shipdate > date '1995-03-29' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;""]","[""['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_TO_CALC', 'FILTER_INTO_JOIN']""]"
37,tpch,"select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#14' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 4 and l_quantity <= 4 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#31' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 19 and l_quantity <= 19 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#33' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 30 and l_quantity <= 30 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );","SELECT SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS revenue FROM lineitem, part WHERE part.p_partkey = lineitem.l_partkey AND part.p_brand = 'Brand#14' AND (part.p_container IN ('SM BOX', 'SM CASE', 'SM PACK', 'SM PKG') AND lineitem.l_quantity >= 4) AND (lineitem.l_quantity <= 4 + 10 AND (part.p_size >= 1 AND part.p_size <= 5) AND (lineitem.l_shipmode IN ('AIR', 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON')) OR part.p_partkey = lineitem.l_partkey AND part.p_brand = 'Brand#31' AND (part.p_container IN ('MED BAG', 'MED BOX', 'MED PACK', 'MED PKG') AND lineitem.l_quantity >= 19) AND (lineitem.l_quantity <= 19 + 10 AND (part.p_size >= 1 AND part.p_size <= 10) AND (lineitem.l_shipmode IN ('AIR', 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON')) OR part.p_partkey = lineitem.l_partkey AND part.p_brand = 'Brand#33' AND (part.p_container IN ('LG BOX', 'LG CASE', 'LG PACK', 'LG PKG') AND lineitem.l_quantity >= 30) AND (lineitem.l_quantity <= 30 + 10 AND (part.p_size >= 1 AND part.p_size <= 15) AND (lineitem.l_shipmode IN ('AIR', 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))","['FILTER_MERGE', 'FILTER_MULTI_JOIN_MERGE', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_SET_OP_TRANSPOSE', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'AGGREGATE_ANY_PULL_UP_CONSTANTS', 'AGGREGATE_VALUES']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#21' and p_type not like 'SMALL POLISHED%' and p_size in (3, 50, 38, 44, 13, 5, 14, 17) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_MERGE', 'FILTER_MULTI_JOIN_MERGE', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_SET_OP_TRANSPOSE', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_ANY_PULL_UP_CONSTANTS', 'AGGREGATE_VALUES', 'AGGREGATE_REMOVE', 'JOIN_CONDITION_PUSH', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'JOIN_PROJECT_LEFT_TRANSPOSE', 'JOIN_PROJECT_RIGHT_TRANSPOSE', 'JOIN_LEFT_UNION_TRANSPOSE', 'JOIN_RIGHT_UNION_TRANSPOSE', 'SEMI_JOIN_REMOVE', 'JOIN_REDUCE_EXPRESSIONS', 'UNION_MERGE', 'UNION_REMOVE', 'UNION_TO_DISTINCT', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'SORT_UNION_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE']""]"
38,tpch,"select s_name, s_address from supplier, nation where s_suppkey in ( select ps_suppkey from partsupp where ps_partkey in ( select p_partkey from part where p_name like 'papaya%' ) and ps_availqty > ( select 0.5 * sum(l_quantity) from lineitem where l_partkey = ps_partkey and l_suppkey = ps_suppkey and l_shipdate >= date '1995-01-01' and l_shipdate < date '1995-01-01' + interval '1' year ) ) and s_nationkey = n_nationkey and n_name = 'ALGERIA' order by s_name;","select s_name, s_address from supplier, nation where s_suppkey in ( select ps_suppkey from partsupp where ps_partkey in ( select p_partkey from part where p_name like 'papaya%' ) and ps_availqty > ( select 0.5 * sum(l_quantity) from lineitem where l_partkey = ps_partkey and l_suppkey = ps_suppkey and l_shipdate >= date '1995-01-01' and l_shipdate < date '1995-01-01' + interval '1' year ) ) and s_nationkey = n_nationkey and n_name = 'ALGERIA' order by s_name",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('22', '33', '23', '37', '34', '43', '36') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('22', '33', '23', '37', '34', '43', '36') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
39,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'JAPAN' group by s_name order by numwait desc, s_name;","SELECT t4.s_name, COUNT(*) AS numwait FROM (SELECT * FROM (SELECT supplier.s_suppkey, supplier.s_name, supplier.s_address, supplier.s_nationkey, supplier.s_phone, supplier.s_acctbal, supplier.s_comment, lineitem.l_orderkey, lineitem.l_partkey, lineitem.l_suppkey, lineitem.l_linenumber, lineitem.l_quantity, lineitem.l_extendedprice, lineitem.l_discount, lineitem.l_tax, lineitem.l_returnflag, lineitem.l_linestatus, lineitem.l_shipdate, lineitem.l_commitdate, lineitem.l_receiptdate, lineitem.l_shipinstruct, lineitem.l_shipmode, lineitem.l_comment, orders.o_orderkey, orders.o_custkey, orders.o_orderstatus, orders.o_totalprice, orders.o_orderdate, orders.o_orderpriority, orders.o_clerk, orders.o_shippriority, orders.o_comment, nation.n_nationkey, nation.n_name, nation.n_regionkey, nation.n_comment, t2.f2 AS f0 FROM supplier CROSS JOIN lineitem CROSS JOIN orders CROSS JOIN nation LEFT JOIN (SELECT t0.l_orderkey AS l_orderkey0, t0.l_suppkey AS l_suppkey0, MIN(TRUE) AS f2 FROM lineitem AS lineitem0 INNER JOIN (SELECT lineitem1.l_orderkey, lineitem1.l_suppkey FROM supplier AS supplier0, lineitem AS lineitem1, orders AS orders0, nation AS nation0 GROUP BY lineitem1.l_orderkey, lineitem1.l_suppkey) AS t0 ON lineitem0.l_orderkey = t0.l_orderkey AND lineitem0.l_suppkey <> t0.l_suppkey GROUP BY t0.l_orderkey, t0.l_suppkey) AS t2 ON lineitem.l_orderkey = t2.l_orderkey0 AND lineitem.l_suppkey = t2.l_suppkey0) AS t3 WHERE t3.s_suppkey = t3.l_suppkey AND (t3.o_orderkey = t3.l_orderkey AND t3.o_orderstatus = 'F') AND (t3.l_receiptdate > t3.l_commitdate AND t3.s_nationkey = t3.n_nationkey AND (t3.n_name = 'JAPAN' AND t3.f0 IS NOT NULL))) AS t4 LEFT JOIN (SELECT t13.l_orderkey AS l_orderkey0, t13.l_suppkey AS l_suppkey0, MIN(TRUE) AS f2 FROM (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t5 INNER JOIN (SELECT l_orderkey, l_suppkey FROM (SELECT supplier1.s_suppkey, supplier1.s_name, supplier1.s_address, supplier1.s_nationkey, supplier1.s_phone, supplier1.s_acctbal, supplier1.s_comment, lineitem3.l_orderkey, lineitem3.l_partkey, lineitem3.l_suppkey, lineitem3.l_linenumber, lineitem3.l_quantity, lineitem3.l_extendedprice, lineitem3.l_discount, lineitem3.l_tax, lineitem3.l_returnflag, lineitem3.l_linestatus, lineitem3.l_shipdate, lineitem3.l_commitdate, lineitem3.l_receiptdate, lineitem3.l_shipinstruct, lineitem3.l_shipmode, lineitem3.l_comment, orders1.o_orderkey, orders1.o_custkey, orders1.o_orderstatus, orders1.o_totalprice, orders1.o_orderdate, orders1.o_orderpriority, orders1.o_clerk, orders1.o_shippriority, orders1.o_comment, nation1.n_nationkey, nation1.n_name, nation1.n_regionkey, nation1.n_comment, t9.f2 AS f0 FROM supplier AS supplier1 CROSS JOIN lineitem AS lineitem3 CROSS JOIN orders AS orders1 CROSS JOIN nation AS nation1 LEFT JOIN (SELECT t7.l_orderkey AS l_orderkey0, t7.l_suppkey AS l_suppkey0, MIN(TRUE) AS f2 FROM lineitem AS lineitem4 INNER JOIN (SELECT lineitem5.l_orderkey, lineitem5.l_suppkey FROM supplier AS supplier2, lineitem AS lineitem5, orders AS orders2, nation AS nation2 GROUP BY lineitem5.l_orderkey, lineitem5.l_suppkey) AS t7 ON lineitem4.l_orderkey = t7.l_orderkey AND lineitem4.l_suppkey <> t7.l_suppkey GROUP BY t7.l_orderkey, t7.l_suppkey) AS t9 ON lineitem3.l_orderkey = t9.l_orderkey0 AND lineitem3.l_suppkey = t9.l_suppkey0) AS t10 WHERE t10.s_suppkey = t10.l_suppkey AND (t10.o_orderkey = t10.l_orderkey AND t10.o_orderstatus = 'F') AND (t10.l_receiptdate > t10.l_commitdate AND t10.s_nationkey = t10.n_nationkey AND (t10.n_name = 'JAPAN' AND t10.f0 IS NOT NULL)) GROUP BY l_orderkey, l_suppkey) AS t13 ON t5.l_orderkey = t13.l_orderkey AND t5.l_suppkey <> t13.l_suppkey GROUP BY t13.l_orderkey, t13.l_suppkey) AS t15 ON t4.l_orderkey = t15.l_orderkey0 AND t4.l_suppkey = t15.l_suppkey0 WHERE t15.f2 IS NULL GROUP BY t4.s_name ORDER BY COUNT(*) DESC, t4.s_name","['FILTER_INTO_JOIN', 'FILTER_MERGE']","[""select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'BRAZIL' and n2.n_name = 'ETHIOPIA') or (n1.n_name = 'ETHIOPIA' and n2.n_name = 'BRAZIL') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;""]","[""['FILTER_INTO_JOIN']""]"
40,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('20', '34', '21', '31', '41', '44', '35') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('20', '34', '21', '31', '41', '44', '35') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(t.c_phone) + 1) < 1 THEN CHAR_LENGTH(t.c_phone) + 1 ELSE 1 END FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '20' OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '34' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '21') OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '31' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '41' OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '44' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '35'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '20' OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '34' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '21') OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '31' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '41' OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '44' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '35')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, MIN(TRUE) AS f1 FROM orders GROUP BY o_custkey) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f1 IS NULL GROUP BY SUBSTR(t.c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(t.c_phone) + 1) < 1 THEN CHAR_LENGTH(t.c_phone) + 1 ELSE 1 END FOR 2) ORDER BY SUBSTR(t.c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(t.c_phone) + 1) < 1 THEN CHAR_LENGTH(t.c_phone) + 1 ELSE 1 END FOR 2)","['FILTER_PROJECT_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE', 'FILTER_AGGREGATE_TRANSPOSE']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#33' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 6 and l_quantity <= 6 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#14' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 16 and l_quantity <= 16 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#22' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 21 and l_quantity <= 21 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH']""]"
41,tpch,"select l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order from lineitem where l_shipdate <= date '1998-12-01' - interval '71' day (3) group by l_returnflag, l_linestatus order by l_returnflag, l_linestatus;","SELECT l_returnflag, l_linestatus, SUM(l_quantity) AS sum_qty, SUM(l_extendedprice) AS sum_base_price, SUM(l_extendedprice * (1 - l_discount)) AS sum_disc_price, SUM(l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS sum_charge, AVG(l_quantity) AS avg_qty, AVG(l_extendedprice) AS avg_price, AVG(l_discount) AS avg_disc, COUNT(*) AS count_order FROM lineitem WHERE l_shipdate <= (DATE '1998-12-01' - INTERVAL '71' DAY(3)) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus","['FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#33' and p_type not like 'LARGE POLISHED%' and p_size in (36, 30, 40, 38, 39, 26, 7, 44) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_INTO_JOIN', 'FILTER_MERGE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH', 'SORT_REMOVE_CONSTANT_KEYS']""]"
42,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 37 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 37 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('25', '41', '30', '29', '39', '37', '36') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('25', '41', '30', '29', '39', '37', '36') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
43,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'MACHINERY' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-31' and l_shipdate > date '1995-03-31' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT lineitem.l_orderkey, SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS revenue, orders.o_orderdate, orders.o_shippriority FROM customer, orders, lineitem WHERE customer.c_mktsegment = 'MACHINERY' AND customer.c_custkey = orders.o_custkey AND lineitem.l_orderkey = orders.o_orderkey AND orders.o_orderdate < DATE '1995-03-31' AND lineitem.l_shipdate > DATE '1995-03-31' GROUP BY lineitem.l_orderkey, orders.o_orderdate, orders.o_shippriority ORDER BY SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) DESC, orders.o_orderdate","['FILTER_SCAN', 'JOIN_CONDITION_PUSH', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE', 'FILTER_AGGREGATE_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#42' and p_type not like 'STANDARD PLATED%' and p_size in (30, 1, 28, 23, 31, 33, 19, 21) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_SCAN', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'JOIN_LEFT_UNION_TRANSPOSE', 'JOIN_REDUCE_EXPRESSIONS', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE', 'FILTER_AGGREGATE_TRANSPOSE', 'AGGREGATE_UNION_TRANSPOSE', 'SORT_UNION_TRANSPOSE', 'AGGREGATE_REMOVE', 'FILTER_MERGE', 'SORT_REMOVE_CONSTANT_KEYS']""]"
44,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1997-11-01' and o_orderdate < date '1997-11-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","SELECT t.o_orderpriority, COUNT(*) AS order_count FROM (SELECT * FROM orders WHERE o_orderdate >= DATE '1997-11-01' AND o_orderdate < (DATE '1997-11-01' + INTERVAL '3' MONTH)) AS t INNER JOIN (SELECT l_orderkey, MIN(TRUE) AS f1 FROM lineitem WHERE l_commitdate < l_receiptdate GROUP BY l_orderkey) AS t2 ON t.o_orderkey = t2.l_orderkey GROUP BY t.o_orderpriority ORDER BY t.o_orderpriority","['FILTER_AGGREGATE_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE', 'SORT_REMOVE_CONSTANT_KEYS']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#23' and p_type not like 'ECONOMY ANODIZED%' and p_size in (19, 26, 20, 41, 9, 16, 23, 24) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_SET_OP_TRANSPOSE', 'JOIN_CONDITION_PUSH', 'AGGREGATE_PROJECT_MERGE', 'SORT_REMOVE_CONSTANT_KEYS']""]"
45,tpch,"select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and o_orderdate >= date '1997-01-01' and o_orderdate < date '1997-01-01' + interval '1' year group by n_name order by revenue desc;","select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and o_orderdate >= date '1997-01-01' and o_orderdate < date '1997-01-01' + interval '1' year group by n_name order by revenue desc",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 23 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
46,tpch,select sum(l_extendedprice * l_discount) as revenue from lineitem where l_shipdate >= date '1997-01-01' and l_shipdate < date '1997-01-01' + interval '1' year and l_discount between 0.04 - 0.01 and 0.04 + 0.01 and l_quantity < 24;,select sum(l_extendedprice * l_discount) as revenue from lineitem where l_shipdate >= date '1997-01-01' and l_shipdate < date '1997-01-01' + interval '1' year and l_discount between 0.04 - 0.01 and 0.04 + 0.01 and l_quantity < 24,[],"[""select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'CANADA' and n2.n_name = 'INDIA') or (n1.n_name = 'INDIA' and n2.n_name = 'CANADA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;""]","[""['Empty List']""]"
47,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'GERMANY' and n2.n_name = 'JAPAN') or (n1.n_name = 'JAPAN' and n2.n_name = 'GERMANY') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'GERMANY' and n2.n_name = 'JAPAN') or (n1.n_name = 'JAPAN' and n2.n_name = 'GERMANY') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('23', '41', '39', '33', '37', '40', '36') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('23', '41', '39', '33', '37', '40', '36') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
48,tpch,"select o_year, sum(case when nation = 'JAPAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD POLISHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t0.o_orderdate) AS o_year, SUM(CASE WHEN nation0.n_name = 'JAPAN' THEN lineitem.l_extendedprice * (1 - lineitem.l_discount) ELSE 0 END) / SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'STANDARD POLISHED COPPER') AS t CROSS JOIN supplier INNER JOIN lineitem ON t.p_partkey = lineitem.l_partkey AND supplier.s_suppkey = lineitem.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t0 ON lineitem.l_orderkey = t0.o_orderkey INNER JOIN customer ON t0.o_custkey = customer.c_custkey INNER JOIN nation ON customer.c_nationkey = nation.n_nationkey INNER JOIN nation AS nation0 ON supplier.s_nationkey = nation0.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'ASIA') AS t1 ON nation.n_regionkey = t1.r_regionkey GROUP BY EXTRACT(YEAR FROM t0.o_orderdate) ORDER BY EXTRACT(YEAR FROM t0.o_orderdate)","['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE', 'SORT_REMOVE_CONSTANT_KEYS']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#11' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 6 and l_quantity <= 6 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#45' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 19 and l_quantity <= 19 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#34' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 28 and l_quantity <= 28 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_INTO_JOIN', 'FILTER_AGGREGATE_TRANSPOSE', 'JOIN_CONDITION_PUSH', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'PROJECT_CORRELATE_TRANSPOSE', 'CALC_MERGE', 'CALC_REMOVE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE']""]"
49,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%burlywood%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation.n_name AS nation, EXTRACT(YEAR FROM t2.o_orderdate) AS o_year, SUM(t2.l_extendedprice * (1 - t2.l_discount) - t2.ps_supplycost * t2.l_quantity) AS sum_profit FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_name LIKE '%burlywood%') AS t, supplier, lineitem WHERE supplier.s_suppkey = lineitem.l_suppkey AND t.p_partkey = lineitem.l_partkey) AS t0, partsupp WHERE partsupp.ps_suppkey = t0.l_suppkey AND partsupp.ps_partkey = t0.l_partkey) AS t1, orders WHERE orders.o_orderkey = t1.l_orderkey) AS t2, nation WHERE t2.s_nationkey = nation.n_nationkey GROUP BY nation.n_name, EXTRACT(YEAR FROM t2.o_orderdate) ORDER BY nation.n_name, EXTRACT(YEAR FROM t2.o_orderdate) DESC","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_REDUCE_EXPRESSIONS', 'FILTER_MERGE']","[""select o_year, sum(case when nation = 'KENYA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM BURNISHED TIN' ) as all_nations group by o_year order by o_year;""]","[""['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_TO_CALC', 'FILTER_INTO_JOIN']""]"
50,tpch,"select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from customer, orders, lineitem, nation where c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate >= date '1993-05-01' and o_orderdate < date '1993-05-01' + interval '3' month and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc;","SELECT customer.c_custkey, customer.c_name, SUM(t0.l_extendedprice * (1 - t0.l_discount)) AS revenue, customer.c_acctbal, nation.n_name, customer.c_address, customer.c_phone, customer.c_comment FROM customer INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1993-05-01' AND o_orderdate < (DATE '1993-05-01' + INTERVAL '3' MONTH)) AS t ON customer.c_custkey = t.o_custkey INNER JOIN (SELECT * FROM lineitem WHERE l_returnflag = 'R') AS t0 ON t.o_orderkey = t0.l_orderkey INNER JOIN nation ON customer.c_nationkey = nation.n_nationkey GROUP BY customer.c_custkey, customer.c_name, customer.c_acctbal, customer.c_phone, nation.n_name, customer.c_address, customer.c_comment ORDER BY SUM(t0.l_extendedprice * (1 - t0.l_discount)) DESC","['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'SORT_PROJECT_TRANSPOSE']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#45' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 8 and l_quantity <= 8 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#43' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 18 and l_quantity <= 18 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#13' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 26 and l_quantity <= 26 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH']""]"
51,tpch,"select ps_partkey, sum(ps_supplycost * ps_availqty) as value from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'IRAQ' group by ps_partkey having sum(ps_supplycost * ps_availqty) > ( select sum(ps_supplycost * ps_availqty) * 0.0001000000 from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'IRAQ' ) order by value desc;","select ps_partkey, sum(ps_supplycost * ps_availqty) as value from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'IRAQ' group by ps_partkey having sum(ps_supplycost * ps_availqty) > ( select sum(ps_supplycost * ps_availqty) * 0.0001000000 from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'IRAQ' ) order by value desc",[],"[""select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1997-10-01' and o_orderdate < date '1997-10-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;""]","[""['Empty List']""]"
52,tpch,"select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('TRUCK', 'SHIP') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1993-01-01' and l_receiptdate < date '1993-01-01' + interval '1' year group by l_shipmode order by l_shipmode;","select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('TRUCK', 'SHIP') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1993-01-01' and l_receiptdate < date '1993-01-01' + interval '1' year group by l_shipmode order by l_shipmode",[],"[""select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'ARGENTINA' group by s_name order by numwait desc, s_name;""]","[""['Empty List']""]"
53,tpch,"select 100.00 * sum(case when p_type like 'PROMO%' then l_extendedprice * (1 - l_discount) else 0 end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from lineitem, part where l_partkey = p_partkey and l_shipdate >= date '1993-06-01' and l_shipdate < date '1993-06-01' + interval '1' month;",SELECT 100.00 * SUM(CASE WHEN part.p_type LIKE 'PROMO%' THEN t.l_extendedprice * (1 - t.l_discount) ELSE 0 END) / SUM(t.l_extendedprice * (1 - t.l_discount)) AS promo_revenue FROM (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1993-06-01' AND l_shipdate < (DATE '1993-06-01' + INTERVAL '1' MONTH)) AS t INNER JOIN part ON t.l_partkey = part.p_partkey,"['FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_INTO_JOIN', 'FILTER_MERGE', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH', 'JOIN_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_ANY_PULL_UP_CONSTANTS', 'PROJECT_REDUCE_EXPRESSIONS']","[""select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('FOB', 'REG AIR') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1993-01-01' and l_receiptdate < date '1993-01-01' + interval '1' year group by l_shipmode order by l_shipmode;""]","[""['FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_INTO_JOIN', 'FILTER_MERGE', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH', 'JOIN_REDUCE_EXPRESSIONS', 'PROJECT_CALC_MERGE', 'PROJECT_CORRELATE_TRANSPOSE', 'PROJECT_REDUCE_EXPRESSIONS', 'PROJECT_REMOVE', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'SORT_REMOVE', 'UNION_MERGE', 'UNION_TO_DISTINCT', 'FILTER_INSTANCE', 'JOIN_LEFT_INSTANCE', 'JOIN_RIGHT_INSTANCE', 'PROJECT_INSTANCE', 'SORT_INSTANCE', 'SORT_FETCH_ZERO_INSTANCE', 'UNION_INSTANCE']""]"
54,tpch,"select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#34' and p_type not like 'STANDARD POLISHED%' and p_size in (31, 37, 9, 23, 7, 47, 13, 45) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;","select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#34' and p_type not like 'STANDARD POLISHED%' and p_size in (31, 37, 9, 23, 7, 47, 13, 45) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 32 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
55,tpch,"select sum(l_extendedprice) / 7.0 as avg_yearly from lineitem, part where p_partkey = l_partkey and p_brand = 'Brand#41' and p_container = 'JUMBO CASE' and l_quantity < ( select 0.2 * avg(l_quantity) from lineitem where l_partkey = p_partkey );","SELECT SUM(lineitem.l_extendedprice) / 7.0 AS avg_yearly FROM lineitem INNER JOIN (SELECT * FROM part WHERE p_brand = 'Brand#41' AND p_container = 'JUMBO CASE') AS t ON lineitem.l_partkey = t.p_partkey INNER JOIN (SELECT l_partkey, AVG(l_quantity) AS f1 FROM lineitem GROUP BY l_partkey) AS t0 ON t.p_partkey = t0.l_partkey AND lineitem.l_quantity < 0.2 * t0.f1","['FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_CORRELATE', 'JOIN_CONDITION_PUSH', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'AGGREGATE_ANY_PULL_UP_CONSTANTS', 'PROJECT_REDUCE_EXPRESSIONS']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#14' and p_type not like 'PROMO BURNISHED%' and p_size in (45, 8, 31, 48, 42, 33, 22, 1) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_CORRELATE', 'FILTER_MERGE', 'JOIN_CONDITION_PUSH', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'AGGREGATE_ANY_PULL_UP_CONSTANTS', 'AGGREGATE_REMOVE', 'PROJECT_REDUCE_EXPRESSIONS', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE', 'UNION_REMOVE']""]"
56,tpch,"select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#44' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 2 and l_quantity <= 2 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#13' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 19 and l_quantity <= 19 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#15' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 21 and l_quantity <= 21 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );","select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#44' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 2 and l_quantity <= 2 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#13' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 19 and l_quantity <= 19 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#15' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 21 and l_quantity <= 21 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' )",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 42 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
57,tpch,"select s_name, s_address from supplier, nation where s_suppkey in ( select ps_suppkey from partsupp where ps_partkey in ( select p_partkey from part where p_name like 'puff%' ) and ps_availqty > ( select 0.5 * sum(l_quantity) from lineitem where l_partkey = ps_partkey and l_suppkey = ps_suppkey and l_shipdate >= date '1993-01-01' and l_shipdate < date '1993-01-01' + interval '1' year ) ) and s_nationkey = n_nationkey and n_name = 'IRAN' order by s_name;","SELECT t0.s_name, t0.s_address FROM (SELECT * FROM supplier, (SELECT * FROM nation WHERE n_name = 'IRAN') AS t WHERE supplier.s_nationkey = t.n_nationkey) AS t0, (SELECT t4.ps_suppkey FROM (SELECT * FROM partsupp, (SELECT p_partkey FROM part WHERE p_name LIKE 'puff%' GROUP BY p_partkey) AS t3 WHERE partsupp.ps_partkey = t3.p_partkey) AS t4, (SELECT l_partkey, l_suppkey, SUM(l_quantity) AS f2 FROM lineitem WHERE l_shipdate >= DATE '1993-01-01' AND l_shipdate < (DATE '1993-01-01' + INTERVAL '1' YEAR) GROUP BY l_partkey, l_suppkey) AS t7 WHERE t4.ps_partkey = t7.l_partkey AND t4.ps_suppkey = t7.l_suppkey AND t4.ps_availqty > 0.5 * t7.f2 GROUP BY t4.ps_suppkey) AS t11 WHERE t0.s_suppkey = t11.ps_suppkey ORDER BY t0.s_name","['FILTER_SCAN', 'FILTER_CORRELATE', 'FILTER_MERGE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_EXTRACT_FILTER', 'JOIN_REDUCE_EXPRESSIONS', 'SORT_REMOVE', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#25' and p_type not like 'PROMO ANODIZED%' and p_size in (37, 25, 8, 47, 17, 9, 49, 6) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_SCAN', 'FILTER_CORRELATE', 'FILTER_MERGE', 'FILTER_INTO_JOIN', 'PROJECT_REMOVE', 'PROJECT_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_EXTRACT_FILTER', 'JOIN_REDUCE_EXPRESSIONS', 'SORT_REMOVE', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN']""]"
58,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'CANADA' group by s_name order by numwait desc, s_name;","SELECT t4.s_name, COUNT(*) AS numwait FROM (SELECT * FROM (SELECT supplier.s_suppkey, supplier.s_name, supplier.s_address, supplier.s_nationkey, supplier.s_phone, supplier.s_acctbal, supplier.s_comment, lineitem.l_orderkey, lineitem.l_partkey, lineitem.l_suppkey, lineitem.l_linenumber, lineitem.l_quantity, lineitem.l_extendedprice, lineitem.l_discount, lineitem.l_tax, lineitem.l_returnflag, lineitem.l_linestatus, lineitem.l_shipdate, lineitem.l_commitdate, lineitem.l_receiptdate, lineitem.l_shipinstruct, lineitem.l_shipmode, lineitem.l_comment, orders.o_orderkey, orders.o_custkey, orders.o_orderstatus, orders.o_totalprice, orders.o_orderdate, orders.o_orderpriority, orders.o_clerk, orders.o_shippriority, orders.o_comment, nation.n_nationkey, nation.n_name, nation.n_regionkey, nation.n_comment, t2.f2 AS f0 FROM supplier CROSS JOIN lineitem CROSS JOIN orders CROSS JOIN nation LEFT JOIN (SELECT t0.l_orderkey AS l_orderkey0, t0.l_suppkey AS l_suppkey0, MIN(TRUE) AS f2 FROM lineitem AS lineitem0 INNER JOIN (SELECT lineitem1.l_orderkey, lineitem1.l_suppkey FROM supplier AS supplier0, lineitem AS lineitem1, orders AS orders0, nation AS nation0 GROUP BY lineitem1.l_orderkey, lineitem1.l_suppkey) AS t0 ON lineitem0.l_orderkey = t0.l_orderkey AND lineitem0.l_suppkey <> t0.l_suppkey GROUP BY t0.l_orderkey, t0.l_suppkey) AS t2 ON lineitem.l_orderkey = t2.l_orderkey0 AND lineitem.l_suppkey = t2.l_suppkey0) AS t3 WHERE t3.s_suppkey = t3.l_suppkey AND (t3.o_orderkey = t3.l_orderkey AND t3.o_orderstatus = 'F') AND (t3.l_receiptdate > t3.l_commitdate AND t3.s_nationkey = t3.n_nationkey AND (t3.n_name = 'CANADA' AND t3.f0 IS NOT NULL))) AS t4 LEFT JOIN (SELECT t13.l_orderkey AS l_orderkey0, t13.l_suppkey AS l_suppkey0, MIN(TRUE) AS f2 FROM (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t5 INNER JOIN (SELECT l_orderkey, l_suppkey FROM (SELECT supplier1.s_suppkey, supplier1.s_name, supplier1.s_address, supplier1.s_nationkey, supplier1.s_phone, supplier1.s_acctbal, supplier1.s_comment, lineitem3.l_orderkey, lineitem3.l_partkey, lineitem3.l_suppkey, lineitem3.l_linenumber, lineitem3.l_quantity, lineitem3.l_extendedprice, lineitem3.l_discount, lineitem3.l_tax, lineitem3.l_returnflag, lineitem3.l_linestatus, lineitem3.l_shipdate, lineitem3.l_commitdate, lineitem3.l_receiptdate, lineitem3.l_shipinstruct, lineitem3.l_shipmode, lineitem3.l_comment, orders1.o_orderkey, orders1.o_custkey, orders1.o_orderstatus, orders1.o_totalprice, orders1.o_orderdate, orders1.o_orderpriority, orders1.o_clerk, orders1.o_shippriority, orders1.o_comment, nation1.n_nationkey, nation1.n_name, nation1.n_regionkey, nation1.n_comment, t9.f2 AS f0 FROM supplier AS supplier1 CROSS JOIN lineitem AS lineitem3 CROSS JOIN orders AS orders1 CROSS JOIN nation AS nation1 LEFT JOIN (SELECT t7.l_orderkey AS l_orderkey0, t7.l_suppkey AS l_suppkey0, MIN(TRUE) AS f2 FROM lineitem AS lineitem4 INNER JOIN (SELECT lineitem5.l_orderkey, lineitem5.l_suppkey FROM supplier AS supplier2, lineitem AS lineitem5, orders AS orders2, nation AS nation2 GROUP BY lineitem5.l_orderkey, lineitem5.l_suppkey) AS t7 ON lineitem4.l_orderkey = t7.l_orderkey AND lineitem4.l_suppkey <> t7.l_suppkey GROUP BY t7.l_orderkey, t7.l_suppkey) AS t9 ON lineitem3.l_orderkey = t9.l_orderkey0 AND lineitem3.l_suppkey = t9.l_suppkey0) AS t10 WHERE t10.s_suppkey = t10.l_suppkey AND (t10.o_orderkey = t10.l_orderkey AND t10.o_orderstatus = 'F') AND (t10.l_receiptdate > t10.l_commitdate AND t10.s_nationkey = t10.n_nationkey AND (t10.n_name = 'CANADA' AND t10.f0 IS NOT NULL)) GROUP BY l_orderkey, l_suppkey) AS t13 ON t5.l_orderkey = t13.l_orderkey AND t5.l_suppkey <> t13.l_suppkey GROUP BY t13.l_orderkey, t13.l_suppkey) AS t15 ON t4.l_orderkey = t15.l_orderkey0 AND t4.l_suppkey = t15.l_suppkey0 WHERE t15.f2 IS NULL GROUP BY t4.s_name ORDER BY COUNT(*) DESC, t4.s_name","['FILTER_INTO_JOIN', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#14' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 10 and l_quantity <= 10 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#13' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 15 and l_quantity <= 15 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#55' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 21 and l_quantity <= 21 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_INTO_JOIN', 'AGGREGATE_PROJECT_MERGE']""]"
59,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('30', '22', '43', '26', '42', '27', '23') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('30', '22', '43', '26', '42', '27', '23') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('30', '22', '43', '26', '42', '27', '23') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('30', '22', '43', '26', '42', '27', '23') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('30', '29', '41', '21', '24', '28', '36') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('30', '29', '41', '21', '24', '28', '36') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
60,tpch,"select l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order from lineitem where l_shipdate <= date '1998-12-01' - interval '115' day (3) group by l_returnflag, l_linestatus order by l_returnflag, l_linestatus;","SELECT l_returnflag, l_linestatus, SUM(l_quantity) AS sum_qty, SUM(l_extendedprice) AS sum_base_price, SUM(l_extendedprice * (1 - l_discount)) AS sum_disc_price, SUM(l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS sum_charge, AVG(l_quantity) AS avg_qty, AVG(l_extendedprice) AS avg_price, AVG(l_discount) AS avg_disc, COUNT(*) AS count_order FROM lineitem WHERE l_shipdate <= (DATE '1998-12-01' - INTERVAL '115' DAY(3)) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus","['FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_ANY_PULL_UP_CONSTANTS', 'SORT_PROJECT_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#43' and p_type not like 'STANDARD PLATED%' and p_size in (18, 28, 41, 22, 24, 13, 16, 40) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_CORRELATE', 'FILTER_MERGE', 'FILTER_MULTI_JOIN_MERGE', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_ANY_PULL_UP_CONSTANTS', 'AGGREGATE_REMOVE', 'JOIN_CONDITION_PUSH', 'SORT_PROJECT_TRANSPOSE', 'SORT_UNION_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE', 'JOIN_EXTRACT_FILTER', 'JOIN_REDUCE_EXPRESSIONS', 'UNION_REMOVE', 'UNION_TO_DISTINCT']""]"
61,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 50 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 50 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('30', '42', '34', '32', '33', '22', '38') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('30', '42', '34', '32', '33', '22', '38') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
62,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'HOUSEHOLD' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-22' and l_shipdate > date '1995-03-22' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'HOUSEHOLD' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-22' and l_shipdate > date '1995-03-22' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate",[],"[""select o_year, sum(case when nation = 'SAUDI ARABIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE BRUSHED STEEL' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
63,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1996-06-01' and o_orderdate < date '1996-06-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1996-06-01' and o_orderdate < date '1996-06-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority",[],"[""select o_year, sum(case when nation = 'ALGERIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM PLATED TIN' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
64,tpch,"select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and o_orderdate >= date '1996-01-01' and o_orderdate < date '1996-01-01' + interval '1' year group by n_name order by revenue desc;","SELECT nation.n_name, SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS revenue FROM customer INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1996-01-01' AND o_orderdate < (DATE '1996-01-01' + INTERVAL '1' YEAR)) AS t ON customer.c_custkey = t.o_custkey INNER JOIN lineitem ON t.o_orderkey = lineitem.l_orderkey INNER JOIN supplier ON lineitem.l_suppkey = supplier.s_suppkey AND customer.c_nationkey = supplier.s_nationkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t0 ON nation.n_regionkey = t0.r_regionkey GROUP BY nation.n_name ORDER BY SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) DESC","['FILTER_INTO_JOIN', 'FILTER_MERGE', 'FILTER_REDUCE_EXPRESSIONS']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#43' and p_type not like 'LARGE BURNISHED%' and p_size in (10, 18, 36, 37, 48, 16, 8, 14) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_INTO_JOIN', 'FILTER_MERGE', 'FILTER_REDUCE_EXPRESSIONS']""]"
65,tpch,select sum(l_extendedprice * l_discount) as revenue from lineitem where l_shipdate >= date '1996-01-01' and l_shipdate < date '1996-01-01' + interval '1' year and l_discount between 0.03 - 0.01 and 0.03 + 0.01 and l_quantity < 24;,SELECT SUM(l_extendedprice * l_discount) AS revenue FROM lineitem WHERE l_shipdate >= DATE '1996-01-01' AND l_shipdate < (DATE '1996-01-01' + INTERVAL '1' YEAR) AND l_discount >= 0.03 - 0.01 AND l_discount <= 0.03 + 0.01 AND l_quantity < 24,"['FILTER_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#35' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 4 and l_quantity <= 4 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#13' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 11 and l_quantity <= 11 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#24' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 28 and l_quantity <= 28 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_INTO_JOIN', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED']""]"
66,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'CANADA' and n2.n_name = 'FRANCE') or (n1.n_name = 'FRANCE' and n2.n_name = 'CANADA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'CANADA' and n2.n_name = 'FRANCE') or (n1.n_name = 'FRANCE' and n2.n_name = 'CANADA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year",[],"[""select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'ARGENTINA' and n2.n_name = 'UNITED STATES') or (n1.n_name = 'UNITED STATES' and n2.n_name = 'ARGENTINA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;""]","[""['Empty List']""]"
67,tpch,"select o_year, sum(case when nation = 'FRANCE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY ANODIZED STEEL' ) as all_nations group by o_year order by o_year;","select o_year, sum(case when nation = 'FRANCE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY ANODIZED STEEL' ) as all_nations group by o_year order by o_year",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 27 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
68,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%peru%' ) as profit group by nation, o_year order by nation, o_year desc;","select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%peru%' ) as profit group by nation, o_year order by nation, o_year desc",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 20 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
69,tpch,"select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from customer, orders, lineitem, nation where c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate >= date '1993-08-01' and o_orderdate < date '1993-08-01' + interval '3' month and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc;","SELECT customer.c_custkey, customer.c_name, SUM(t0.l_extendedprice * (1 - t0.l_discount)) AS revenue, customer.c_acctbal, nation.n_name, customer.c_address, customer.c_phone, customer.c_comment FROM customer INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1993-08-01' AND o_orderdate < (DATE '1993-08-01' + INTERVAL '3' MONTH)) AS t ON customer.c_custkey = t.o_custkey INNER JOIN (SELECT * FROM lineitem WHERE l_returnflag = 'R') AS t0 ON t.o_orderkey = t0.l_orderkey INNER JOIN nation ON customer.c_nationkey = nation.n_nationkey GROUP BY customer.c_custkey, customer.c_name, customer.c_acctbal, customer.c_phone, nation.n_name, customer.c_address, customer.c_comment ORDER BY SUM(t0.l_extendedprice * (1 - t0.l_discount)) DESC","['FILTER_AGGREGATE_TRANSPOSE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'SORT_PROJECT_TRANSPOSE']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#52' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 5 and l_quantity <= 5 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#31' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 19 and l_quantity <= 19 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#32' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 26 and l_quantity <= 26 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_MERGE', 'FILTER_INTO_JOIN', 'FILTER_AGGREGATE_TRANSPOSE', 'PROJECT_REDUCE_EXPRESSIONS', 'AGGREGATE_ANY_PULL_UP_CONSTANTS']""]"
70,tpch,"select ps_partkey, sum(ps_supplycost * ps_availqty) as value from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'JORDAN' group by ps_partkey having sum(ps_supplycost * ps_availqty) > ( select sum(ps_supplycost * ps_availqty) * 0.0001000000 from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'JORDAN' ) order by value desc;","SELECT t1.ps_partkey, t1.value FROM (SELECT partsupp.ps_partkey, SUM(partsupp.ps_supplycost * partsupp.ps_availqty) AS value FROM partsupp INNER JOIN supplier ON partsupp.ps_suppkey = supplier.s_suppkey INNER JOIN (SELECT * FROM nation WHERE n_name = 'JORDAN') AS t ON supplier.s_nationkey = t.n_nationkey GROUP BY partsupp.ps_partkey) AS t1 INNER JOIN (SELECT SUM(partsupp0.ps_supplycost * partsupp0.ps_availqty) * 0.0001000000 AS EXPR0 FROM partsupp AS partsupp0 INNER JOIN supplier AS supplier0 ON partsupp0.ps_suppkey = supplier0.s_suppkey INNER JOIN (SELECT * FROM nation WHERE n_name = 'JORDAN') AS t2 ON supplier0.s_nationkey = t2.n_nationkey) AS t5 ON t1.value > t5.EXPR0 ORDER BY t1.value DESC","['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_ANY_PULL_UP_CONSTANTS', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_REDUCE_EXPRESSIONS', 'SORT_PROJECT_TRANSPOSE']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#25' and p_type not like 'STANDARD BRUSHED%' and p_size in (7, 49, 13, 25, 43, 3, 12, 32) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_PROJECT_TRANSPOSE', 'PROJECT_CORRELATE_TRANSPOSE', 'PROJECT_REMOVE', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS', 'UNION_MERGE', 'FILTER_INSTANCE', 'JOIN_LEFT_INSTANCE', 'JOIN_RIGHT_INSTANCE', 'UNION_INSTANCE']""]"
71,tpch,"select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('TRUCK', 'FOB') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1996-01-01' and l_receiptdate < date '1996-01-01' + interval '1' year group by l_shipmode order by l_shipmode;","SELECT t.l_shipmode, SUM(CASE WHEN orders.o_orderpriority = '1-URGENT' OR orders.o_orderpriority = '2-HIGH' THEN 1 ELSE 0 END) AS high_line_count, SUM(CASE WHEN orders.o_orderpriority <> '1-URGENT' AND orders.o_orderpriority <> '2-HIGH' THEN 1 ELSE 0 END) AS low_line_count FROM orders INNER JOIN (SELECT * FROM lineitem WHERE l_shipmode IN ('FOB', 'TRUCK') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= DATE '1996-01-01' AND l_receiptdate < (DATE '1996-01-01' + INTERVAL '1' YEAR)) AS t ON orders.o_orderkey = t.l_orderkey GROUP BY t.l_shipmode ORDER BY t.l_shipmode","['FILTER_INTO_JOIN', 'FILTER_MERGE', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH', 'AGGREGATE_PROJECT_MERGE']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#45' and p_type not like 'PROMO BURNISHED%' and p_size in (48, 22, 23, 15, 40, 6, 42, 32) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_INTO_JOIN', 'FILTER_MERGE', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED']""]"
72,tpch,"select c_count, count(*) as custdist from ( select c_custkey, count(o_orderkey) from customer left outer join orders on c_custkey = o_custkey and o_comment not like '%express%accounts%' group by c_custkey ) as c_orders (c_custkey, c_count) group by c_count order by custdist desc, c_count desc;","select c_count, count(*) as custdist from ( select c_custkey, count(o_orderkey) from customer left outer join orders on c_custkey = o_custkey and o_comment not like '%express%accounts%' group by c_custkey ) as c_orders (c_custkey, c_count) group by c_count order by custdist desc, c_count desc",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 19 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
73,tpch,"select 100.00 * sum(case when p_type like 'PROMO%' then l_extendedprice * (1 - l_discount) else 0 end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from lineitem, part where l_partkey = p_partkey and l_shipdate >= date '1996-02-01' and l_shipdate < date '1996-02-01' + interval '1' month;",SELECT 100.00 * SUM(CASE WHEN part.p_type LIKE 'PROMO%' THEN t.l_extendedprice * (1 - t.l_discount) ELSE 0 END) / SUM(t.l_extendedprice * (1 - t.l_discount)) AS promo_revenue FROM (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1996-02-01' AND l_shipdate < (DATE '1996-02-01' + INTERVAL '1' MONTH)) AS t INNER JOIN part ON t.l_partkey = part.p_partkey,"['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_MERGE', 'AGGREGATE_PROJECT_MERGE', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_REDUCE_EXPRESSIONS']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#35' and p_type not like 'ECONOMY BURNISHED%' and p_size in (22, 38, 21, 26, 15, 9, 27, 50) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_MERGE', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE']""]"
74,tpch,"select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#42' and p_type not like 'SMALL PLATED%' and p_size in (40, 43, 31, 12, 21, 13, 45, 33) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;","select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#42' and p_type not like 'SMALL PLATED%' and p_size in (40, 43, 31, 12, 21, 13, 45, 33) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('26', '34', '30', '39', '20', '27', '32') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('26', '34', '30', '39', '20', '27', '32') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
75,tpch,"select sum(l_extendedprice) / 7.0 as avg_yearly from lineitem, part where p_partkey = l_partkey and p_brand = 'Brand#22' and p_container = 'JUMBO DRUM' and l_quantity < ( select 0.2 * avg(l_quantity) from lineitem where l_partkey = p_partkey );","select sum(l_extendedprice) / 7.0 as avg_yearly from lineitem, part where p_partkey = l_partkey and p_brand = 'Brand#22' and p_container = 'JUMBO DRUM' and l_quantity < ( select 0.2 * avg(l_quantity) from lineitem where l_partkey = p_partkey )",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 34 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
76,tpch,"select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#45' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 9 and l_quantity <= 9 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#31' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 16 and l_quantity <= 16 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#21' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 24 and l_quantity <= 24 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );","SELECT SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS revenue FROM lineitem, part WHERE part.p_partkey = lineitem.l_partkey AND part.p_brand = 'Brand#45' AND (part.p_container IN ('SM BOX', 'SM CASE', 'SM PACK', 'SM PKG') AND lineitem.l_quantity >= 9) AND (lineitem.l_quantity <= 9 + 10 AND (part.p_size >= 1 AND part.p_size <= 5) AND (lineitem.l_shipmode IN ('AIR', 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON')) OR part.p_partkey = lineitem.l_partkey AND part.p_brand = 'Brand#31' AND (part.p_container IN ('MED BAG', 'MED BOX', 'MED PACK', 'MED PKG') AND lineitem.l_quantity >= 16) AND (lineitem.l_quantity <= 16 + 10 AND (part.p_size >= 1 AND part.p_size <= 10) AND (lineitem.l_shipmode IN ('AIR', 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON')) OR part.p_partkey = lineitem.l_partkey AND part.p_brand = 'Brand#21' AND (part.p_container IN ('LG BOX', 'LG CASE', 'LG PACK', 'LG PKG') AND lineitem.l_quantity >= 24) AND (lineitem.l_quantity <= 24 + 10 AND (part.p_size >= 1 AND part.p_size <= 15) AND (lineitem.l_shipmode IN ('AIR', 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))","['FILTER_SCAN', 'JOIN_REDUCE_EXPRESSIONS', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_MERGE', 'AGGREGATE_PROJECT_MERGE']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#42' and p_type not like 'STANDARD PLATED%' and p_size in (30, 1, 28, 23, 31, 33, 19, 21) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_SCAN', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'JOIN_LEFT_UNION_TRANSPOSE', 'JOIN_REDUCE_EXPRESSIONS', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE', 'FILTER_AGGREGATE_TRANSPOSE', 'AGGREGATE_UNION_TRANSPOSE', 'SORT_UNION_TRANSPOSE', 'AGGREGATE_REMOVE', 'FILTER_MERGE', 'SORT_REMOVE_CONSTANT_KEYS']""]"
77,tpch,"select s_name, s_address from supplier, nation where s_suppkey in ( select ps_suppkey from partsupp where ps_partkey in ( select p_partkey from part where p_name like 'sienna%' ) and ps_availqty > ( select 0.5 * sum(l_quantity) from lineitem where l_partkey = ps_partkey and l_suppkey = ps_suppkey and l_shipdate >= date '1995-01-01' and l_shipdate < date '1995-01-01' + interval '1' year ) ) and s_nationkey = n_nationkey and n_name = 'EGYPT' order by s_name;","select s_name, s_address from supplier, nation where s_suppkey in ( select ps_suppkey from partsupp where ps_partkey in ( select p_partkey from part where p_name like 'sienna%' ) and ps_availqty > ( select 0.5 * sum(l_quantity) from lineitem where l_partkey = ps_partkey and l_suppkey = ps_suppkey and l_shipdate >= date '1995-01-01' and l_shipdate < date '1995-01-01' + interval '1' year ) ) and s_nationkey = n_nationkey and n_name = 'EGYPT' order by s_name",[],"[""select o_year, sum(case when nation = 'ROMANIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD BRUSHED STEEL' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
78,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'KENYA' group by s_name order by numwait desc, s_name;","select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'KENYA' group by s_name order by numwait desc, s_name",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('36', '43', '34', '40', '37', '44', '28') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('36', '43', '34', '40', '37', '44', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
79,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('24', '29', '25', '42', '36', '32', '33') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('24', '29', '25', '42', '36', '32', '33') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(t.c_phone) + 1) < 1 THEN CHAR_LENGTH(t.c_phone) + 1 ELSE 1 END FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '24' OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '29' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '25') OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '42' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '36' OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '32' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '33'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '24' OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '29' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '25') OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '42' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '36' OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '32' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '33')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, MIN(TRUE) AS f1 FROM orders GROUP BY o_custkey) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f1 IS NULL GROUP BY SUBSTR(t.c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(t.c_phone) + 1) < 1 THEN CHAR_LENGTH(t.c_phone) + 1 ELSE 1 END FOR 2) ORDER BY SUBSTR(t.c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(t.c_phone) + 1) < 1 THEN CHAR_LENGTH(t.c_phone) + 1 ELSE 1 END FOR 2)","['FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_ANY_PULL_UP_CONSTANTS']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#33' and p_type not like 'ECONOMY ANODIZED%' and p_size in (13, 3, 36, 10, 43, 40, 27, 34) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_SCAN', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_MULTI_JOIN_MERGE', 'FILTER_CORRELATE', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'AGGREGATE_PROJECT_MERGE']""]"
80,tpch,"select l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order from lineitem where l_shipdate <= date '1998-12-01' - interval '105' day (3) group by l_returnflag, l_linestatus order by l_returnflag, l_linestatus;","select l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order from lineitem where l_shipdate <= date '1998-12-01' - interval '105' day (3) group by l_returnflag, l_linestatus order by l_returnflag, l_linestatus",[],"[""select o_year, sum(case when nation = 'CANADA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE PLATED TIN' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
81,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 22 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT supplier.s_acctbal, supplier.s_name, nation.n_name, t.p_partkey, t.p_mfgr, supplier.s_address, supplier.s_phone, supplier.s_comment FROM (SELECT * FROM part WHERE p_size = 22 AND p_type LIKE '%NICKEL') AS t CROSS JOIN supplier INNER JOIN partsupp ON t.p_partkey = partsupp.ps_partkey AND supplier.s_suppkey = partsupp.ps_suppkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t0 ON nation.n_regionkey = t0.r_regionkey INNER JOIN (SELECT partsupp0.ps_partkey, MIN(partsupp0.ps_supplycost) AS EXPR0 FROM partsupp AS partsupp0 INNER JOIN supplier AS supplier0 ON partsupp0.ps_suppkey = supplier0.s_suppkey INNER JOIN nation AS nation0 ON supplier0.s_nationkey = nation0.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1 ON nation0.n_regionkey = t1.r_regionkey GROUP BY partsupp0.ps_partkey) AS t3 ON t.p_partkey = t3.ps_partkey AND partsupp.ps_supplycost = t3.EXPR0 ORDER BY supplier.s_acctbal DESC, nation.n_name, supplier.s_name, t.p_partkey","['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'SORT_JOIN_TRANSPOSE']","[""select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('MAIL', 'AIR') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1994-01-01' and l_receiptdate < date '1994-01-01' + interval '1' year group by l_shipmode order by l_shipmode;""]","[""['AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'FILTER_AGGREGATE_TRANSPOSE', 'FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'SORT_JOIN_TRANSPOSE']""]"
82,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'HOUSEHOLD' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-05' and l_shipdate > date '1995-03-05' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t1.l_orderkey, SUM(t1.l_extendedprice * (1 - t1.l_discount)) AS revenue, t0.o_orderdate, t0.o_shippriority FROM (SELECT * FROM customer WHERE c_mktsegment = 'HOUSEHOLD') AS t INNER JOIN (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-05') AS t0 ON t.c_custkey = t0.o_custkey INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-05') AS t1 ON t0.o_orderkey = t1.l_orderkey GROUP BY t1.l_orderkey, t0.o_orderdate, t0.o_shippriority ORDER BY SUM(t1.l_extendedprice * (1 - t1.l_discount)) DESC, t0.o_orderdate","['SORT_PROJECT_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS', 'FILTER_SCAN', 'FILTER_MERGE', 'FILTER_INTO_JOIN']","[""select o_year, sum(case when nation = 'ROMANIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL BRUSHED BRASS' ) as all_nations group by o_year order by o_year;""]","[""['SORT_PROJECT_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS', 'FILTER_SCAN', 'FILTER_MERGE', 'FILTER_INTO_JOIN']""]"
83,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1993-09-01' and o_orderdate < date '1993-09-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","SELECT t.o_orderpriority, COUNT(*) AS order_count FROM (SELECT * FROM orders WHERE o_orderdate >= DATE '1993-09-01' AND o_orderdate < (DATE '1993-09-01' + INTERVAL '3' MONTH)) AS t INNER JOIN (SELECT l_orderkey, MIN(TRUE) AS f1 FROM lineitem WHERE l_commitdate < l_receiptdate GROUP BY l_orderkey) AS t2 ON t.o_orderkey = t2.l_orderkey GROUP BY t.o_orderpriority ORDER BY t.o_orderpriority","['FILTER_AGGREGATE_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#51' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 2 and l_quantity <= 2 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#24' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 10 and l_quantity <= 10 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#23' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 20 and l_quantity <= 20 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'JOIN_RIGHT_INSTANCE', 'FILTER_INSTANCE', 'PROJECT_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE']""]"
84,tpch,"select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and o_orderdate >= date '1995-01-01' and o_orderdate < date '1995-01-01' + interval '1' year group by n_name order by revenue desc;","SELECT nation.n_name, SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS revenue FROM customer INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate < (DATE '1995-01-01' + INTERVAL '1' YEAR)) AS t ON customer.c_custkey = t.o_custkey INNER JOIN lineitem ON t.o_orderkey = lineitem.l_orderkey INNER JOIN supplier ON lineitem.l_suppkey = supplier.s_suppkey AND customer.c_nationkey = supplier.s_nationkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'ASIA') AS t0 ON nation.n_regionkey = t0.r_regionkey GROUP BY nation.n_name ORDER BY SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) DESC","['FILTER_MERGE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'AGGREGATE_PROJECT_MERGE', 'SORT_PROJECT_TRANSPOSE']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#44' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 5 and l_quantity <= 5 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#41' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 20 and l_quantity <= 20 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#13' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 30 and l_quantity <= 30 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_MERGE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'AGGREGATE_PROJECT_MERGE']""]"
85,tpch,select sum(l_extendedprice * l_discount) as revenue from lineitem where l_shipdate >= date '1995-01-01' and l_shipdate < date '1995-01-01' + interval '1' year and l_discount between 0.08 - 0.01 and 0.08 + 0.01 and l_quantity < 24;,select sum(l_extendedprice * l_discount) as revenue from lineitem where l_shipdate >= date '1995-01-01' and l_shipdate < date '1995-01-01' + interval '1' year and l_discount between 0.08 - 0.01 and 0.08 + 0.01 and l_quantity < 24,[],"[""select o_year, sum(case when nation = 'KENYA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY BRUSHED COPPER' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
86,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'SAUDI ARABIA' and n2.n_name = 'ALGERIA') or (n1.n_name = 'ALGERIA' and n2.n_name = 'SAUDI ARABIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation.n_name AS supp_nation, nation0.n_name AS cust_nation, EXTRACT(YEAR FROM t.l_shipdate) AS l_year, SUM(t.l_extendedprice * (1 - t.l_discount)) AS revenue FROM supplier INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t ON supplier.s_suppkey = t.l_suppkey INNER JOIN orders ON t.l_orderkey = orders.o_orderkey INNER JOIN customer ON orders.o_custkey = customer.c_custkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey INNER JOIN nation AS nation0 ON customer.c_nationkey = nation0.n_nationkey AND (nation.n_name = 'SAUDI ARABIA' AND nation0.n_name = 'ALGERIA' OR nation.n_name = 'ALGERIA' AND nation0.n_name = 'SAUDI ARABIA') GROUP BY nation.n_name, nation0.n_name, EXTRACT(YEAR FROM t.l_shipdate) ORDER BY nation.n_name, nation0.n_name, EXTRACT(YEAR FROM t.l_shipdate)","['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_AGGREGATE_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE', 'SORT_REMOVE_CONSTANT_KEYS']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#24' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 6 and l_quantity <= 6 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#25' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 10 and l_quantity <= 10 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#44' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 23 and l_quantity <= 23 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_INTO_JOIN', 'FILTER_AGGREGATE_TRANSPOSE', 'JOIN_CONDITION_PUSH', 'AGGREGATE_PROJECT_MERGE']""]"
87,tpch,"select o_year, sum(case when nation = 'ALGERIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO ANODIZED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t0.o_orderdate) AS o_year, SUM(CASE WHEN nation0.n_name = 'ALGERIA' THEN lineitem.l_extendedprice * (1 - lineitem.l_discount) ELSE 0 END) / SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'PROMO ANODIZED BRASS') AS t CROSS JOIN supplier INNER JOIN lineitem ON t.p_partkey = lineitem.l_partkey AND supplier.s_suppkey = lineitem.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t0 ON lineitem.l_orderkey = t0.o_orderkey INNER JOIN customer ON t0.o_custkey = customer.c_custkey INNER JOIN nation ON customer.c_nationkey = nation.n_nationkey INNER JOIN nation AS nation0 ON supplier.s_nationkey = nation0.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1 ON nation.n_regionkey = t1.r_regionkey GROUP BY EXTRACT(YEAR FROM t0.o_orderdate) ORDER BY EXTRACT(YEAR FROM t0.o_orderdate)","['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'AGGREGATE_PROJECT_MERGE']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#41' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 9 and l_quantity <= 9 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#23' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 16 and l_quantity <= 16 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#45' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 27 and l_quantity <= 27 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH']""]"
88,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%sky%' ) as profit group by nation, o_year order by nation, o_year desc;","select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%sky%' ) as profit group by nation, o_year order by nation, o_year desc",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 49 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
89,tpch,"select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from customer, orders, lineitem, nation where c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate >= date '1994-12-01' and o_orderdate < date '1994-12-01' + interval '3' month and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc;","SELECT customer.c_custkey, customer.c_name, SUM(t0.l_extendedprice * (1 - t0.l_discount)) AS revenue, customer.c_acctbal, nation.n_name, customer.c_address, customer.c_phone, customer.c_comment FROM customer INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1994-12-01' AND o_orderdate < (DATE '1994-12-01' + INTERVAL '3' MONTH)) AS t ON customer.c_custkey = t.o_custkey INNER JOIN (SELECT * FROM lineitem WHERE l_returnflag = 'R') AS t0 ON t.o_orderkey = t0.l_orderkey INNER JOIN nation ON customer.c_nationkey = nation.n_nationkey GROUP BY customer.c_custkey, customer.c_name, customer.c_acctbal, customer.c_phone, nation.n_name, customer.c_address, customer.c_comment ORDER BY SUM(t0.l_extendedprice * (1 - t0.l_discount)) DESC","['FILTER_INTO_JOIN', 'SORT_PROJECT_TRANSPOSE']","[""select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'INDIA' and n2.n_name = 'JAPAN') or (n1.n_name = 'JAPAN' and n2.n_name = 'INDIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;""]","[""['FILTER_INTO_JOIN']""]"
90,tpch,"select ps_partkey, sum(ps_supplycost * ps_availqty) as value from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'ROMANIA' group by ps_partkey having sum(ps_supplycost * ps_availqty) > ( select sum(ps_supplycost * ps_availqty) * 0.0001000000 from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'ROMANIA' ) order by value desc;","select ps_partkey, sum(ps_supplycost * ps_availqty) as value from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'ROMANIA' group by ps_partkey having sum(ps_supplycost * ps_availqty) > ( select sum(ps_supplycost * ps_availqty) * 0.0001000000 from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'ROMANIA' ) order by value desc",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 31 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
91,tpch,"select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('RAIL', 'TRUCK') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1995-01-01' and l_receiptdate < date '1995-01-01' + interval '1' year group by l_shipmode order by l_shipmode;","select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('RAIL', 'TRUCK') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1995-01-01' and l_receiptdate < date '1995-01-01' + interval '1' year group by l_shipmode order by l_shipmode",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 31 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
92,tpch,"select c_count, count(*) as custdist from ( select c_custkey, count(o_orderkey) from customer left outer join orders on c_custkey = o_custkey and o_comment not like '%pending%accounts%' group by c_custkey ) as c_orders (c_custkey, c_count) group by c_count order by custdist desc, c_count desc;","select c_count, count(*) as custdist from ( select c_custkey, count(o_orderkey) from customer left outer join orders on c_custkey = o_custkey and o_comment not like '%pending%accounts%' group by c_custkey ) as c_orders (c_custkey, c_count) group by c_count order by custdist desc, c_count desc",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('36', '27', '30', '35', '20', '28', '40') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('36', '27', '30', '35', '20', '28', '40') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
93,tpch,"select 100.00 * sum(case when p_type like 'PROMO%' then l_extendedprice * (1 - l_discount) else 0 end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from lineitem, part where l_partkey = p_partkey and l_shipdate >= date '1995-07-01' and l_shipdate < date '1995-07-01' + interval '1' month;","SELECT 100.00 * SUM(CASE WHEN part.p_type LIKE 'PROMO%' THEN t.l_extendedprice * (1 - t.l_discount) ELSE 0 END) / SUM(t.l_extendedprice * (1 - t.l_discount)) AS promo_revenue FROM (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-07-01' AND l_shipdate < (DATE '1995-07-01' + INTERVAL '1' MONTH)) AS t, part WHERE t.l_partkey = part.p_partkey","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_REDUCE_EXPRESSIONS']","[""select o_year, sum(case when nation = 'ROMANIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO POLISHED NICKEL' ) as all_nations group by o_year order by o_year;""]","[""['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_TO_CALC', 'FILTER_INTO_JOIN']""]"
94,tpch,"select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#14' and p_type not like 'PROMO BURNISHED%' and p_size in (45, 8, 31, 48, 42, 33, 22, 1) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;","select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#14' and p_type not like 'PROMO BURNISHED%' and p_size in (45, 8, 31, 48, 42, 33, 22, 1) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size",[],"[""select o_year, sum(case when nation = 'UNITED KINGDOM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL PLATED NICKEL' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
95,tpch,"select sum(l_extendedprice) / 7.0 as avg_yearly from lineitem, part where p_partkey = l_partkey and p_brand = 'Brand#45' and p_container = 'WRAP JAR' and l_quantity < ( select 0.2 * avg(l_quantity) from lineitem where l_partkey = p_partkey );","SELECT SUM(t0.l_extendedprice) / 7.0 AS avg_yearly FROM (SELECT * FROM lineitem, (SELECT * FROM part WHERE p_brand = 'Brand#45' AND p_container = 'WRAP JAR') AS t WHERE t.p_partkey = lineitem.l_partkey) AS t0, (SELECT l_partkey, AVG(l_quantity) AS f1 FROM lineitem GROUP BY l_partkey) AS t2 WHERE t0.p_partkey = t2.l_partkey AND t0.l_quantity < 0.2 * t2.f1","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_CORRELATE']","[""select o_year, sum(case when nation = 'MOROCCO' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD POLISHED BRASS' ) as all_nations group by o_year order by o_year;""]","[""['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN']""]"
96,tpch,"select c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, sum(l_quantity) from customer, orders, lineitem where o_orderkey in ( select l_orderkey from lineitem group by l_orderkey having sum(l_quantity) > 315 ) and c_custkey = o_custkey and o_orderkey = l_orderkey group by c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice order by o_totalprice desc, o_orderdate;","select c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, sum(l_quantity) from customer, orders, lineitem where o_orderkey in ( select l_orderkey from lineitem group by l_orderkey having sum(l_quantity) > 315 ) and c_custkey = o_custkey and o_orderkey = l_orderkey group by c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice order by o_totalprice desc, o_orderdate",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 49 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
97,tpch,"select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#51' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 4 and l_quantity <= 4 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#35' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 19 and l_quantity <= 19 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#54' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 30 and l_quantity <= 30 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );",SELECT SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS revenue FROM lineitem INNER JOIN part ON lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#51' AND ((part.p_container = 'SM CASE' OR part.p_container = 'SM BOX' OR part.p_container = 'SM PACK' OR part.p_container = 'SM PKG') AND lineitem.l_quantity >= 4) AND (lineitem.l_quantity <= 4 + 10 AND part.p_size >= 1 AND (part.p_size <= 5 AND ((lineitem.l_shipmode = 'AIR' OR lineitem.l_shipmode = 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))) OR lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#35' AND ((part.p_container = 'MED BAG' OR part.p_container = 'MED BOX' OR part.p_container = 'MED PKG' OR part.p_container = 'MED PACK') AND lineitem.l_quantity >= 19) AND (lineitem.l_quantity <= 19 + 10 AND part.p_size >= 1 AND (part.p_size <= 10 AND ((lineitem.l_shipmode = 'AIR' OR lineitem.l_shipmode = 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))) OR lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#54' AND ((part.p_container = 'LG CASE' OR part.p_container = 'LG BOX' OR part.p_container = 'LG PACK' OR part.p_container = 'LG PKG') AND lineitem.l_quantity >= 30) AND (lineitem.l_quantity <= 30 + 10 AND part.p_size >= 1 AND (part.p_size <= 15 AND ((lineitem.l_shipmode = 'AIR' OR lineitem.l_shipmode = 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))),"['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_REDUCE_EXPRESSIONS']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#25' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 7 and l_quantity <= 7 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#11' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 10 and l_quantity <= 10 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#23' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 20 and l_quantity <= 20 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'PROJECT_TO_CALC']""]"
98,tpch,"select s_name, s_address from supplier, nation where s_suppkey in ( select ps_suppkey from partsupp where ps_partkey in ( select p_partkey from part where p_name like 'burnished%' ) and ps_availqty > ( select 0.5 * sum(l_quantity) from lineitem where l_partkey = ps_partkey and l_suppkey = ps_suppkey and l_shipdate >= date '1995-01-01' and l_shipdate < date '1995-01-01' + interval '1' year ) ) and s_nationkey = n_nationkey and n_name = 'UNITED KINGDOM' order by s_name;","SELECT t0.s_name, t0.s_address FROM (SELECT * FROM supplier, (SELECT * FROM nation WHERE n_name = 'UNITED KINGDOM') AS t WHERE supplier.s_nationkey = t.n_nationkey) AS t0, (SELECT t4.ps_suppkey FROM (SELECT * FROM partsupp, (SELECT p_partkey FROM part WHERE p_name LIKE 'burnished%' GROUP BY p_partkey) AS t3 WHERE partsupp.ps_partkey = t3.p_partkey) AS t4, (SELECT l_partkey, l_suppkey, SUM(l_quantity) AS f2 FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate < (DATE '1995-01-01' + INTERVAL '1' YEAR) GROUP BY l_partkey, l_suppkey) AS t7 WHERE t4.ps_partkey = t7.l_partkey AND t4.ps_suppkey = t7.l_suppkey AND t4.ps_availqty > 0.5 * t7.f2 GROUP BY t4.ps_suppkey) AS t11 WHERE t0.s_suppkey = t11.ps_suppkey ORDER BY t0.s_name","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_AGGREGATE_TRANSPOSE']","[""select o_year, sum(case when nation = 'IRAQ' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO POLISHED STEEL' ) as all_nations group by o_year order by o_year;""]","[""['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_TO_CALC', 'FILTER_INTO_JOIN']""]"
99,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('43', '40', '36', '30', '42', '20', '34') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('43', '40', '36', '30', '42', '20', '34') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('43', '40', '36', '30', '42', '20', '34') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('43', '40', '36', '30', '42', '20', '34') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode",[],"[""select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%pale%' ) as profit group by nation, o_year order by nation, o_year desc;""]","[""['Empty List']""]"
100,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 43 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT supplier.s_acctbal, supplier.s_name, nation.n_name, t.p_partkey, t.p_mfgr, supplier.s_address, supplier.s_phone, supplier.s_comment FROM (SELECT * FROM part WHERE p_size = 43 AND p_type LIKE '%STEEL') AS t CROSS JOIN supplier INNER JOIN partsupp ON t.p_partkey = partsupp.ps_partkey AND supplier.s_suppkey = partsupp.ps_suppkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'EUROPE') AS t0 ON nation.n_regionkey = t0.r_regionkey INNER JOIN (SELECT partsupp0.ps_partkey, MIN(partsupp0.ps_supplycost) AS EXPR0 FROM partsupp AS partsupp0 INNER JOIN supplier AS supplier0 ON partsupp0.ps_suppkey = supplier0.s_suppkey INNER JOIN nation AS nation0 ON supplier0.s_nationkey = nation0.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1 ON nation0.n_regionkey = t1.r_regionkey GROUP BY partsupp0.ps_partkey) AS t2 ON t.p_partkey = t2.ps_partkey AND partsupp.ps_supplycost = t2.EXPR0 ORDER BY supplier.s_acctbal DESC, nation.n_name, supplier.s_name, t.p_partkey","['FILTER_SCAN', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'JOIN_REDUCE_EXPRESSIONS', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_UNION_TRANSPOSE', 'JOIN_LEFT_UNION_TRANSPOSE', 'JOIN_RIGHT_UNION_TRANSPOSE', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'AGGREGATE_ANY_PULL_UP_CONSTANTS', 'AGGREGATE_PROJECT_MERGE']","[""select o_year, sum(case when nation = 'GERMANY' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE BRUSHED COPPER' ) as all_nations group by o_year order by o_year;""]","[""['FILTER_SCAN', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE', 'SORT_UNION_TRANSPOSE', 'JOIN_LEFT_UNION_TRANSPOSE', 'JOIN_RIGHT_UNION_TRANSPOSE', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'AGGREGATE_ANY_PULL_UP_CONSTANTS', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_UNION_TRANSPOSE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'FILTER_AGGREGATE_TRANSPOSE']""]"
101,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'BUILDING' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-21' and l_shipdate > date '1995-03-21' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'BUILDING' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-21' and l_shipdate > date '1995-03-21' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate",[],"[""select o_year, sum(case when nation = 'BRAZIL' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM BURNISHED COPPER' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
102,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1996-04-01' and o_orderdate < date '1996-04-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","SELECT t.o_orderpriority, COUNT(*) AS order_count FROM (SELECT * FROM orders WHERE o_orderdate >= DATE '1996-04-01' AND o_orderdate < (DATE '1996-04-01' + INTERVAL '3' MONTH)) AS t INNER JOIN (SELECT l_orderkey, MIN(TRUE) AS f1 FROM lineitem WHERE l_commitdate < l_receiptdate GROUP BY l_orderkey) AS t2 ON t.o_orderkey = t2.l_orderkey GROUP BY t.o_orderpriority ORDER BY t.o_orderpriority","['FILTER_AGGREGATE_TRANSPOSE', 'FILTER_CORRELATE']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#11' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 6 and l_quantity <= 6 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#13' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 12 and l_quantity <= 12 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#14' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 22 and l_quantity <= 22 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_AGGREGATE_TRANSPOSE', 'FILTER_INTO_JOIN']""]"
103,tpch,"select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and o_orderdate >= date '1996-01-01' and o_orderdate < date '1996-01-01' + interval '1' year group by n_name order by revenue desc;","select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and o_orderdate >= date '1996-01-01' and o_orderdate < date '1996-01-01' + interval '1' year group by n_name order by revenue desc",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 15 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
104,tpch,select sum(l_extendedprice * l_discount) as revenue from lineitem where l_shipdate >= date '1996-01-01' and l_shipdate < date '1996-01-01' + interval '1' year and l_discount between 0.04 - 0.01 and 0.04 + 0.01 and l_quantity < 25;,SELECT SUM(l_extendedprice * l_discount) AS revenue FROM lineitem WHERE l_shipdate >= DATE '1996-01-01' AND l_shipdate < (DATE '1996-01-01' + INTERVAL '1' YEAR) AND l_discount >= 0.04 - 0.01 AND l_discount <= 0.04 + 0.01 AND l_quantity < 25,"['FILTER_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#14' and p_type not like 'SMALL ANODIZED%' and p_size in (15, 33, 37, 26, 23, 3, 29, 4) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_MERGE', 'JOIN_CONDITION_PUSH', 'PROJECT_REDUCE_EXPRESSIONS', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'FILTER_CORRELATE', 'JOIN_PROJECT_BOTH_TRANSPOSE']""]"
105,tpch,"select o_year, sum(case when nation = 'JAPAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY PLATED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t0.o_orderdate) AS o_year, SUM(CASE WHEN nation0.n_name = 'JAPAN' THEN lineitem.l_extendedprice * (1 - lineitem.l_discount) ELSE 0 END) / SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'ECONOMY PLATED COPPER') AS t CROSS JOIN supplier INNER JOIN lineitem ON t.p_partkey = lineitem.l_partkey AND supplier.s_suppkey = lineitem.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t0 ON lineitem.l_orderkey = t0.o_orderkey INNER JOIN customer ON t0.o_custkey = customer.c_custkey INNER JOIN nation ON customer.c_nationkey = nation.n_nationkey INNER JOIN nation AS nation0 ON supplier.s_nationkey = nation0.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'ASIA') AS t1 ON nation.n_regionkey = t1.r_regionkey GROUP BY EXTRACT(YEAR FROM t0.o_orderdate) ORDER BY EXTRACT(YEAR FROM t0.o_orderdate)","['FILTER_MERGE', 'FILTER_INTO_JOIN', 'FILTER_AGGREGATE_TRANSPOSE', 'PROJECT_REDUCE_EXPRESSIONS', 'AGGREGATE_ANY_PULL_UP_CONSTANTS', 'SORT_PROJECT_TRANSPOSE']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#44' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 9 and l_quantity <= 9 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#34' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 14 and l_quantity <= 14 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#24' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 28 and l_quantity <= 28 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_MERGE', 'FILTER_INTO_JOIN', 'FILTER_AGGREGATE_TRANSPOSE', 'PROJECT_REDUCE_EXPRESSIONS', 'AGGREGATE_ANY_PULL_UP_CONSTANTS']""]"
106,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%rose%' ) as profit group by nation, o_year order by nation, o_year desc;","select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%rose%' ) as profit group by nation, o_year order by nation, o_year desc",[],"[""select o_year, sum(case when nation = 'UNITED KINGDOM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE BRUSHED NICKEL' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
107,tpch,"select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from customer, orders, lineitem, nation where c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate >= date '1994-03-01' and o_orderdate < date '1994-03-01' + interval '3' month and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc;","select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from customer, orders, lineitem, nation where c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate >= date '1994-03-01' and o_orderdate < date '1994-03-01' + interval '3' month and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('30', '34', '36', '29', '20', '33', '28') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('30', '34', '36', '29', '20', '33', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
108,tpch,"select ps_partkey, sum(ps_supplycost * ps_availqty) as value from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'JAPAN' group by ps_partkey having sum(ps_supplycost * ps_availqty) > ( select sum(ps_supplycost * ps_availqty) * 0.0001000000 from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'JAPAN' ) order by value desc;","select ps_partkey, sum(ps_supplycost * ps_availqty) as value from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'JAPAN' group by ps_partkey having sum(ps_supplycost * ps_availqty) > ( select sum(ps_supplycost * ps_availqty) * 0.0001000000 from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'JAPAN' ) order by value desc",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('21', '42', '29', '39', '31', '38', '34') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('21', '42', '29', '39', '31', '38', '34') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
109,tpch,"select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('FOB', 'REG AIR') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1996-01-01' and l_receiptdate < date '1996-01-01' + interval '1' year group by l_shipmode order by l_shipmode;","SELECT t.l_shipmode, SUM(CASE WHEN orders.o_orderpriority = '1-URGENT' OR orders.o_orderpriority = '2-HIGH' THEN 1 ELSE 0 END) AS high_line_count, SUM(CASE WHEN orders.o_orderpriority <> '1-URGENT' AND orders.o_orderpriority <> '2-HIGH' THEN 1 ELSE 0 END) AS low_line_count FROM orders INNER JOIN (SELECT * FROM lineitem WHERE l_shipmode IN ('FOB', 'REG AIR') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= DATE '1996-01-01' AND l_receiptdate < (DATE '1996-01-01' + INTERVAL '1' YEAR)) AS t ON orders.o_orderkey = t.l_orderkey GROUP BY t.l_shipmode ORDER BY t.l_shipmode","['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_AGGREGATE_TRANSPOSE', 'SORT_JOIN_TRANSPOSE']","[""select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('MAIL', 'AIR') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1994-01-01' and l_receiptdate < date '1994-01-01' + interval '1' year group by l_shipmode order by l_shipmode;""]","[""['AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'FILTER_AGGREGATE_TRANSPOSE', 'FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'SORT_JOIN_TRANSPOSE']""]"
110,tpch,"select c_count, count(*) as custdist from ( select c_custkey, count(o_orderkey) from customer left outer join orders on c_custkey = o_custkey and o_comment not like '%special%deposits%' group by c_custkey ) as c_orders (c_custkey, c_count) group by c_count order by custdist desc, c_count desc;","select c_count, count(*) as custdist from ( select c_custkey, count(o_orderkey) from customer left outer join orders on c_custkey = o_custkey and o_comment not like '%special%deposits%' group by c_custkey ) as c_orders (c_custkey, c_count) group by c_count order by custdist desc, c_count desc",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('24', '27', '39', '31', '33', '22', '21') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('24', '27', '39', '31', '33', '22', '21') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
111,tpch,"select 100.00 * sum(case when p_type like 'PROMO%' then l_extendedprice * (1 - l_discount) else 0 end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from lineitem, part where l_partkey = p_partkey and l_shipdate >= date '1996-10-01' and l_shipdate < date '1996-10-01' + interval '1' month;","select 100.00 * sum(case when p_type like 'PROMO%' then l_extendedprice * (1 - l_discount) else 0 end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from lineitem, part where l_partkey = p_partkey and l_shipdate >= date '1996-10-01' and l_shipdate < date '1996-10-01' + interval '1' month",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 50 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
112,tpch,"select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#43' and p_type not like 'LARGE ANODIZED%' and p_size in (48, 16, 49, 36, 41, 40, 3, 32) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;","select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#43' and p_type not like 'LARGE ANODIZED%' and p_size in (48, 16, 49, 36, 41, 40, 3, 32) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('36', '29', '20', '25', '42', '33', '23') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('36', '29', '20', '25', '42', '33', '23') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
113,tpch,"select sum(l_extendedprice) / 7.0 as avg_yearly from lineitem, part where p_partkey = l_partkey and p_brand = 'Brand#33' and p_container = 'WRAP PKG' and l_quantity < ( select 0.2 * avg(l_quantity) from lineitem where l_partkey = p_partkey );","select sum(l_extendedprice) / 7.0 as avg_yearly from lineitem, part where p_partkey = l_partkey and p_brand = 'Brand#33' and p_container = 'WRAP PKG' and l_quantity < ( select 0.2 * avg(l_quantity) from lineitem where l_partkey = p_partkey )",[],"[""select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'CHINA' group by s_name order by numwait desc, s_name;""]","[""['Empty List']""]"
114,tpch,"select c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, sum(l_quantity) from customer, orders, lineitem where o_orderkey in ( select l_orderkey from lineitem group by l_orderkey having sum(l_quantity) > 314 ) and c_custkey = o_custkey and o_orderkey = l_orderkey group by c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice order by o_totalprice desc, o_orderdate;","SELECT customer.c_name, customer.c_custkey, orders.o_orderkey, orders.o_orderdate, orders.o_totalprice, SUM(lineitem.l_quantity) FROM customer INNER JOIN orders ON customer.c_custkey = orders.o_custkey INNER JOIN lineitem ON orders.o_orderkey = lineitem.l_orderkey INNER JOIN (SELECT l_orderkey FROM (SELECT l_orderkey FROM lineitem GROUP BY l_orderkey HAVING SUM(l_quantity) > 314) AS t2 GROUP BY l_orderkey) AS t3 ON orders.o_orderkey = t3.l_orderkey GROUP BY customer.c_name, customer.c_custkey, orders.o_orderkey, orders.o_orderdate, orders.o_totalprice ORDER BY orders.o_totalprice DESC, orders.o_orderdate","['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'SORT_PROJECT_TRANSPOSE']","[""select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('FOB', 'SHIP') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1995-01-01' and l_receiptdate < date '1995-01-01' + interval '1' year group by l_shipmode order by l_shipmode;""]","[""['FILTER_MERGE', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'PROJECT_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_ANY_PULL_UP_CONSTANTS']""]"
115,tpch,"select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#52' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 10 and l_quantity <= 10 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#54' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 16 and l_quantity <= 16 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#44' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 28 and l_quantity <= 28 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );","select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#52' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 10 and l_quantity <= 10 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#54' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 16 and l_quantity <= 16 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#44' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 28 and l_quantity <= 28 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' )",[],"[""select o_year, sum(case when nation = 'ROMANIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM BURNISHED STEEL' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
116,tpch,"select s_name, s_address from supplier, nation where s_suppkey in ( select ps_suppkey from partsupp where ps_partkey in ( select p_partkey from part where p_name like 'floral%' ) and ps_availqty > ( select 0.5 * sum(l_quantity) from lineitem where l_partkey = ps_partkey and l_suppkey = ps_suppkey and l_shipdate >= date '1997-01-01' and l_shipdate < date '1997-01-01' + interval '1' year ) ) and s_nationkey = n_nationkey and n_name = 'PERU' order by s_name;","SELECT t0.s_name, t0.s_address FROM (SELECT * FROM supplier, (SELECT * FROM nation WHERE n_name = 'PERU') AS t WHERE supplier.s_nationkey = t.n_nationkey) AS t0, (SELECT t4.ps_suppkey FROM (SELECT * FROM partsupp, (SELECT p_partkey FROM part WHERE p_name LIKE 'floral%' GROUP BY p_partkey) AS t3 WHERE partsupp.ps_partkey = t3.p_partkey) AS t4, (SELECT l_partkey, l_suppkey, SUM(l_quantity) AS f2 FROM lineitem WHERE l_shipdate >= DATE '1997-01-01' AND l_shipdate < (DATE '1997-01-01' + INTERVAL '1' YEAR) GROUP BY l_partkey, l_suppkey) AS t7 WHERE t4.ps_partkey = t7.l_partkey AND t4.ps_suppkey = t7.l_suppkey AND t4.ps_availqty > 0.5 * t7.f2 GROUP BY t4.ps_suppkey) AS t11 WHERE t0.s_suppkey = t11.ps_suppkey ORDER BY t0.s_name","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_REDUCE_EXPRESSIONS']","[""select o_year, sum(case when nation = 'UNITED STATES' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD BURNISHED COPPER' ) as all_nations group by o_year order by o_year;""]","[""['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_TO_CALC', 'FILTER_INTO_JOIN']""]"
117,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'UNITED STATES' group by s_name order by numwait desc, s_name;","SELECT t5.s_name, COUNT(*) AS numwait FROM (SELECT * FROM (SELECT supplier.s_suppkey, supplier.s_name, supplier.s_address, supplier.s_nationkey, supplier.s_phone, supplier.s_acctbal, supplier.s_comment, lineitem.l_orderkey, lineitem.l_partkey, lineitem.l_suppkey, lineitem.l_linenumber, lineitem.l_quantity, lineitem.l_extendedprice, lineitem.l_discount, lineitem.l_tax, lineitem.l_returnflag, lineitem.l_linestatus, lineitem.l_shipdate, lineitem.l_commitdate, lineitem.l_receiptdate, lineitem.l_shipinstruct, lineitem.l_shipmode, lineitem.l_comment, orders.o_orderkey, orders.o_custkey, orders.o_orderstatus, orders.o_totalprice, orders.o_orderdate, orders.o_orderpriority, orders.o_clerk, orders.o_shippriority, orders.o_comment, nation.n_nationkey, nation.n_name, nation.n_regionkey, nation.n_comment, t3.f2 AS f0 FROM supplier CROSS JOIN lineitem CROSS JOIN orders CROSS JOIN nation LEFT JOIN (SELECT t0.l_orderkey AS l_orderkey0, t0.l_suppkey AS l_suppkey0, MIN(TRUE) AS f2 FROM lineitem AS lineitem0, (SELECT lineitem1.l_orderkey, lineitem1.l_suppkey FROM supplier AS supplier0, lineitem AS lineitem1, orders AS orders0, nation AS nation0 GROUP BY lineitem1.l_orderkey, lineitem1.l_suppkey) AS t0 WHERE lineitem0.l_orderkey = t0.l_orderkey AND lineitem0.l_suppkey <> t0.l_suppkey GROUP BY t0.l_orderkey, t0.l_suppkey) AS t3 ON lineitem.l_orderkey = t3.l_orderkey0 AND lineitem.l_suppkey = t3.l_suppkey0) AS t4 WHERE t4.s_suppkey = t4.l_suppkey AND (t4.o_orderkey = t4.l_orderkey AND t4.o_orderstatus = 'F') AND (t4.l_receiptdate > t4.l_commitdate AND t4.s_nationkey = t4.n_nationkey AND (t4.n_name = 'UNITED STATES' AND t4.f0 IS NOT NULL))) AS t5 LEFT JOIN (SELECT t15.l_orderkey AS l_orderkey0, t15.l_suppkey AS l_suppkey0, MIN(TRUE) AS f2 FROM (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t6, (SELECT l_orderkey, l_suppkey FROM (SELECT supplier1.s_suppkey, supplier1.s_name, supplier1.s_address, supplier1.s_nationkey, supplier1.s_phone, supplier1.s_acctbal, supplier1.s_comment, lineitem3.l_orderkey, lineitem3.l_partkey, lineitem3.l_suppkey, lineitem3.l_linenumber, lineitem3.l_quantity, lineitem3.l_extendedprice, lineitem3.l_discount, lineitem3.l_tax, lineitem3.l_returnflag, lineitem3.l_linestatus, lineitem3.l_shipdate, lineitem3.l_commitdate, lineitem3.l_receiptdate, lineitem3.l_shipinstruct, lineitem3.l_shipmode, lineitem3.l_comment, orders1.o_orderkey, orders1.o_custkey, orders1.o_orderstatus, orders1.o_totalprice, orders1.o_orderdate, orders1.o_orderpriority, orders1.o_clerk, orders1.o_shippriority, orders1.o_comment, nation1.n_nationkey, nation1.n_name, nation1.n_regionkey, nation1.n_comment, t11.f2 AS f0 FROM supplier AS supplier1 CROSS JOIN lineitem AS lineitem3 CROSS JOIN orders AS orders1 CROSS JOIN nation AS nation1 LEFT JOIN (SELECT t8.l_orderkey AS l_orderkey0, t8.l_suppkey AS l_suppkey0, MIN(TRUE) AS f2 FROM lineitem AS lineitem4, (SELECT lineitem5.l_orderkey, lineitem5.l_suppkey FROM supplier AS supplier2, lineitem AS lineitem5, orders AS orders2, nation AS nation2 GROUP BY lineitem5.l_orderkey, lineitem5.l_suppkey) AS t8 WHERE lineitem4.l_orderkey = t8.l_orderkey AND lineitem4.l_suppkey <> t8.l_suppkey GROUP BY t8.l_orderkey, t8.l_suppkey) AS t11 ON lineitem3.l_orderkey = t11.l_orderkey0 AND lineitem3.l_suppkey = t11.l_suppkey0) AS t12 WHERE t12.s_suppkey = t12.l_suppkey AND (t12.o_orderkey = t12.l_orderkey AND t12.o_orderstatus = 'F') AND (t12.l_receiptdate > t12.l_commitdate AND t12.s_nationkey = t12.n_nationkey AND (t12.n_name = 'UNITED STATES' AND t12.f0 IS NOT NULL)) GROUP BY l_orderkey, l_suppkey) AS t15 WHERE t6.l_orderkey = t15.l_orderkey AND t6.l_suppkey <> t15.l_suppkey GROUP BY t15.l_orderkey, t15.l_suppkey) AS t18 ON t5.l_orderkey = t18.l_orderkey0 AND t5.l_suppkey = t18.l_suppkey0 WHERE t18.f2 IS NULL GROUP BY t5.s_name ORDER BY COUNT(*) DESC, t5.s_name","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_MERGE', 'FILTER_REDUCE_EXPRESSIONS']","[""select o_year, sum(case when nation = 'UNITED KINGDOM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM BRUSHED TIN' ) as all_nations group by o_year order by o_year;""]","[""['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_TO_CALC', 'FILTER_INTO_JOIN']""]"
118,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('37', '40', '39', '44', '36', '21', '20') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('37', '40', '39', '44', '36', '21', '20') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('37', '40', '39', '44', '36', '21', '20') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('37', '40', '39', '44', '36', '21', '20') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode",[],"[""select o_year, sum(case when nation = 'VIETNAM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO ANODIZED COPPER' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
119,tpch,"select l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order from lineitem where l_shipdate <= date '1998-12-01' - interval '67' day (3) group by l_returnflag, l_linestatus order by l_returnflag, l_linestatus;","SELECT l_returnflag, l_linestatus, SUM(l_quantity) AS sum_qty, SUM(l_extendedprice) AS sum_base_price, SUM(l_extendedprice * (1 - l_discount)) AS sum_disc_price, SUM(l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS sum_charge, AVG(l_quantity) AS avg_qty, AVG(l_extendedprice) AS avg_price, AVG(l_discount) AS avg_disc, COUNT(*) AS count_order FROM lineitem WHERE l_shipdate <= (DATE '1998-12-01' - INTERVAL '67' DAY(3)) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus","['FILTER_AGGREGATE_TRANSPOSE', 'FILTER_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#45' and p_type not like 'MEDIUM BRUSHED%' and p_size in (34, 4, 23, 19, 20, 16, 26, 48) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_INTO_JOIN', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'JOIN_CONDITION_PUSH', 'PROJECT_REMOVE']""]"
120,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 23 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t5.s_acctbal, t5.s_name, t5.n_name, t5.p_partkey, t5.p_mfgr, t5.s_address, t5.s_phone, t5.s_comment FROM (SELECT t.p_partkey, t.p_name, t.p_mfgr, t.p_brand, t.p_type, t.p_size, t.p_container, t.p_retailprice, t.p_comment, supplier.s_suppkey, supplier.s_name, supplier.s_address, supplier.s_nationkey, supplier.s_phone, supplier.s_acctbal, supplier.s_comment, partsupp.ps_partkey, partsupp.ps_suppkey, partsupp.ps_availqty, partsupp.ps_supplycost, partsupp.ps_comment, nation.n_nationkey, nation.n_name, nation.n_regionkey, nation.n_comment, t0.r_regionkey, t0.r_name, t0.r_comment, CAST(t3.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t3.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 23 AND p_type LIKE '%STEEL') AS t CROSS JOIN supplier INNER JOIN partsupp ON t.p_partkey = partsupp.ps_partkey AND supplier.s_suppkey = partsupp.ps_suppkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'ASIA') AS t0 ON nation.n_regionkey = t0.r_regionkey INNER JOIN (SELECT partsupp0.ps_partkey, MIN(partsupp0.ps_supplycost) AS EXPR0 FROM partsupp AS partsupp0 INNER JOIN supplier AS supplier0 ON partsupp0.ps_suppkey = supplier0.s_suppkey INNER JOIN nation AS nation0 ON supplier0.s_nationkey = nation0.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'ASIA') AS t1 ON nation0.n_regionkey = t1.r_regionkey GROUP BY partsupp0.ps_partkey) AS t3 ON t.p_partkey = t3.ps_partkey AND partsupp.ps_supplycost = t3.EXPR0 ORDER BY supplier.s_acctbal DESC, nation.n_name, supplier.s_name, t.p_partkey) AS t5","['FILTER_SCAN', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_MERGE', 'AGGREGATE_VALUES', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'PROJECT_REDUCE_EXPRESSIONS', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#43' and p_type not like 'SMALL BURNISHED%' and p_size in (38, 33, 39, 42, 7, 9, 25, 30) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_SCAN', 'FILTER_INTO_JOIN', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE', 'JOIN_CONDITION_PUSH', 'FILTER_MERGE', 'JOIN_EXTRACT_FILTER', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE']""]"
121,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'MACHINERY' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-16' and l_shipdate > date '1995-03-16' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'MACHINERY' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-16' and l_shipdate > date '1995-03-16' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate",[],"[""select o_year, sum(case when nation = 'SAUDI ARABIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD POLISHED BRASS' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
122,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1995-06-01' and o_orderdate < date '1995-06-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1995-06-01' and o_orderdate < date '1995-06-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 21 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
123,tpch,select sum(l_extendedprice * l_discount) as revenue from lineitem where l_shipdate >= date '1994-01-01' and l_shipdate < date '1994-01-01' + interval '1' year and l_discount between 0.02 - 0.01 and 0.02 + 0.01 and l_quantity < 24;,SELECT SUM(l_extendedprice * l_discount) AS revenue FROM lineitem WHERE l_shipdate >= DATE '1994-01-01' AND l_shipdate < (DATE '1994-01-01' + INTERVAL '1' YEAR) AND l_discount >= 0.02 - 0.01 AND l_discount <= 0.02 + 0.01 AND l_quantity < 24,"['FILTER_REDUCE_EXPRESSIONS', 'AGGREGATE_ANY_PULL_UP_CONSTANTS']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#41' and p_type not like 'LARGE ANODIZED%' and p_size in (2, 32, 3, 20, 31, 47, 8, 42) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'SORT_JOIN_TRANSPOSE']""]"
124,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'ARGENTINA' and n2.n_name = 'EGYPT') or (n1.n_name = 'EGYPT' and n2.n_name = 'ARGENTINA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation.n_name AS supp_nation, nation0.n_name AS cust_nation, EXTRACT(YEAR FROM t.l_shipdate) AS l_year, SUM(t.l_extendedprice * (1 - t.l_discount)) AS revenue FROM supplier INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t ON supplier.s_suppkey = t.l_suppkey INNER JOIN orders ON t.l_orderkey = orders.o_orderkey INNER JOIN customer ON orders.o_custkey = customer.c_custkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey INNER JOIN nation AS nation0 ON customer.c_nationkey = nation0.n_nationkey AND (nation.n_name = 'ARGENTINA' AND nation0.n_name = 'EGYPT' OR nation.n_name = 'EGYPT' AND nation0.n_name = 'ARGENTINA') GROUP BY nation.n_name, nation0.n_name, EXTRACT(YEAR FROM t.l_shipdate) ORDER BY nation.n_name, nation0.n_name, EXTRACT(YEAR FROM t.l_shipdate)","['SORT_REMOVE', 'FILTER_INTO_JOIN', 'FILTER_SCAN', 'JOIN_CONDITION_PUSH', 'FILTER_PROJECT_TRANSPOSE', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'PROJECT_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE']","[""select o_year, sum(case when nation = 'FRANCE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE ANODIZED BRASS' ) as all_nations group by o_year order by o_year;""]","[""['SORT_REMOVE', 'FILTER_INTO_JOIN', 'FILTER_SCAN', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'JOIN_CONDITION_PUSH', 'FILTER_PROJECT_TRANSPOSE', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'PROJECT_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE']""]"
125,tpch,"select o_year, sum(case when nation = 'EGYPT' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD PLATED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM orders.o_orderdate) AS o_year, SUM(CASE WHEN nation0.n_name = 'EGYPT' THEN lineitem.l_extendedprice * (1 - lineitem.l_discount) ELSE 0 END) / SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS mkt_share FROM part, supplier, lineitem, orders, customer, nation, nation AS nation0, region WHERE part.p_partkey = lineitem.l_partkey AND supplier.s_suppkey = lineitem.l_suppkey AND (lineitem.l_orderkey = orders.o_orderkey AND (orders.o_custkey = customer.c_custkey AND customer.c_nationkey = nation.n_nationkey)) AND (nation.n_regionkey = region.r_regionkey AND region.r_name = 'MIDDLE EAST' AND (supplier.s_nationkey = nation0.n_nationkey AND (orders.o_orderdate >= DATE '1995-01-01' AND orders.o_orderdate <= DATE '1996-12-31' AND part.p_type = 'STANDARD PLATED BRASS'))) GROUP BY EXTRACT(YEAR FROM orders.o_orderdate) ORDER BY EXTRACT(YEAR FROM orders.o_orderdate)","['FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_SCAN', 'FILTER_CORRELATE', 'FILTER_MERGE', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_PROJECT_TRANSPOSE', 'JOIN_CONDITION_PUSH', 'JOIN_PROJECT_RIGHT_TRANSPOSE', 'JOIN_RIGHT_UNION_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_ANY_PULL_UP_CONSTANTS']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#53' and p_type not like 'STANDARD BRUSHED%' and p_size in (12, 21, 35, 40, 17, 44, 25, 43) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_SCAN', 'FILTER_CORRELATE', 'FILTER_MERGE', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_PROJECT_TRANSPOSE', 'JOIN_CONDITION_PUSH', 'JOIN_PROJECT_RIGHT_TRANSPOSE', 'JOIN_RIGHT_UNION_TRANSPOSE', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'SORT_UNION_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS', 'PROJECT_REMOVE', 'UNION_MERGE', 'UNION_REMOVE', 'UNION_TO_DISTINCT', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_ANY_PULL_UP_CONSTANTS']""]"
126,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%blanched%' ) as profit group by nation, o_year order by nation, o_year desc;","select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%blanched%' ) as profit group by nation, o_year order by nation, o_year desc",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 39 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
127,tpch,"select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from customer, orders, lineitem, nation where c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate >= date '1995-01-01' and o_orderdate < date '1995-01-01' + interval '3' month and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc;","SELECT customer.c_custkey, customer.c_name, SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS revenue, customer.c_acctbal, nation.n_name, customer.c_address, customer.c_phone, customer.c_comment FROM customer, orders, lineitem, nation WHERE customer.c_custkey = orders.o_custkey AND (lineitem.l_orderkey = orders.o_orderkey AND orders.o_orderdate >= DATE '1995-01-01') AND (orders.o_orderdate < (DATE '1995-01-01' + INTERVAL '3' MONTH) AND (lineitem.l_returnflag = 'R' AND customer.c_nationkey = nation.n_nationkey)) GROUP BY customer.c_custkey, customer.c_name, customer.c_acctbal, customer.c_phone, nation.n_name, customer.c_address, customer.c_comment ORDER BY SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) DESC","['AGGREGATE_PROJECT_MERGE', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'FILTER_PROJECT_TRANSPOSE', 'JOIN_CONDITION_PUSH', 'FILTER_MERGE']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#44' and p_type not like 'MEDIUM PLATED%' and p_size in (18, 34, 14, 48, 23, 5, 9, 39) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'FILTER_PROJECT_TRANSPOSE', 'AGGREGATE_ANY_PULL_UP_CONSTANTS', 'JOIN_CONDITION_PUSH', 'FILTER_MERGE']""]"
128,tpch,"select ps_partkey, sum(ps_supplycost * ps_availqty) as value from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'IRAN' group by ps_partkey having sum(ps_supplycost * ps_availqty) > ( select sum(ps_supplycost * ps_availqty) * 0.0001000000 from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'IRAN' ) order by value desc;","select ps_partkey, sum(ps_supplycost * ps_availqty) as value from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'IRAN' group by ps_partkey having sum(ps_supplycost * ps_availqty) > ( select sum(ps_supplycost * ps_availqty) * 0.0001000000 from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'IRAN' ) order by value desc",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('33', '22', '30', '23', '26', '37', '20') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('33', '22', '30', '23', '26', '37', '20') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
129,tpch,"select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('TRUCK', 'RAIL') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1995-01-01' and l_receiptdate < date '1995-01-01' + interval '1' year group by l_shipmode order by l_shipmode;","select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('TRUCK', 'RAIL') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1995-01-01' and l_receiptdate < date '1995-01-01' + interval '1' year group by l_shipmode order by l_shipmode",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 27 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
130,tpch,"select c_count, count(*) as custdist from ( select c_custkey, count(o_orderkey) from customer left outer join orders on c_custkey = o_custkey and o_comment not like '%unusual%requests%' group by c_custkey ) as c_orders (c_custkey, c_count) group by c_count order by custdist desc, c_count desc;","SELECT t0.EXPR1, COUNT(*) AS custdist FROM (SELECT customer.c_custkey, COUNT(t.o_orderkey) AS EXPR1 FROM customer LEFT JOIN (SELECT * FROM orders WHERE o_comment NOT LIKE '%unusual%requests%') AS t ON customer.c_custkey = t.o_custkey GROUP BY customer.c_custkey) AS t0 GROUP BY t0.EXPR1 ORDER BY COUNT(*) DESC, t0.EXPR1 DESC","['FILTER_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH', 'AGGREGATE_PROJECT_MERGE']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#34' and p_type not like 'SMALL POLISHED%' and p_size in (4, 3, 47, 13, 5, 2, 41, 39) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_REDUCE_EXPRESSIONS', 'FILTER_INTO_JOIN', 'PROJECT_REDUCE_EXPRESSIONS', 'AGGREGATE_REMOVE', 'SORT_REMOVE', 'AGGREGATE_PROJECT_MERGE']""]"
131,tpch,"select 100.00 * sum(case when p_type like 'PROMO%' then l_extendedprice * (1 - l_discount) else 0 end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from lineitem, part where l_partkey = p_partkey and l_shipdate >= date '1994-07-01' and l_shipdate < date '1994-07-01' + interval '1' month;",SELECT 100.00 * SUM(CASE WHEN part.p_type LIKE 'PROMO%' THEN t.l_extendedprice * (1 - t.l_discount) ELSE 0 END) / SUM(t.l_extendedprice * (1 - t.l_discount)) AS promo_revenue FROM (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1994-07-01' AND l_shipdate < (DATE '1994-07-01' + INTERVAL '1' MONTH)) AS t INNER JOIN part ON t.l_partkey = part.p_partkey,"['FILTER_INTO_JOIN', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_REMOVE']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#14' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 8 and l_quantity <= 8 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#53' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 11 and l_quantity <= 11 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#51' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 24 and l_quantity <= 24 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_INTO_JOIN', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_REMOVE']""]"
132,tpch,"select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#42' and p_type not like 'PROMO POLISHED%' and p_size in (20, 18, 25, 33, 41, 9, 38, 10) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;","SELECT t6.p_brand, t6.p_type, t6.p_size, COUNT(t6.ps_suppkey) AS supplier_cnt FROM (SELECT t0.p_brand, t0.p_type, t0.p_size, t0.ps_suppkey FROM (SELECT * FROM (SELECT partsupp.ps_partkey, partsupp.ps_suppkey, partsupp.ps_availqty, partsupp.ps_supplycost, partsupp.ps_comment, part.p_partkey, part.p_name, part.p_mfgr, part.p_brand, part.p_type, part.p_size, part.p_container, part.p_retailprice, part.p_comment, partsupp.ps_suppkey AS ps_suppkey0 FROM partsupp, part) AS t WHERE t.p_partkey = t.ps_partkey AND CAST(t.p_brand AS CHAR(8)) <> 'Brand#42' AND t.p_size IN (9, 10, 18, 20, 25, 33, 38, 41) AND t.p_type NOT LIKE 'PROMO POLISHED%') AS t0 LEFT JOIN (SELECT s_suppkey, MIN(TRUE) AS f1 FROM supplier WHERE s_comment LIKE '%Customer%Complaints%' GROUP BY s_suppkey) AS t3 ON t0.ps_suppkey0 = t3.s_suppkey WHERE t3.f1 IS NOT TRUE GROUP BY t0.p_brand, t0.p_type, t0.p_size, t0.ps_suppkey) AS t6 GROUP BY t6.p_brand, t6.p_type, t6.p_size ORDER BY COUNT(t6.ps_suppkey) DESC, t6.p_brand, t6.p_type, t6.p_size","['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'SORT_JOIN_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#33' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 5 and l_quantity <= 5 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#52' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 18 and l_quantity <= 18 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#12' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 27 and l_quantity <= 27 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_REMOVE']""]"
133,tpch,"select sum(l_extendedprice) / 7.0 as avg_yearly from lineitem, part where p_partkey = l_partkey and p_brand = 'Brand#25' and p_container = 'LG DRUM' and l_quantity < ( select 0.2 * avg(l_quantity) from lineitem where l_partkey = p_partkey );","select sum(l_extendedprice) / 7.0 as avg_yearly from lineitem, part where p_partkey = l_partkey and p_brand = 'Brand#25' and p_container = 'LG DRUM' and l_quantity < ( select 0.2 * avg(l_quantity) from lineitem where l_partkey = p_partkey )",[],"[""select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'ARGENTINA' and n2.n_name = 'FRANCE') or (n1.n_name = 'FRANCE' and n2.n_name = 'ARGENTINA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;""]","[""['Empty List']""]"
134,tpch,"select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#22' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 8 and l_quantity <= 8 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#34' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 10 and l_quantity <= 10 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#41' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 24 and l_quantity <= 24 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );","SELECT SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS revenue FROM lineitem, part WHERE part.p_partkey = lineitem.l_partkey AND part.p_brand = 'Brand#22' AND (part.p_container IN ('SM BOX', 'SM CASE', 'SM PACK', 'SM PKG') AND lineitem.l_quantity >= 8) AND (lineitem.l_quantity <= 8 + 10 AND (part.p_size >= 1 AND part.p_size <= 5) AND (lineitem.l_shipmode IN ('AIR', 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON')) OR part.p_partkey = lineitem.l_partkey AND part.p_brand = 'Brand#34' AND (part.p_container IN ('MED BAG', 'MED BOX', 'MED PACK', 'MED PKG') AND lineitem.l_quantity >= 10) AND (lineitem.l_quantity <= 10 + 10 AND (part.p_size >= 1 AND part.p_size <= 10) AND (lineitem.l_shipmode IN ('AIR', 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON')) OR part.p_partkey = lineitem.l_partkey AND part.p_brand = 'Brand#41' AND (part.p_container IN ('LG BOX', 'LG CASE', 'LG PACK', 'LG PKG') AND lineitem.l_quantity >= 24) AND (lineitem.l_quantity <= 24 + 10 AND (part.p_size >= 1 AND part.p_size <= 15) AND (lineitem.l_shipmode IN ('AIR', 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_MERGE', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_REDUCE_EXPRESSIONS']","[""select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'BUILDING' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-14' and l_shipdate > date '1995-03-14' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;""]","[""['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'PROJECT_TO_CALC', 'JOIN_EXTRACT_FILTER']""]"
135,tpch,"select s_name, s_address from supplier, nation where s_suppkey in ( select ps_suppkey from partsupp where ps_partkey in ( select p_partkey from part where p_name like 'gainsboro%' ) and ps_availqty > ( select 0.5 * sum(l_quantity) from lineitem where l_partkey = ps_partkey and l_suppkey = ps_suppkey and l_shipdate >= date '1995-01-01' and l_shipdate < date '1995-01-01' + interval '1' year ) ) and s_nationkey = n_nationkey and n_name = 'MOROCCO' order by s_name;","SELECT supplier.s_name, supplier.s_address FROM supplier INNER JOIN (SELECT * FROM nation WHERE n_name = 'MOROCCO') AS t ON supplier.s_nationkey = t.n_nationkey INNER JOIN (SELECT partsupp.ps_suppkey FROM partsupp INNER JOIN (SELECT p_partkey FROM part WHERE p_name LIKE 'gainsboro%' GROUP BY p_partkey) AS t2 ON partsupp.ps_partkey = t2.p_partkey INNER JOIN (SELECT l_partkey, l_suppkey, SUM(l_quantity) AS f2 FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate < (DATE '1995-01-01' + INTERVAL '1' YEAR) GROUP BY l_partkey, l_suppkey) AS t5 ON partsupp.ps_partkey = t5.l_partkey AND partsupp.ps_suppkey = t5.l_suppkey AND partsupp.ps_availqty > 0.5 * t5.f2 GROUP BY partsupp.ps_suppkey) AS t8 ON supplier.s_suppkey = t8.ps_suppkey ORDER BY supplier.s_name","['FILTER_INTO_JOIN', 'FILTER_REDUCE_EXPRESSIONS']","[""select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'ETHIOPIA' and n2.n_name = 'FRANCE') or (n1.n_name = 'FRANCE' and n2.n_name = 'ETHIOPIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;""]","[""['FILTER_INTO_JOIN']""]"
136,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'IRAQ' group by s_name order by numwait desc, s_name;","SELECT t4.s_name, COUNT(*) AS numwait FROM (SELECT * FROM (SELECT supplier.s_suppkey, supplier.s_name, supplier.s_address, supplier.s_nationkey, supplier.s_phone, supplier.s_acctbal, supplier.s_comment, lineitem.l_orderkey, lineitem.l_partkey, lineitem.l_suppkey, lineitem.l_linenumber, lineitem.l_quantity, lineitem.l_extendedprice, lineitem.l_discount, lineitem.l_tax, lineitem.l_returnflag, lineitem.l_linestatus, lineitem.l_shipdate, lineitem.l_commitdate, lineitem.l_receiptdate, lineitem.l_shipinstruct, lineitem.l_shipmode, lineitem.l_comment, orders.o_orderkey, orders.o_custkey, orders.o_orderstatus, orders.o_totalprice, orders.o_orderdate, orders.o_orderpriority, orders.o_clerk, orders.o_shippriority, orders.o_comment, nation.n_nationkey, nation.n_name, nation.n_regionkey, nation.n_comment, t2.f2 AS f0 FROM supplier CROSS JOIN lineitem CROSS JOIN orders CROSS JOIN nation LEFT JOIN (SELECT t.l_orderkey AS l_orderkey0, t.l_suppkey AS l_suppkey0, MIN(TRUE) AS f2 FROM lineitem AS lineitem0, (SELECT lineitem1.l_orderkey, lineitem1.l_suppkey FROM supplier AS supplier0, lineitem AS lineitem1, orders AS orders0, nation AS nation0 GROUP BY lineitem1.l_orderkey, lineitem1.l_suppkey) AS t WHERE lineitem0.l_orderkey = t.l_orderkey AND lineitem0.l_suppkey <> t.l_suppkey GROUP BY t.l_orderkey, t.l_suppkey) AS t2 ON lineitem.l_orderkey = t2.l_orderkey0 AND lineitem.l_suppkey = t2.l_suppkey0) AS t3 WHERE t3.s_suppkey = t3.l_suppkey AND (t3.o_orderkey = t3.l_orderkey AND t3.o_orderstatus = 'F') AND (t3.l_receiptdate > t3.l_commitdate AND t3.s_nationkey = t3.n_nationkey AND (t3.n_name = 'IRAQ' AND t3.f0 IS NOT NULL))) AS t4 LEFT JOIN (SELECT t12.l_orderkey AS l_orderkey0, t12.l_suppkey AS l_suppkey0, MIN(TRUE) AS f2 FROM (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t5, (SELECT l_orderkey, l_suppkey FROM (SELECT supplier1.s_suppkey, supplier1.s_name, supplier1.s_address, supplier1.s_nationkey, supplier1.s_phone, supplier1.s_acctbal, supplier1.s_comment, lineitem3.l_orderkey, lineitem3.l_partkey, lineitem3.l_suppkey, lineitem3.l_linenumber, lineitem3.l_quantity, lineitem3.l_extendedprice, lineitem3.l_discount, lineitem3.l_tax, lineitem3.l_returnflag, lineitem3.l_linestatus, lineitem3.l_shipdate, lineitem3.l_commitdate, lineitem3.l_receiptdate, lineitem3.l_shipinstruct, lineitem3.l_shipmode, lineitem3.l_comment, orders1.o_orderkey, orders1.o_custkey, orders1.o_orderstatus, orders1.o_totalprice, orders1.o_orderdate, orders1.o_orderpriority, orders1.o_clerk, orders1.o_shippriority, orders1.o_comment, nation1.n_nationkey, nation1.n_name, nation1.n_regionkey, nation1.n_comment, t9.f2 AS f0 FROM supplier AS supplier1 CROSS JOIN lineitem AS lineitem3 CROSS JOIN orders AS orders1 CROSS JOIN nation AS nation1 LEFT JOIN (SELECT t6.l_orderkey AS l_orderkey0, t6.l_suppkey AS l_suppkey0, MIN(TRUE) AS f2 FROM lineitem AS lineitem4, (SELECT lineitem5.l_orderkey, lineitem5.l_suppkey FROM supplier AS supplier2, lineitem AS lineitem5, orders AS orders2, nation AS nation2 GROUP BY lineitem5.l_orderkey, lineitem5.l_suppkey) AS t6 WHERE lineitem4.l_orderkey = t6.l_orderkey AND lineitem4.l_suppkey <> t6.l_suppkey GROUP BY t6.l_orderkey, t6.l_suppkey) AS t9 ON lineitem3.l_orderkey = t9.l_orderkey0 AND lineitem3.l_suppkey = t9.l_suppkey0) AS t10 WHERE t10.s_suppkey = t10.l_suppkey AND (t10.o_orderkey = t10.l_orderkey AND t10.o_orderstatus = 'F') AND (t10.l_receiptdate > t10.l_commitdate AND t10.s_nationkey = t10.n_nationkey AND (t10.n_name = 'IRAQ' AND t10.f0 IS NOT NULL)) GROUP BY l_orderkey, l_suppkey) AS t12 WHERE t5.l_orderkey = t12.l_orderkey AND t5.l_suppkey <> t12.l_suppkey GROUP BY t12.l_orderkey, t12.l_suppkey) AS t15 ON t4.l_orderkey = t15.l_orderkey0 AND t4.l_suppkey = t15.l_suppkey0 WHERE t15.f2 IS NULL GROUP BY t4.s_name ORDER BY COUNT(*) DESC, t4.s_name","['FILTER_INTO_JOIN', 'FILTER_MULTI_JOIN_MERGE', 'JOIN_EXTRACT_FILTER', 'JOIN_CONDITION_PUSH', 'JOIN_LEFT_UNION_TRANSPOSE', 'JOIN_RIGHT_UNION_TRANSPOSE', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_ANY_PULL_UP_CONSTANTS', 'AGGREGATE_REMOVE']","[""select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('SHIP', 'REG AIR') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1993-01-01' and l_receiptdate < date '1993-01-01' + interval '1' year group by l_shipmode order by l_shipmode;""]","[""['FILTER_INTO_JOIN', 'FILTER_MULTI_JOIN_MERGE', 'PROJECT_REDUCE_EXPRESSIONS', 'JOIN_EXTRACT_FILTER', 'JOIN_CONDITION_PUSH', 'JOIN_LEFT_UNION_TRANSPOSE', 'JOIN_RIGHT_UNION_TRANSPOSE', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'AGGREGATE_ANY_PULL_UP_CONSTANTS', 'AGGREGATE_REMOVE']""]"
137,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('35', '39', '23', '38', '25', '33', '42') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('35', '39', '23', '38', '25', '33', '42') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('35', '39', '23', '38', '25', '33', '42') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('35', '39', '23', '38', '25', '33', '42') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 8 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
138,tpch,"select l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order from lineitem where l_shipdate <= date '1998-12-01' - interval '84' day (3) group by l_returnflag, l_linestatus order by l_returnflag, l_linestatus;","SELECT l_returnflag, l_linestatus, SUM(l_quantity) AS sum_qty, SUM(l_extendedprice) AS sum_base_price, SUM(l_extendedprice * (1 - l_discount)) AS sum_disc_price, SUM(l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS sum_charge, AVG(l_quantity) AS avg_qty, AVG(l_extendedprice) AS avg_price, AVG(l_discount) AS avg_disc, COUNT(*) AS count_order FROM lineitem WHERE l_shipdate <= (DATE '1998-12-01' - INTERVAL '84' DAY(3)) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus","['FILTER_SCAN', 'AGGREGATE_PROJECT_MERGE']","[""select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'CANADA' and n2.n_name = 'INDIA') or (n1.n_name = 'INDIA' and n2.n_name = 'CANADA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;""]","[""['FILTER_INTO_JOIN', 'FILTER_MERGE', 'AGGREGATE_PROJECT_MERGE']""]"
139,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 14 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 14 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 7 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
140,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'BUILDING' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-19' and l_shipdate > date '1995-03-19' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t1.l_orderkey, SUM(t1.l_extendedprice * (1 - t1.l_discount)) AS revenue, t0.o_orderdate, t0.o_shippriority FROM (SELECT * FROM customer WHERE c_mktsegment = 'BUILDING') AS t INNER JOIN (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-19') AS t0 ON t.c_custkey = t0.o_custkey INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-19') AS t1 ON t0.o_orderkey = t1.l_orderkey GROUP BY t1.l_orderkey, t0.o_orderdate, t0.o_shippriority ORDER BY SUM(t1.l_extendedprice * (1 - t1.l_discount)) DESC, t0.o_orderdate","['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'SORT_REMOVE_CONSTANT_KEYS']","[""select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('RAIL', 'SHIP') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1997-01-01' and l_receiptdate < date '1997-01-01' + interval '1' year group by l_shipmode order by l_shipmode;""]","[""['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'SORT_REMOVE_CONSTANT_KEYS']""]"
141,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1995-12-01' and o_orderdate < date '1995-12-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","SELECT t.o_orderpriority, COUNT(*) AS order_count FROM (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-12-01' AND o_orderdate < (DATE '1995-12-01' + INTERVAL '3' MONTH)) AS t INNER JOIN (SELECT l_orderkey, MIN(TRUE) AS f1 FROM lineitem WHERE l_commitdate < l_receiptdate GROUP BY l_orderkey) AS t2 ON t.o_orderkey = t2.l_orderkey GROUP BY t.o_orderpriority ORDER BY t.o_orderpriority","['FILTER_AGGREGATE_TRANSPOSE', 'FILTER_CORRELATE', 'JOIN_CONDITION_PUSH', 'SORT_JOIN_TRANSPOSE']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#54' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 6 and l_quantity <= 6 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#14' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 13 and l_quantity <= 13 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#14' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 30 and l_quantity <= 30 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'JOIN_RIGHT_INSTANCE', 'FILTER_INSTANCE', 'CALC_REMOVE', 'PROJECT_REMOVE', 'AGGREGATE_PROJECT_MERGE']""]"
142,tpch,"select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and o_orderdate >= date '1993-01-01' and o_orderdate < date '1993-01-01' + interval '1' year group by n_name order by revenue desc;","SELECT t3.n_name, SUM(t3.l_extendedprice * (1 - t3.l_discount)) AS revenue FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM customer, (SELECT * FROM orders WHERE o_orderdate >= DATE '1993-01-01' AND o_orderdate < (DATE '1993-01-01' + INTERVAL '1' YEAR)) AS t WHERE customer.c_custkey = t.o_custkey) AS t0, lineitem WHERE lineitem.l_orderkey = t0.o_orderkey) AS t1, supplier WHERE t1.l_suppkey = supplier.s_suppkey AND t1.c_nationkey = supplier.s_nationkey) AS t2, nation WHERE t2.s_nationkey = nation.n_nationkey) AS t3, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t4 WHERE t3.n_regionkey = t4.r_regionkey GROUP BY t3.n_name ORDER BY SUM(t3.l_extendedprice * (1 - t3.l_discount)) DESC","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_MERGE']","[""select o_year, sum(case when nation = 'BRAZIL' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO ANODIZED STEEL' ) as all_nations group by o_year order by o_year;""]","[""['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_TO_CALC', 'FILTER_INTO_JOIN']""]"
143,tpch,select sum(l_extendedprice * l_discount) as revenue from lineitem where l_shipdate >= date '1993-01-01' and l_shipdate < date '1993-01-01' + interval '1' year and l_discount between 0.02 - 0.01 and 0.02 + 0.01 and l_quantity < 24;,SELECT SUM(l_extendedprice * l_discount) AS revenue FROM lineitem WHERE l_shipdate >= DATE '1993-01-01' AND l_shipdate < (DATE '1993-01-01' + INTERVAL '1' YEAR) AND l_discount >= 0.02 - 0.01 AND l_discount <= 0.02 + 0.01 AND l_quantity < 24,['FILTER_REDUCE_EXPRESSIONS'],"[""select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'ROMANIA' and n2.n_name = 'RUSSIA') or (n1.n_name = 'RUSSIA' and n2.n_name = 'ROMANIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;""]","[""['FILTER_INTO_JOIN']""]"
144,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'ALGERIA' and n2.n_name = 'SAUDI ARABIA') or (n1.n_name = 'SAUDI ARABIA' and n2.n_name = 'ALGERIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'ALGERIA' and n2.n_name = 'SAUDI ARABIA') or (n1.n_name = 'SAUDI ARABIA' and n2.n_name = 'ALGERIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 28 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
145,tpch,"select o_year, sum(case when nation = 'ALGERIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY BRUSHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t0.o_orderdate) AS o_year, SUM(CASE WHEN nation0.n_name = 'ALGERIA' THEN lineitem.l_extendedprice * (1 - lineitem.l_discount) ELSE 0 END) / SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'ECONOMY BRUSHED TIN') AS t CROSS JOIN supplier INNER JOIN lineitem ON t.p_partkey = lineitem.l_partkey AND supplier.s_suppkey = lineitem.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t0 ON lineitem.l_orderkey = t0.o_orderkey INNER JOIN customer ON t0.o_custkey = customer.c_custkey INNER JOIN nation ON customer.c_nationkey = nation.n_nationkey INNER JOIN nation AS nation0 ON supplier.s_nationkey = nation0.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1 ON nation.n_regionkey = t1.r_regionkey GROUP BY EXTRACT(YEAR FROM t0.o_orderdate) ORDER BY EXTRACT(YEAR FROM t0.o_orderdate)","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'PROJECT_REDUCE_EXPRESSIONS', 'JOIN_PROJECT_BOTH_TRANSPOSE']","[""select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'FURNITURE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-24' and l_shipdate > date '1995-03-24' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;""]","[""['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'PROJECT_REDUCE_EXPRESSIONS', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'PROJECT_TO_CALC', 'JOIN_EXTRACT_FILTER']""]"
146,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%saddle%' ) as profit group by nation, o_year order by nation, o_year desc;","select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%saddle%' ) as profit group by nation, o_year order by nation, o_year desc",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 32 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
147,tpch,"select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('TRUCK', 'REG AIR') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1993-01-01' and l_receiptdate < date '1993-01-01' + interval '1' year group by l_shipmode order by l_shipmode;","select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('TRUCK', 'REG AIR') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1993-01-01' and l_receiptdate < date '1993-01-01' + interval '1' year group by l_shipmode order by l_shipmode",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('44', '39', '29', '31', '26', '22', '27') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('44', '39', '29', '31', '26', '22', '27') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
148,tpch,"select c_count, count(*) as custdist from ( select c_custkey, count(o_orderkey) from customer left outer join orders on c_custkey = o_custkey and o_comment not like '%special%packages%' group by c_custkey ) as c_orders (c_custkey, c_count) group by c_count order by custdist desc, c_count desc;","SELECT t.EXPR1, COUNT(*) AS custdist FROM (SELECT customer.c_custkey, COUNT(orders.o_orderkey) AS EXPR1 FROM customer LEFT JOIN orders ON customer.c_custkey = orders.o_custkey AND orders.o_comment NOT LIKE '%special%packages%' GROUP BY customer.c_custkey) AS t GROUP BY t.EXPR1 ORDER BY COUNT(*) DESC, t.EXPR1 DESC","['AGGREGATE_PROJECT_MERGE', 'FILTER_INTO_JOIN', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#11' and p_type not like 'SMALL BURNISHED%' and p_size in (21, 10, 30, 26, 27, 47, 8, 38) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'FILTER_INTO_JOIN', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_SET_OP_TRANSPOSE', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'JOIN_LEFT_UNION_TRANSPOSE', 'JOIN_RIGHT_UNION_TRANSPOSE', 'JOIN_REDUCE_EXPRESSIONS', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE']""]"
149,tpch,"select 100.00 * sum(case when p_type like 'PROMO%' then l_extendedprice * (1 - l_discount) else 0 end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from lineitem, part where l_partkey = p_partkey and l_shipdate >= date '1993-10-01' and l_shipdate < date '1993-10-01' + interval '1' month;",SELECT 100.00 * SUM(CASE WHEN part.p_type LIKE 'PROMO%' THEN t.l_extendedprice * (1 - t.l_discount) ELSE 0 END) / SUM(t.l_extendedprice * (1 - t.l_discount)) AS promo_revenue FROM (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1993-10-01' AND l_shipdate < (DATE '1993-10-01' + INTERVAL '1' MONTH)) AS t INNER JOIN part ON t.l_partkey = part.p_partkey,"['FILTER_INTO_JOIN', 'FILTER_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#35' and p_type not like 'MEDIUM BURNISHED%' and p_size in (49, 4, 24, 32, 20, 47, 43, 23) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'FILTER_AGGREGATE_TRANSPOSE', 'FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'PROJECT_SUB_QUERY_TO_CORRELATE', 'PROJECT_REDUCE_EXPRESSIONS', 'FILTER_REDUCE_EXPRESSIONS', 'SORT_REMOVE', 'UNION_TO_DISTINCT', 'SORT_PROJECT_TRANSPOSE', 'SORT_UNION_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS', 'JOIN_CONDITION_PUSH', 'AGGREGATE_PROJECT_MERGE']""]"
150,tpch,"select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#11' and p_type not like 'STANDARD BRUSHED%' and p_size in (11, 14, 5, 40, 41, 30, 32, 19) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;","SELECT t6.p_brand, t6.p_type, t6.p_size, COUNT(t6.ps_suppkey) AS supplier_cnt FROM (SELECT t0.p_brand, t0.p_type, t0.p_size, t0.ps_suppkey FROM (SELECT * FROM (SELECT partsupp.ps_partkey, partsupp.ps_suppkey, partsupp.ps_availqty, partsupp.ps_supplycost, partsupp.ps_comment, part.p_partkey, part.p_name, part.p_mfgr, part.p_brand, part.p_type, part.p_size, part.p_container, part.p_retailprice, part.p_comment, partsupp.ps_suppkey AS ps_suppkey0 FROM partsupp, part) AS t WHERE t.p_partkey = t.ps_partkey AND CAST(t.p_brand AS CHAR(8)) <> 'Brand#11' AND t.p_size IN (5, 11, 14, 19, 30, 32, 40, 41) AND t.p_type NOT LIKE 'STANDARD BRUSHED%') AS t0 LEFT JOIN (SELECT s_suppkey, MIN(TRUE) AS f1 FROM supplier WHERE s_comment LIKE '%Customer%Complaints%' GROUP BY s_suppkey) AS t3 ON t0.ps_suppkey0 = t3.s_suppkey WHERE t3.f1 IS NOT TRUE GROUP BY t0.p_brand, t0.p_type, t0.p_size, t0.ps_suppkey) AS t6 GROUP BY t6.p_brand, t6.p_type, t6.p_size ORDER BY COUNT(t6.ps_suppkey) DESC, t6.p_brand, t6.p_type, t6.p_size","['FILTER_INTO_JOIN', 'FILTER_MULTI_JOIN_MERGE', 'JOIN_EXTRACT_FILTER', 'JOIN_CONDITION_PUSH', 'JOIN_LEFT_UNION_TRANSPOSE', 'JOIN_RIGHT_UNION_TRANSPOSE', 'FILTER_SET_OP_TRANSPOSE', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'AGGREGATE_ANY_PULL_UP_CONSTANTS', 'AGGREGATE_VALUES', 'AGGREGATE_UNION_AGGREGATE', 'AGGREGATE_UNION_TRANSPOSE', 'AGGREGATE_REMOVE']","[""select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('AIR', 'SHIP') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1993-01-01' and l_receiptdate < date '1993-01-01' + interval '1' year group by l_shipmode order by l_shipmode;""]","[""['FILTER_INTO_JOIN', 'FILTER_MULTI_JOIN_MERGE', 'PROJECT_REDUCE_EXPRESSIONS', 'JOIN_EXTRACT_FILTER', 'JOIN_CONDITION_PUSH', 'JOIN_LEFT_UNION_TRANSPOSE', 'JOIN_RIGHT_UNION_TRANSPOSE', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'AGGREGATE_ANY_PULL_UP_CONSTANTS', 'AGGREGATE_VALUES', 'AGGREGATE_UNION_AGGREGATE', 'AGGREGATE_UNION_TRANSPOSE', 'AGGREGATE_REMOVE']""]"
151,tpch,"select sum(l_extendedprice) / 7.0 as avg_yearly from lineitem, part where p_partkey = l_partkey and p_brand = 'Brand#11' and p_container = 'LG CASE' and l_quantity < ( select 0.2 * avg(l_quantity) from lineitem where l_partkey = p_partkey );","select sum(l_extendedprice) / 7.0 as avg_yearly from lineitem, part where p_partkey = l_partkey and p_brand = 'Brand#11' and p_container = 'LG CASE' and l_quantity < ( select 0.2 * avg(l_quantity) from lineitem where l_partkey = p_partkey )",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 41 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
152,tpch,"select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#22' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 6 and l_quantity <= 6 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#14' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 13 and l_quantity <= 13 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#43' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 30 and l_quantity <= 30 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );",SELECT SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS revenue FROM lineitem INNER JOIN part ON lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#22' AND ((part.p_container = 'SM CASE' OR part.p_container = 'SM BOX' OR part.p_container = 'SM PACK' OR part.p_container = 'SM PKG') AND lineitem.l_quantity >= 6) AND (lineitem.l_quantity <= 6 + 10 AND part.p_size >= 1 AND (part.p_size <= 5 AND ((lineitem.l_shipmode = 'AIR' OR lineitem.l_shipmode = 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))) OR lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#14' AND ((part.p_container = 'MED BAG' OR part.p_container = 'MED BOX' OR part.p_container = 'MED PKG' OR part.p_container = 'MED PACK') AND lineitem.l_quantity >= 13) AND (lineitem.l_quantity <= 13 + 10 AND part.p_size >= 1 AND (part.p_size <= 10 AND ((lineitem.l_shipmode = 'AIR' OR lineitem.l_shipmode = 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))) OR lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#43' AND ((part.p_container = 'LG CASE' OR part.p_container = 'LG BOX' OR part.p_container = 'LG PACK' OR part.p_container = 'LG PKG') AND lineitem.l_quantity >= 30) AND (lineitem.l_quantity <= 30 + 10 AND part.p_size >= 1 AND (part.p_size <= 15 AND ((lineitem.l_shipmode = 'AIR' OR lineitem.l_shipmode = 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))),"['FILTER_INTO_JOIN', 'FILTER_MERGE']","[""select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'IRAN' and n2.n_name = 'VIETNAM') or (n1.n_name = 'VIETNAM' and n2.n_name = 'IRAN') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;""]","[""['FILTER_INTO_JOIN']""]"
153,tpch,"select s_name, s_address from supplier, nation where s_suppkey in ( select ps_suppkey from partsupp where ps_partkey in ( select p_partkey from part where p_name like 'dim%' ) and ps_availqty > ( select 0.5 * sum(l_quantity) from lineitem where l_partkey = ps_partkey and l_suppkey = ps_suppkey and l_shipdate >= date '1993-01-01' and l_shipdate < date '1993-01-01' + interval '1' year ) ) and s_nationkey = n_nationkey and n_name = 'ROMANIA' order by s_name;","select s_name, s_address from supplier, nation where s_suppkey in ( select ps_suppkey from partsupp where ps_partkey in ( select p_partkey from part where p_name like 'dim%' ) and ps_availqty > ( select 0.5 * sum(l_quantity) from lineitem where l_partkey = ps_partkey and l_suppkey = ps_suppkey and l_shipdate >= date '1993-01-01' and l_shipdate < date '1993-01-01' + interval '1' year ) ) and s_nationkey = n_nationkey and n_name = 'ROMANIA' order by s_name",[],"[""select o_year, sum(case when nation = 'MOZAMBIQUE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM POLISHED STEEL' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
154,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'ARGENTINA' group by s_name order by numwait desc, s_name;","select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'ARGENTINA' group by s_name order by numwait desc, s_name",[],"[""select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'AUTOMOBILE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-18' and l_shipdate > date '1995-03-18' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;""]","[""['Empty List']""]"
155,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('39', '20', '34', '35', '29', '44', '30') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('39', '20', '34', '35', '29', '44', '30') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(t.c_phone) + 1) < 1 THEN CHAR_LENGTH(t.c_phone) + 1 ELSE 1 END FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '39' OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '20' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '34') OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '35' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '29' OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '44' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '30'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '39' OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '20' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '34') OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '35' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '29' OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '44' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '30')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, MIN(TRUE) AS f1 FROM orders GROUP BY o_custkey) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f1 IS NULL GROUP BY SUBSTR(t.c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(t.c_phone) + 1) < 1 THEN CHAR_LENGTH(t.c_phone) + 1 ELSE 1 END FOR 2) ORDER BY SUBSTR(t.c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(t.c_phone) + 1) < 1 THEN CHAR_LENGTH(t.c_phone) + 1 ELSE 1 END FOR 2)","['FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_PROJECT_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_ANY_PULL_UP_CONSTANTS', 'PROJECT_REDUCE_EXPRESSIONS']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#41' and p_type not like 'ECONOMY PLATED%' and p_size in (2, 19, 37, 28, 33, 16, 12, 25) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_SCAN', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_MERGE', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'FILTER_AGGREGATE_TRANSPOSE', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'AGGREGATE_PROJECT_MERGE', 'PROJECT_CORRELATE_TRANSPOSE', 'PROJECT_REDUCE_EXPRESSIONS', 'PROJECT_CALC_MERGE']""]"
156,tpch,"select l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order from lineitem where l_shipdate <= date '1998-12-01' - interval '96' day (3) group by l_returnflag, l_linestatus order by l_returnflag, l_linestatus;","select l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order from lineitem where l_shipdate <= date '1998-12-01' - interval '96' day (3) group by l_returnflag, l_linestatus order by l_returnflag, l_linestatus",[],"[""select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'HOUSEHOLD' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-18' and l_shipdate > date '1995-03-18' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;""]","[""['Empty List']""]"
157,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 8 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 8 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('36', '39', '43', '21', '27', '26', '30') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('36', '39', '43', '21', '27', '26', '30') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
158,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'FURNITURE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-19' and l_shipdate > date '1995-03-19' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t1.l_orderkey, SUM(t1.l_extendedprice * (1 - t1.l_discount)) AS revenue, t0.o_orderdate, t0.o_shippriority FROM (SELECT * FROM customer WHERE c_mktsegment = 'FURNITURE') AS t INNER JOIN (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-19') AS t0 ON t.c_custkey = t0.o_custkey INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-19') AS t1 ON t0.o_orderkey = t1.l_orderkey GROUP BY t1.l_orderkey, t0.o_orderdate, t0.o_shippriority ORDER BY SUM(t1.l_extendedprice * (1 - t1.l_discount)) DESC, t0.o_orderdate","['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE', 'SORT_PROJECT_TRANSPOSE']","[""select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'FURNITURE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-04' and l_shipdate > date '1995-03-04' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;""]","[""['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'PROJECT_TO_CALC', 'JOIN_EXTRACT_FILTER']""]"
159,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1996-01-01' and o_orderdate < date '1996-01-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1996-01-01' and o_orderdate < date '1996-01-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('43', '30', '21', '24', '39', '27', '35') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('43', '30', '21', '24', '39', '27', '35') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
160,tpch,"select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and o_orderdate >= date '1997-01-01' and o_orderdate < date '1997-01-01' + interval '1' year group by n_name order by revenue desc;","SELECT nation.n_name, SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS revenue FROM customer INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1997-01-01' AND o_orderdate < (DATE '1997-01-01' + INTERVAL '1' YEAR)) AS t ON customer.c_custkey = t.o_custkey INNER JOIN lineitem ON t.o_orderkey = lineitem.l_orderkey INNER JOIN supplier ON lineitem.l_suppkey = supplier.s_suppkey AND customer.c_nationkey = supplier.s_nationkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t0 ON nation.n_regionkey = t0.r_regionkey GROUP BY nation.n_name ORDER BY SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) DESC","['FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_MERGE', 'AGGREGATE_PROJECT_MERGE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'PROJECT_REDUCE_EXPRESSIONS', 'SORT_PROJECT_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#14' and p_type not like 'LARGE PLATED%' and p_size in (35, 25, 21, 6, 9, 47, 41, 43) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_MERGE', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'SORT_JOIN_TRANSPOSE', 'PROJECT_REDUCE_EXPRESSIONS', 'SORT_PROJECT_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS', 'UNION_TO_DISTINCT']""]"
161,tpch,select sum(l_extendedprice * l_discount) as revenue from lineitem where l_shipdate >= date '1997-01-01' and l_shipdate < date '1997-01-01' + interval '1' year and l_discount between 0.03 - 0.01 and 0.03 + 0.01 and l_quantity < 24;,SELECT SUM(l_extendedprice * l_discount) AS revenue FROM lineitem WHERE l_shipdate >= DATE '1997-01-01' AND l_shipdate < (DATE '1997-01-01' + INTERVAL '1' YEAR) AND l_discount >= 0.03 - 0.01 AND l_discount <= 0.03 + 0.01 AND l_quantity < 24,"['FILTER_REDUCE_EXPRESSIONS', 'FILTER_SCAN', 'AGGREGATE_ANY_PULL_UP_CONSTANTS']","[""select o_year, sum(case when nation = 'KENYA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD BURNISHED COPPER' ) as all_nations group by o_year order by o_year;""]","[""['SORT_REMOVE_CONSTANT_KEYS', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'SORT_JOIN_TRANSPOSE', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'PROJECT_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'AGGREGATE_ANY_PULL_UP_CONSTANTS', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'UNION_REMOVE', 'UNION_TO_DISTINCT', 'AGGREGATE_UNION_TRANSPOSE']""]"
162,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'CANADA' and n2.n_name = 'GERMANY') or (n1.n_name = 'GERMANY' and n2.n_name = 'CANADA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'CANADA' and n2.n_name = 'GERMANY') or (n1.n_name = 'GERMANY' and n2.n_name = 'CANADA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 4 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
163,tpch,"select o_year, sum(case when nation = 'GERMANY' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO ANODIZED COPPER' ) as all_nations group by o_year order by o_year;","select o_year, sum(case when nation = 'GERMANY' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO ANODIZED COPPER' ) as all_nations group by o_year order by o_year",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('30', '29', '41', '21', '24', '28', '36') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('30', '29', '41', '21', '24', '28', '36') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
164,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%slate%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation.n_name AS nation, EXTRACT(YEAR FROM t2.o_orderdate) AS o_year, SUM(t2.l_extendedprice * (1 - t2.l_discount) - t2.ps_supplycost * t2.l_quantity) AS sum_profit FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_name LIKE '%slate%') AS t, supplier, lineitem WHERE supplier.s_suppkey = lineitem.l_suppkey AND t.p_partkey = lineitem.l_partkey) AS t0, partsupp WHERE partsupp.ps_suppkey = t0.l_suppkey AND partsupp.ps_partkey = t0.l_partkey) AS t1, orders WHERE orders.o_orderkey = t1.l_orderkey) AS t2, nation WHERE t2.s_nationkey = nation.n_nationkey GROUP BY nation.n_name, EXTRACT(YEAR FROM t2.o_orderdate) ORDER BY nation.n_name, EXTRACT(YEAR FROM t2.o_orderdate) DESC","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE']","[""select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'MACHINERY' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-14' and l_shipdate > date '1995-03-14' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;""]","[""['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_TO_CALC', 'FILTER_INTO_JOIN']""]"
165,tpch,"select ps_partkey, sum(ps_supplycost * ps_availqty) as value from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'BRAZIL' group by ps_partkey having sum(ps_supplycost * ps_availqty) > ( select sum(ps_supplycost * ps_availqty) * 0.0001000000 from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'BRAZIL' ) order by value desc;","select ps_partkey, sum(ps_supplycost * ps_availqty) as value from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'BRAZIL' group by ps_partkey having sum(ps_supplycost * ps_availqty) > ( select sum(ps_supplycost * ps_availqty) * 0.0001000000 from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'BRAZIL' ) order by value desc",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 1 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
166,tpch,"select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('MAIL', 'FOB') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1993-01-01' and l_receiptdate < date '1993-01-01' + interval '1' year group by l_shipmode order by l_shipmode;","select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('MAIL', 'FOB') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1993-01-01' and l_receiptdate < date '1993-01-01' + interval '1' year group by l_shipmode order by l_shipmode",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('39', '21', '22', '41', '26', '35', '36') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('39', '21', '22', '41', '26', '35', '36') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
167,tpch,"select c_count, count(*) as custdist from ( select c_custkey, count(o_orderkey) from customer left outer join orders on c_custkey = o_custkey and o_comment not like '%unusual%packages%' group by c_custkey ) as c_orders (c_custkey, c_count) group by c_count order by custdist desc, c_count desc;","SELECT t0.EXPR1, COUNT(*) AS custdist FROM (SELECT customer.c_custkey, COUNT(t.o_orderkey) AS EXPR1 FROM customer LEFT JOIN (SELECT * FROM orders WHERE o_comment NOT LIKE '%unusual%packages%') AS t ON customer.c_custkey = t.o_custkey GROUP BY customer.c_custkey) AS t0 GROUP BY t0.EXPR1 ORDER BY COUNT(*) DESC, t0.EXPR1 DESC","['AGGREGATE_PROJECT_MERGE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'SORT_JOIN_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#55' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 7 and l_quantity <= 7 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#25' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 18 and l_quantity <= 18 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#51' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 25 and l_quantity <= 25 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['AGGREGATE_PROJECT_MERGE', 'FILTER_INTO_JOIN', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'SORT_REMOVE', 'JOIN_CONDITION_PUSH', 'FILTER_AGGREGATE_TRANSPOSE']""]"
168,tpch,"select 100.00 * sum(case when p_type like 'PROMO%' then l_extendedprice * (1 - l_discount) else 0 end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from lineitem, part where l_partkey = p_partkey and l_shipdate >= date '1993-08-01' and l_shipdate < date '1993-08-01' + interval '1' month;","select 100.00 * sum(case when p_type like 'PROMO%' then l_extendedprice * (1 - l_discount) else 0 end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from lineitem, part where l_partkey = p_partkey and l_shipdate >= date '1993-08-01' and l_shipdate < date '1993-08-01' + interval '1' month",[],"[""select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1993-03-01' and o_orderdate < date '1993-03-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;""]","[""['Empty List']""]"
169,tpch,"select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#34' and p_type not like 'PROMO BRUSHED%' and p_size in (33, 27, 42, 35, 24, 44, 34, 15) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;","select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#34' and p_type not like 'PROMO BRUSHED%' and p_size in (33, 27, 42, 35, 24, 44, 34, 15) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('27', '38', '36', '33', '21', '23', '26') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('27', '38', '36', '33', '21', '23', '26') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
170,tpch,"select sum(l_extendedprice) / 7.0 as avg_yearly from lineitem, part where p_partkey = l_partkey and p_brand = 'Brand#45' and p_container = 'JUMBO BAG' and l_quantity < ( select 0.2 * avg(l_quantity) from lineitem where l_partkey = p_partkey );","select sum(l_extendedprice) / 7.0 as avg_yearly from lineitem, part where p_partkey = l_partkey and p_brand = 'Brand#45' and p_container = 'JUMBO BAG' and l_quantity < ( select 0.2 * avg(l_quantity) from lineitem where l_partkey = p_partkey )",[],"[""select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'ARGENTINA' group by s_name order by numwait desc, s_name;""]","[""['Empty List']""]"
171,tpch,"select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#43' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 7 and l_quantity <= 7 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#54' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 11 and l_quantity <= 11 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#35' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 27 and l_quantity <= 27 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );","SELECT SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS revenue FROM lineitem INNER JOIN part ON lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#43' AND (part.p_container IN ('SM BOX', 'SM CASE', 'SM PACK', 'SM PKG') AND lineitem.l_quantity >= 7) AND (lineitem.l_quantity <= 7 + 10 AND (part.p_size >= 1 AND part.p_size <= 5) AND (lineitem.l_shipmode IN ('AIR', 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON')) OR lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#54' AND (part.p_container IN ('MED BAG', 'MED BOX', 'MED PACK', 'MED PKG') AND lineitem.l_quantity >= 11) AND (lineitem.l_quantity <= 11 + 10 AND (part.p_size >= 1 AND part.p_size <= 10) AND (lineitem.l_shipmode IN ('AIR', 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON')) OR lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#35' AND (part.p_container IN ('LG BOX', 'LG CASE', 'LG PACK', 'LG PKG') AND lineitem.l_quantity >= 27) AND (lineitem.l_quantity <= 27 + 10 AND (part.p_size >= 1 AND part.p_size <= 15) AND (lineitem.l_shipmode IN ('AIR', 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))","['FILTER_INTO_JOIN', 'FILTER_MERGE', 'JOIN_REDUCE_EXPRESSIONS', 'FILTER_REDUCE_EXPRESSIONS']","[""select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'FURNITURE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-01' and l_shipdate > date '1995-03-01' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;""]","[""['FILTER_INTO_JOIN', 'PROJECT_TO_CALC', 'JOIN_EXTRACT_FILTER']""]"
172,tpch,"select s_name, s_address from supplier, nation where s_suppkey in ( select ps_suppkey from partsupp where ps_partkey in ( select p_partkey from part where p_name like 'maroon%' ) and ps_availqty > ( select 0.5 * sum(l_quantity) from lineitem where l_partkey = ps_partkey and l_suppkey = ps_suppkey and l_shipdate >= date '1997-01-01' and l_shipdate < date '1997-01-01' + interval '1' year ) ) and s_nationkey = n_nationkey and n_name = 'MOZAMBIQUE' order by s_name;","SELECT supplier.s_name, supplier.s_address FROM supplier INNER JOIN (SELECT * FROM nation WHERE n_name = 'MOZAMBIQUE') AS t ON supplier.s_nationkey = t.n_nationkey INNER JOIN (SELECT partsupp.ps_suppkey FROM partsupp INNER JOIN (SELECT p_partkey FROM part WHERE p_name LIKE 'maroon%' GROUP BY p_partkey) AS t2 ON partsupp.ps_partkey = t2.p_partkey INNER JOIN (SELECT l_partkey, l_suppkey, SUM(l_quantity) AS f2 FROM lineitem WHERE l_shipdate >= DATE '1997-01-01' AND l_shipdate < (DATE '1997-01-01' + INTERVAL '1' YEAR) GROUP BY l_partkey, l_suppkey) AS t5 ON partsupp.ps_partkey = t5.l_partkey AND partsupp.ps_suppkey = t5.l_suppkey AND partsupp.ps_availqty > 0.5 * t5.f2 GROUP BY partsupp.ps_suppkey) AS t8 ON supplier.s_suppkey = t8.ps_suppkey ORDER BY supplier.s_name","['FILTER_INTO_JOIN', 'FILTER_PROJECT_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'FILTER_CORRELATE']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#24' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 9 and l_quantity <= 9 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#43' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 11 and l_quantity <= 11 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#42' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 22 and l_quantity <= 22 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_INTO_JOIN', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_REMOVE']""]"
173,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'SAUDI ARABIA' group by s_name order by numwait desc, s_name;","select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'SAUDI ARABIA' group by s_name order by numwait desc, s_name",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('24', '29', '22', '42', '39', '25', '20') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('24', '29', '22', '42', '39', '25', '20') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
174,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('36', '31', '41', '20', '27', '38', '26') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('36', '31', '41', '20', '27', '38', '26') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('36', '31', '41', '20', '27', '38', '26') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('36', '31', '41', '20', '27', '38', '26') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode",[],"[""select o_year, sum(case when nation = 'ROMANIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE POLISHED STEEL' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
175,tpch,"select l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order from lineitem where l_shipdate <= date '1998-12-01' - interval '106' day (3) group by l_returnflag, l_linestatus order by l_returnflag, l_linestatus;","select l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order from lineitem where l_shipdate <= date '1998-12-01' - interval '106' day (3) group by l_returnflag, l_linestatus order by l_returnflag, l_linestatus",[],"[""select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('MAIL', 'FOB') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1997-01-01' and l_receiptdate < date '1997-01-01' + interval '1' year group by l_shipmode order by l_shipmode;""]","[""['Empty List']""]"
176,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 15 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 15 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey",[],"[""select o_year, sum(case when nation = 'INDONESIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD POLISHED TIN' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
177,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'FURNITURE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-22' and l_shipdate > date '1995-03-22' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t2.l_orderkey, SUM(t2.l_extendedprice * (1 - t2.l_discount)) AS revenue, t1.o_orderdate, t1.o_shippriority FROM (SELECT * FROM (SELECT * FROM customer WHERE c_mktsegment = 'FURNITURE') AS t, (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-22') AS t0 WHERE t.c_custkey = t0.o_custkey) AS t1, (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-22') AS t2 WHERE t2.l_orderkey = t1.o_orderkey GROUP BY t2.l_orderkey, t1.o_orderdate, t1.o_shippriority ORDER BY SUM(t2.l_extendedprice * (1 - t2.l_discount)) DESC, t1.o_orderdate","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'AGGREGATE_PROJECT_MERGE']","[""select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from customer, orders, lineitem, nation where c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate >= date '1994-06-01' and o_orderdate < date '1994-06-01' + interval '3' month and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc;""]","[""['FILTER_INTO_JOIN', 'PROJECT_TO_CALC', 'JOIN_EXTRACT_FILTER']""]"
178,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1996-05-01' and o_orderdate < date '1996-05-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1996-05-01' and o_orderdate < date '1996-05-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('21', '34', '27', '36', '31', '30', '25') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('21', '34', '27', '36', '31', '30', '25') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
179,tpch,"select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and o_orderdate >= date '1995-01-01' and o_orderdate < date '1995-01-01' + interval '1' year group by n_name order by revenue desc;","SELECT nation.n_name, SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS revenue FROM customer INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate < (DATE '1995-01-01' + INTERVAL '1' YEAR)) AS t ON customer.c_custkey = t.o_custkey INNER JOIN lineitem ON t.o_orderkey = lineitem.l_orderkey INNER JOIN supplier ON lineitem.l_suppkey = supplier.s_suppkey AND customer.c_nationkey = supplier.s_nationkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t0 ON nation.n_regionkey = t0.r_regionkey GROUP BY nation.n_name ORDER BY SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) DESC","['SORT_REMOVE_CONSTANT_KEYS', 'JOIN_LEFT_UNION_TRANSPOSE', 'JOIN_RIGHT_UNION_TRANSPOSE', 'FILTER_INTO_JOIN', 'SORT_JOIN_TRANSPOSE', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_AGGREGATE_TRANSPOSE']","[""select o_year, sum(case when nation = 'GERMANY' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM ANODIZED TIN' ) as all_nations group by o_year order by o_year;""]","[""['SORT_REMOVE_CONSTANT_KEYS', 'JOIN_LEFT_UNION_TRANSPOSE', 'JOIN_RIGHT_UNION_TRANSPOSE', 'FILTER_INTO_JOIN', 'SORT_JOIN_TRANSPOSE', 'FILTER_PROJECT_TRANSPOSE', 'PROJECT_CORRELATE_TRANSPOSE', 'FILTER_AGGREGATE_TRANSPOSE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN']""]"
180,tpch,select sum(l_extendedprice * l_discount) as revenue from lineitem where l_shipdate >= date '1995-01-01' and l_shipdate < date '1995-01-01' + interval '1' year and l_discount between 0.08 - 0.01 and 0.08 + 0.01 and l_quantity < 25;,select sum(l_extendedprice * l_discount) as revenue from lineitem where l_shipdate >= date '1995-01-01' and l_shipdate < date '1995-01-01' + interval '1' year and l_discount between 0.08 - 0.01 and 0.08 + 0.01 and l_quantity < 25,[],"[""select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'IRAN' group by s_name order by numwait desc, s_name;""]","[""['Empty List']""]"
181,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'VIETNAM' and n2.n_name = 'RUSSIA') or (n1.n_name = 'RUSSIA' and n2.n_name = 'VIETNAM') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation.n_name AS supp_nation, nation0.n_name AS cust_nation, EXTRACT(YEAR FROM t.l_shipdate) AS l_year, SUM(t.l_extendedprice * (1 - t.l_discount)) AS revenue FROM supplier INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t ON supplier.s_suppkey = t.l_suppkey INNER JOIN orders ON t.l_orderkey = orders.o_orderkey INNER JOIN customer ON orders.o_custkey = customer.c_custkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey INNER JOIN nation AS nation0 ON customer.c_nationkey = nation0.n_nationkey AND (nation.n_name = 'VIETNAM' AND nation0.n_name = 'RUSSIA' OR nation.n_name = 'RUSSIA' AND nation0.n_name = 'VIETNAM') GROUP BY nation.n_name, nation0.n_name, EXTRACT(YEAR FROM t.l_shipdate) ORDER BY nation.n_name, nation0.n_name, EXTRACT(YEAR FROM t.l_shipdate)","['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'AGGREGATE_PROJECT_MERGE', 'SORT_REMOVE_CONSTANT_KEYS']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#22' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 5 and l_quantity <= 5 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#15' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 10 and l_quantity <= 10 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#13' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 30 and l_quantity <= 30 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH']""]"
182,tpch,"select o_year, sum(case when nation = 'RUSSIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE BRUSHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t5.o_orderdate) AS o_year, SUM(CASE WHEN t5.n_name0 = 'RUSSIA' THEN t5.l_extendedprice * (1 - t5.l_discount) ELSE 0 END) / SUM(t5.l_extendedprice * (1 - t5.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'LARGE BRUSHED COPPER') AS t, supplier, lineitem WHERE t.p_partkey = lineitem.l_partkey AND supplier.s_suppkey = lineitem.l_suppkey) AS t0, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t1 WHERE t0.l_orderkey = t1.o_orderkey) AS t2, customer WHERE t2.o_custkey = customer.c_custkey) AS t3, nation WHERE t3.c_nationkey = nation.n_nationkey) AS t4, nation AS nation0 WHERE t4.s_nationkey = nation0.n_nationkey) AS t5, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t6 WHERE t5.n_regionkey = t6.r_regionkey GROUP BY EXTRACT(YEAR FROM t5.o_orderdate) ORDER BY EXTRACT(YEAR FROM t5.o_orderdate)","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE']","[""select o_year, sum(case when nation = 'IRAQ' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY POLISHED STEEL' ) as all_nations group by o_year order by o_year;""]","[""['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_TO_CALC', 'FILTER_INTO_JOIN']""]"
183,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%papaya%' ) as profit group by nation, o_year order by nation, o_year desc;","select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%papaya%' ) as profit group by nation, o_year order by nation, o_year desc",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('22', '27', '21', '24', '40', '23', '26') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('22', '27', '21', '24', '40', '23', '26') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
184,tpch,"select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from customer, orders, lineitem, nation where c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate >= date '1993-06-01' and o_orderdate < date '1993-06-01' + interval '3' month and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc;","select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from customer, orders, lineitem, nation where c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate >= date '1993-06-01' and o_orderdate < date '1993-06-01' + interval '3' month and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc",[],"[""select o_year, sum(case when nation = 'CHINA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD BURNISHED COPPER' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
185,tpch,"select ps_partkey, sum(ps_supplycost * ps_availqty) as value from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'INDONESIA' group by ps_partkey having sum(ps_supplycost * ps_availqty) > ( select sum(ps_supplycost * ps_availqty) * 0.0001000000 from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'INDONESIA' ) order by value desc;","SELECT t1.ps_partkey, t1.value FROM (SELECT partsupp.ps_partkey, SUM(partsupp.ps_supplycost * partsupp.ps_availqty) AS value FROM partsupp INNER JOIN supplier ON partsupp.ps_suppkey = supplier.s_suppkey INNER JOIN (SELECT * FROM nation WHERE n_name = 'INDONESIA') AS t ON supplier.s_nationkey = t.n_nationkey GROUP BY partsupp.ps_partkey) AS t1 INNER JOIN (SELECT SUM(partsupp0.ps_supplycost * partsupp0.ps_availqty) * 0.0001000000 AS EXPR0 FROM partsupp AS partsupp0 INNER JOIN supplier AS supplier0 ON partsupp0.ps_suppkey = supplier0.s_suppkey INNER JOIN (SELECT * FROM nation WHERE n_name = 'INDONESIA') AS t2 ON supplier0.s_nationkey = t2.n_nationkey) AS t5 ON t1.value > t5.EXPR0 ORDER BY t1.value DESC","['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'AGGREGATE_PROJECT_MERGE']","[""select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1996-02-01' and o_orderdate < date '1996-02-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;""]","[""['AGGREGATE_PROJECT_MERGE']""]"
186,tpch,"select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('MAIL', 'RAIL') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1993-01-01' and l_receiptdate < date '1993-01-01' + interval '1' year group by l_shipmode order by l_shipmode;","select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('MAIL', 'RAIL') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1993-01-01' and l_receiptdate < date '1993-01-01' + interval '1' year group by l_shipmode order by l_shipmode",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 1 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
187,tpch,"select c_count, count(*) as custdist from ( select c_custkey, count(o_orderkey) from customer left outer join orders on c_custkey = o_custkey and o_comment not like '%pending%packages%' group by c_custkey ) as c_orders (c_custkey, c_count) group by c_count order by custdist desc, c_count desc;","SELECT t0.EXPR1, COUNT(*) AS custdist FROM (SELECT customer.c_custkey, COUNT(t.o_orderkey) AS EXPR1 FROM customer LEFT JOIN (SELECT * FROM orders WHERE o_comment NOT LIKE '%pending%packages%') AS t ON customer.c_custkey = t.o_custkey GROUP BY customer.c_custkey) AS t0 GROUP BY t0.EXPR1 ORDER BY COUNT(*) DESC, t0.EXPR1 DESC","['AGGREGATE_PROJECT_MERGE', 'FILTER_AGGREGATE_TRANSPOSE', 'JOIN_CONDITION_PUSH']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#45' and p_type not like 'LARGE POLISHED%' and p_size in (44, 16, 26, 8, 10, 40, 7, 17) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'JOIN_CONDITION_PUSH', 'FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'SORT_JOIN_TRANSPOSE']""]"
188,tpch,"select 100.00 * sum(case when p_type like 'PROMO%' then l_extendedprice * (1 - l_discount) else 0 end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from lineitem, part where l_partkey = p_partkey and l_shipdate >= date '1993-12-01' and l_shipdate < date '1993-12-01' + interval '1' month;","SELECT 100.00 * SUM(CASE WHEN part.p_type LIKE 'PROMO%' THEN t.l_extendedprice * (1 - t.l_discount) ELSE 0 END) / SUM(t.l_extendedprice * (1 - t.l_discount)) AS promo_revenue FROM (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1993-12-01' AND l_shipdate < (DATE '1993-12-01' + INTERVAL '1' MONTH)) AS t, part WHERE t.l_partkey = part.p_partkey","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_REDUCE_EXPRESSIONS']","[""select o_year, sum(case when nation = 'MOROCCO' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD ANODIZED TIN' ) as all_nations group by o_year order by o_year;""]","[""['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_TO_CALC', 'FILTER_INTO_JOIN']""]"
189,tpch,"select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#14' and p_type not like 'SMALL ANODIZED%' and p_size in (25, 26, 32, 10, 16, 9, 11, 47) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;","select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#14' and p_type not like 'SMALL ANODIZED%' and p_size in (25, 26, 32, 10, 16, 9, 11, 47) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size",[],"[""select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'SAUDI ARABIA' and n2.n_name = 'ALGERIA') or (n1.n_name = 'ALGERIA' and n2.n_name = 'SAUDI ARABIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;""]","[""['Empty List']""]"
190,tpch,"select sum(l_extendedprice) / 7.0 as avg_yearly from lineitem, part where p_partkey = l_partkey and p_brand = 'Brand#41' and p_container = 'MED JAR' and l_quantity < ( select 0.2 * avg(l_quantity) from lineitem where l_partkey = p_partkey );","select sum(l_extendedprice) / 7.0 as avg_yearly from lineitem, part where p_partkey = l_partkey and p_brand = 'Brand#41' and p_container = 'MED JAR' and l_quantity < ( select 0.2 * avg(l_quantity) from lineitem where l_partkey = p_partkey )",[],"[""select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'JAPAN' and n2.n_name = 'BRAZIL') or (n1.n_name = 'BRAZIL' and n2.n_name = 'JAPAN') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;""]","[""['Empty List']""]"
191,tpch,"select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#33' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 2 and l_quantity <= 2 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#41' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 20 and l_quantity <= 20 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#21' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 24 and l_quantity <= 24 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );","select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#33' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 2 and l_quantity <= 2 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#41' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 20 and l_quantity <= 20 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#21' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 24 and l_quantity <= 24 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' )",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('44', '33', '32', '41', '22', '26', '36') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('44', '33', '32', '41', '22', '26', '36') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
192,tpch,"select s_name, s_address from supplier, nation where s_suppkey in ( select ps_suppkey from partsupp where ps_partkey in ( select p_partkey from part where p_name like 'lime%' ) and ps_availqty > ( select 0.5 * sum(l_quantity) from lineitem where l_partkey = ps_partkey and l_suppkey = ps_suppkey and l_shipdate >= date '1996-01-01' and l_shipdate < date '1996-01-01' + interval '1' year ) ) and s_nationkey = n_nationkey and n_name = 'CANADA' order by s_name;","select s_name, s_address from supplier, nation where s_suppkey in ( select ps_suppkey from partsupp where ps_partkey in ( select p_partkey from part where p_name like 'lime%' ) and ps_availqty > ( select 0.5 * sum(l_quantity) from lineitem where l_partkey = ps_partkey and l_suppkey = ps_suppkey and l_shipdate >= date '1996-01-01' and l_shipdate < date '1996-01-01' + interval '1' year ) ) and s_nationkey = n_nationkey and n_name = 'CANADA' order by s_name",[],"[""select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'IRAN' and n2.n_name = 'MOZAMBIQUE') or (n1.n_name = 'MOZAMBIQUE' and n2.n_name = 'IRAN') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;""]","[""['Empty List']""]"
193,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('23', '27', '20', '25', '43', '33', '32') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('23', '27', '20', '25', '43', '33', '32') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('23', '27', '20', '25', '43', '33', '32') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('23', '27', '20', '25', '43', '33', '32') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode",[],"[""select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1997-05-01' and o_orderdate < date '1997-05-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;""]","[""['Empty List']""]"
194,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 36 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT supplier.s_acctbal, supplier.s_name, nation.n_name, t.p_partkey, t.p_mfgr, supplier.s_address, supplier.s_phone, supplier.s_comment FROM (SELECT * FROM part WHERE p_size = 36 AND p_type LIKE '%TIN') AS t CROSS JOIN supplier INNER JOIN partsupp ON t.p_partkey = partsupp.ps_partkey AND supplier.s_suppkey = partsupp.ps_suppkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t0 ON nation.n_regionkey = t0.r_regionkey INNER JOIN (SELECT partsupp0.ps_partkey, MIN(partsupp0.ps_supplycost) AS EXPR0 FROM partsupp AS partsupp0 INNER JOIN supplier AS supplier0 ON partsupp0.ps_suppkey = supplier0.s_suppkey INNER JOIN nation AS nation0 ON supplier0.s_nationkey = nation0.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1 ON nation0.n_regionkey = t1.r_regionkey GROUP BY partsupp0.ps_partkey) AS t3 ON t.p_partkey = t3.ps_partkey AND partsupp.ps_supplycost = t3.EXPR0 ORDER BY supplier.s_acctbal DESC, nation.n_name, supplier.s_name, t.p_partkey","['FILTER_INTO_JOIN', 'FILTER_MERGE', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH', 'JOIN_PROJECT_BOTH_TRANSPOSE']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#45' and p_type not like 'PROMO BURNISHED%' and p_size in (48, 22, 23, 15, 40, 6, 42, 32) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_INTO_JOIN', 'FILTER_MERGE', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED']""]"
195,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'AUTOMOBILE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-07' and l_shipdate > date '1995-03-07' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'AUTOMOBILE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-07' and l_shipdate > date '1995-03-07' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate",[],"[""select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%honeydew%' ) as profit group by nation, o_year order by nation, o_year desc;""]","[""['Empty List']""]"
196,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1994-02-01' and o_orderdate < date '1994-02-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","SELECT t.o_orderpriority, COUNT(*) AS order_count FROM (SELECT * FROM orders WHERE o_orderdate >= DATE '1994-02-01' AND o_orderdate < (DATE '1994-02-01' + INTERVAL '3' MONTH)) AS t INNER JOIN (SELECT l_orderkey, MIN(TRUE) AS f1 FROM lineitem WHERE l_commitdate < l_receiptdate GROUP BY l_orderkey) AS t2 ON t.o_orderkey = t2.l_orderkey GROUP BY t.o_orderpriority ORDER BY t.o_orderpriority","['FILTER_INTO_JOIN', 'FILTER_AGGREGATE_TRANSPOSE']","[""select o_year, sum(case when nation = 'EGYPT' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY ANODIZED COPPER' ) as all_nations group by o_year order by o_year;""]","[""['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_TO_CALC', 'FILTER_INTO_JOIN']""]"
197,tpch,"select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and o_orderdate >= date '1997-01-01' and o_orderdate < date '1997-01-01' + interval '1' year group by n_name order by revenue desc;","SELECT nation.n_name, SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS revenue FROM customer INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1997-01-01' AND o_orderdate < (DATE '1997-01-01' + INTERVAL '1' YEAR)) AS t ON customer.c_custkey = t.o_custkey INNER JOIN lineitem ON t.o_orderkey = lineitem.l_orderkey INNER JOIN supplier ON lineitem.l_suppkey = supplier.s_suppkey AND customer.c_nationkey = supplier.s_nationkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t0 ON nation.n_regionkey = t0.r_regionkey GROUP BY nation.n_name ORDER BY SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) DESC","['FILTER_MERGE', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'PROJECT_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_ANY_PULL_UP_CONSTANTS']","[""select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('MAIL', 'FOB') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1996-01-01' and l_receiptdate < date '1996-01-01' + interval '1' year group by l_shipmode order by l_shipmode;""]","[""['FILTER_MERGE', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'PROJECT_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_ANY_PULL_UP_CONSTANTS']""]"
198,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'INDIA' and n2.n_name = 'INDONESIA') or (n1.n_name = 'INDONESIA' and n2.n_name = 'INDIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'INDIA' and n2.n_name = 'INDONESIA') or (n1.n_name = 'INDONESIA' and n2.n_name = 'INDIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 28 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
199,tpch,"select o_year, sum(case when nation = 'INDONESIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE PLATED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t0.o_orderdate) AS o_year, SUM(CASE WHEN nation0.n_name = 'INDONESIA' THEN lineitem.l_extendedprice * (1 - lineitem.l_discount) ELSE 0 END) / SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'LARGE PLATED NICKEL') AS t CROSS JOIN supplier INNER JOIN lineitem ON t.p_partkey = lineitem.l_partkey AND supplier.s_suppkey = lineitem.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t0 ON lineitem.l_orderkey = t0.o_orderkey INNER JOIN customer ON t0.o_custkey = customer.c_custkey INNER JOIN nation ON customer.c_nationkey = nation.n_nationkey INNER JOIN nation AS nation0 ON supplier.s_nationkey = nation0.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'ASIA') AS t1 ON nation.n_regionkey = t1.r_regionkey GROUP BY EXTRACT(YEAR FROM t0.o_orderdate) ORDER BY EXTRACT(YEAR FROM t0.o_orderdate)","['FILTER_SCAN', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'JOIN_PROJECT_RIGHT_TRANSPOSE', 'PROJECT_CALC_MERGE', 'AGGREGATE_PROJECT_MERGE', 'SORT_REMOVE_CONSTANT_KEYS']","[""select 100.00 * sum(case when p_type like 'PROMO%' then l_extendedprice * (1 - l_discount) else 0 end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from lineitem, part where l_partkey = p_partkey and l_shipdate >= date '1994-06-01' and l_shipdate < date '1994-06-01' + interval '1' month;""]","[""['FILTER_SCAN', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'JOIN_PROJECT_RIGHT_TRANSPOSE', 'PROJECT_CALC_MERGE', 'PROJECT_CORRELATE_TRANSPOSE', 'CALC_MERGE', 'CALC_REMOVE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_PROJECT_MERGE']""]"
200,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%misty%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation.n_name AS nation, EXTRACT(YEAR FROM t2.o_orderdate) AS o_year, SUM(t2.l_extendedprice * (1 - t2.l_discount) - t2.ps_supplycost * t2.l_quantity) AS sum_profit FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_name LIKE '%misty%') AS t, supplier, lineitem WHERE supplier.s_suppkey = lineitem.l_suppkey AND t.p_partkey = lineitem.l_partkey) AS t0, partsupp WHERE partsupp.ps_suppkey = t0.l_suppkey AND partsupp.ps_partkey = t0.l_partkey) AS t1, orders WHERE orders.o_orderkey = t1.l_orderkey) AS t2, nation WHERE t2.s_nationkey = nation.n_nationkey GROUP BY nation.n_name, EXTRACT(YEAR FROM t2.o_orderdate) ORDER BY nation.n_name, EXTRACT(YEAR FROM t2.o_orderdate) DESC","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_REDUCE_EXPRESSIONS']","[""select o_year, sum(case when nation = 'PERU' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE POLISHED COPPER' ) as all_nations group by o_year order by o_year;""]","[""['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_TO_CALC', 'FILTER_INTO_JOIN']""]"
201,tpch,"select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from customer, orders, lineitem, nation where c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate >= date '1994-09-01' and o_orderdate < date '1994-09-01' + interval '3' month and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc;","select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from customer, orders, lineitem, nation where c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate >= date '1994-09-01' and o_orderdate < date '1994-09-01' + interval '3' month and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 4 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
202,tpch,"select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('SHIP', 'TRUCK') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1997-01-01' and l_receiptdate < date '1997-01-01' + interval '1' year group by l_shipmode order by l_shipmode;","select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('SHIP', 'TRUCK') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1997-01-01' and l_receiptdate < date '1997-01-01' + interval '1' year group by l_shipmode order by l_shipmode",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('30', '28', '39', '38', '36', '20', '24') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('30', '28', '39', '38', '36', '20', '24') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
203,tpch,"select c_count, count(*) as custdist from ( select c_custkey, count(o_orderkey) from customer left outer join orders on c_custkey = o_custkey and o_comment not like '%express%requests%' group by c_custkey ) as c_orders (c_custkey, c_count) group by c_count order by custdist desc, c_count desc;","SELECT t1.c_count, COUNT(*) AS custdist FROM (SELECT COUNT(orders.o_orderkey) AS c_count FROM customer LEFT JOIN orders ON customer.c_custkey = orders.o_custkey AND orders.o_comment NOT LIKE '%express%requests%' GROUP BY customer.c_custkey) AS t1 GROUP BY t1.c_count ORDER BY COUNT(*) DESC, t1.c_count DESC","['JOIN_PROJECT_LEFT_TRANSPOSE', 'FILTER_AGGREGATE_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#41' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 2 and l_quantity <= 2 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#44' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 15 and l_quantity <= 15 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#31' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 30 and l_quantity <= 30 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'AGGREGATE_PROJECT_MERGE']""]"
204,tpch,"select 100.00 * sum(case when p_type like 'PROMO%' then l_extendedprice * (1 - l_discount) else 0 end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from lineitem, part where l_partkey = p_partkey and l_shipdate >= date '1995-03-01' and l_shipdate < date '1995-03-01' + interval '1' month;","SELECT 100.00 * SUM(CASE WHEN part.p_type LIKE 'PROMO%' THEN t.l_extendedprice * (1 - t.l_discount) ELSE 0 END) / SUM(t.l_extendedprice * (1 - t.l_discount)) AS promo_revenue FROM (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-03-01' AND l_shipdate < (DATE '1995-03-01' + INTERVAL '1' MONTH)) AS t, part WHERE t.l_partkey = part.p_partkey","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_REDUCE_EXPRESSIONS']","[""select o_year, sum(case when nation = 'GERMANY' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO BURNISHED NICKEL' ) as all_nations group by o_year order by o_year;""]","[""['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_TO_CALC', 'FILTER_INTO_JOIN']""]"
205,tpch,"select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#44' and p_type not like 'ECONOMY BRUSHED%' and p_size in (28, 33, 3, 45, 15, 16, 39, 35) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;","select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#44' and p_type not like 'ECONOMY BRUSHED%' and p_size in (28, 33, 3, 45, 15, 16, 39, 35) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size",[],"[""select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'SAUDI ARABIA' group by s_name order by numwait desc, s_name;""]","[""['Empty List']""]"
206,tpch,"select sum(l_extendedprice) / 7.0 as avg_yearly from lineitem, part where p_partkey = l_partkey and p_brand = 'Brand#45' and p_container = 'MED PKG' and l_quantity < ( select 0.2 * avg(l_quantity) from lineitem where l_partkey = p_partkey );","SELECT SUM(lineitem.l_extendedprice) / 7.0 AS avg_yearly FROM lineitem INNER JOIN (SELECT * FROM part WHERE p_brand = 'Brand#45' AND p_container = 'MED PKG') AS t ON lineitem.l_partkey = t.p_partkey INNER JOIN (SELECT l_partkey, AVG(l_quantity) AS f1 FROM lineitem GROUP BY l_partkey) AS t0 ON t.p_partkey = t0.l_partkey AND lineitem.l_quantity < 0.2 * t0.f1","['FILTER_CORRELATE', 'JOIN_CONDITION_PUSH', 'AGGREGATE_PROJECT_MERGE']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#23' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 3 and l_quantity <= 3 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#42' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 18 and l_quantity <= 18 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#31' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 29 and l_quantity <= 29 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'AGGREGATE_PROJECT_MERGE']""]"
207,tpch,"select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#34' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 8 and l_quantity <= 8 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#15' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 16 and l_quantity <= 16 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#22' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 23 and l_quantity <= 23 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );",SELECT SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS revenue FROM lineitem INNER JOIN part ON lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#34' AND ((part.p_container = 'SM CASE' OR part.p_container = 'SM BOX' OR part.p_container = 'SM PACK' OR part.p_container = 'SM PKG') AND lineitem.l_quantity >= 8) AND (lineitem.l_quantity <= 8 + 10 AND part.p_size >= 1 AND (part.p_size <= 5 AND ((lineitem.l_shipmode = 'AIR' OR lineitem.l_shipmode = 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))) OR lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#15' AND ((part.p_container = 'MED BAG' OR part.p_container = 'MED BOX' OR part.p_container = 'MED PKG' OR part.p_container = 'MED PACK') AND lineitem.l_quantity >= 16) AND (lineitem.l_quantity <= 16 + 10 AND part.p_size >= 1 AND (part.p_size <= 10 AND ((lineitem.l_shipmode = 'AIR' OR lineitem.l_shipmode = 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))) OR lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#22' AND ((part.p_container = 'LG CASE' OR part.p_container = 'LG BOX' OR part.p_container = 'LG PACK' OR part.p_container = 'LG PKG') AND lineitem.l_quantity >= 23) AND (lineitem.l_quantity <= 23 + 10 AND part.p_size >= 1 AND (part.p_size <= 15 AND ((lineitem.l_shipmode = 'AIR' OR lineitem.l_shipmode = 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))),"['FILTER_MERGE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE']","[""select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('MAIL', 'TRUCK') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1993-01-01' and l_receiptdate < date '1993-01-01' + interval '1' year group by l_shipmode order by l_shipmode;""]","[""['FILTER_INTO_JOIN', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES']""]"
208,tpch,"select s_name, s_address from supplier, nation where s_suppkey in ( select ps_suppkey from partsupp where ps_partkey in ( select p_partkey from part where p_name like 'orchid%' ) and ps_availqty > ( select 0.5 * sum(l_quantity) from lineitem where l_partkey = ps_partkey and l_suppkey = ps_suppkey and l_shipdate >= date '1993-01-01' and l_shipdate < date '1993-01-01' + interval '1' year ) ) and s_nationkey = n_nationkey and n_name = 'RUSSIA' order by s_name;","SELECT supplier.s_name, supplier.s_address FROM supplier INNER JOIN (SELECT * FROM nation WHERE n_name = 'RUSSIA') AS t ON supplier.s_nationkey = t.n_nationkey INNER JOIN (SELECT partsupp.ps_suppkey FROM partsupp INNER JOIN (SELECT p_partkey FROM part WHERE p_name LIKE 'orchid%' GROUP BY p_partkey) AS t2 ON partsupp.ps_partkey = t2.p_partkey INNER JOIN (SELECT l_partkey, l_suppkey, SUM(l_quantity) AS f2 FROM lineitem WHERE l_shipdate >= DATE '1993-01-01' AND l_shipdate < (DATE '1993-01-01' + INTERVAL '1' YEAR) GROUP BY l_partkey, l_suppkey) AS t5 ON partsupp.ps_partkey = t5.l_partkey AND partsupp.ps_suppkey = t5.l_suppkey AND partsupp.ps_availqty > 0.5 * t5.f2 GROUP BY partsupp.ps_suppkey) AS t8 ON supplier.s_suppkey = t8.ps_suppkey ORDER BY supplier.s_name","['FILTER_INTO_JOIN', 'FILTER_MERGE', 'FILTER_REDUCE_EXPRESSIONS']","[""select o_year, sum(case when nation = 'PERU' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY POLISHED BRASS' ) as all_nations group by o_year order by o_year;""]","[""['FILTER_INTO_JOIN']""]"
209,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'ALGERIA' group by s_name order by numwait desc, s_name;","SELECT t4.s_name, COUNT(*) AS numwait FROM (SELECT * FROM (SELECT supplier.s_suppkey, supplier.s_name, supplier.s_address, supplier.s_nationkey, supplier.s_phone, supplier.s_acctbal, supplier.s_comment, lineitem.l_orderkey, lineitem.l_partkey, lineitem.l_suppkey, lineitem.l_linenumber, lineitem.l_quantity, lineitem.l_extendedprice, lineitem.l_discount, lineitem.l_tax, lineitem.l_returnflag, lineitem.l_linestatus, lineitem.l_shipdate, lineitem.l_commitdate, lineitem.l_receiptdate, lineitem.l_shipinstruct, lineitem.l_shipmode, lineitem.l_comment, orders.o_orderkey, orders.o_custkey, orders.o_orderstatus, orders.o_totalprice, orders.o_orderdate, orders.o_orderpriority, orders.o_clerk, orders.o_shippriority, orders.o_comment, nation.n_nationkey, nation.n_name, nation.n_regionkey, nation.n_comment, t2.f2 AS f0 FROM supplier CROSS JOIN lineitem CROSS JOIN orders CROSS JOIN nation LEFT JOIN (SELECT t.l_orderkey AS l_orderkey0, t.l_suppkey AS l_suppkey0, MIN(TRUE) AS f2 FROM lineitem AS lineitem0, (SELECT lineitem1.l_orderkey, lineitem1.l_suppkey FROM supplier AS supplier0, lineitem AS lineitem1, orders AS orders0, nation AS nation0 GROUP BY lineitem1.l_orderkey, lineitem1.l_suppkey) AS t WHERE lineitem0.l_orderkey = t.l_orderkey AND lineitem0.l_suppkey <> t.l_suppkey GROUP BY t.l_orderkey, t.l_suppkey) AS t2 ON lineitem.l_orderkey = t2.l_orderkey0 AND lineitem.l_suppkey = t2.l_suppkey0) AS t3 WHERE t3.s_suppkey = t3.l_suppkey AND (t3.o_orderkey = t3.l_orderkey AND t3.o_orderstatus = 'F') AND (t3.l_receiptdate > t3.l_commitdate AND t3.s_nationkey = t3.n_nationkey AND (t3.n_name = 'ALGERIA' AND t3.f0 IS NOT NULL))) AS t4 LEFT JOIN (SELECT t12.l_orderkey AS l_orderkey0, t12.l_suppkey AS l_suppkey0, MIN(TRUE) AS f2 FROM (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t5, (SELECT l_orderkey, l_suppkey FROM (SELECT supplier1.s_suppkey, supplier1.s_name, supplier1.s_address, supplier1.s_nationkey, supplier1.s_phone, supplier1.s_acctbal, supplier1.s_comment, lineitem3.l_orderkey, lineitem3.l_partkey, lineitem3.l_suppkey, lineitem3.l_linenumber, lineitem3.l_quantity, lineitem3.l_extendedprice, lineitem3.l_discount, lineitem3.l_tax, lineitem3.l_returnflag, lineitem3.l_linestatus, lineitem3.l_shipdate, lineitem3.l_commitdate, lineitem3.l_receiptdate, lineitem3.l_shipinstruct, lineitem3.l_shipmode, lineitem3.l_comment, orders1.o_orderkey, orders1.o_custkey, orders1.o_orderstatus, orders1.o_totalprice, orders1.o_orderdate, orders1.o_orderpriority, orders1.o_clerk, orders1.o_shippriority, orders1.o_comment, nation1.n_nationkey, nation1.n_name, nation1.n_regionkey, nation1.n_comment, t9.f2 AS f0 FROM supplier AS supplier1 CROSS JOIN lineitem AS lineitem3 CROSS JOIN orders AS orders1 CROSS JOIN nation AS nation1 LEFT JOIN (SELECT t6.l_orderkey AS l_orderkey0, t6.l_suppkey AS l_suppkey0, MIN(TRUE) AS f2 FROM lineitem AS lineitem4, (SELECT lineitem5.l_orderkey, lineitem5.l_suppkey FROM supplier AS supplier2, lineitem AS lineitem5, orders AS orders2, nation AS nation2 GROUP BY lineitem5.l_orderkey, lineitem5.l_suppkey) AS t6 WHERE lineitem4.l_orderkey = t6.l_orderkey AND lineitem4.l_suppkey <> t6.l_suppkey GROUP BY t6.l_orderkey, t6.l_suppkey) AS t9 ON lineitem3.l_orderkey = t9.l_orderkey0 AND lineitem3.l_suppkey = t9.l_suppkey0) AS t10 WHERE t10.s_suppkey = t10.l_suppkey AND (t10.o_orderkey = t10.l_orderkey AND t10.o_orderstatus = 'F') AND (t10.l_receiptdate > t10.l_commitdate AND t10.s_nationkey = t10.n_nationkey AND (t10.n_name = 'ALGERIA' AND t10.f0 IS NOT NULL)) GROUP BY l_orderkey, l_suppkey) AS t12 WHERE t5.l_orderkey = t12.l_orderkey AND t5.l_suppkey <> t12.l_suppkey GROUP BY t12.l_orderkey, t12.l_suppkey) AS t15 ON t4.l_orderkey = t15.l_orderkey0 AND t4.l_suppkey = t15.l_suppkey0 WHERE t15.f2 IS NULL GROUP BY t4.s_name ORDER BY COUNT(*) DESC, t4.s_name","['FILTER_AGGREGATE_TRANSPOSE', 'FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'JOIN_EXTRACT_FILTER', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#33' and p_type not like 'SMALL BRUSHED%' and p_size in (28, 8, 22, 14, 19, 44, 47, 45) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'AGGREGATE_PROJECT_MERGE', 'FILTER_AGGREGATE_TRANSPOSE', 'FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'FILTER_MERGE', 'JOIN_CONDITION_PUSH', 'JOIN_EXTRACT_FILTER', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'PROJECT_CORRELATE_TRANSPOSE', 'PROJECT_MERGE', 'PROJECT_REDUCE_EXPRESSIONS', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS']""]"
210,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('42', '26', '27', '39', '37', '30', '36') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('42', '26', '27', '39', '37', '30', '36') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('42', '26', '27', '39', '37', '30', '36') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('42', '26', '27', '39', '37', '30', '36') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 38 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
211,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 12 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT supplier.s_acctbal, supplier.s_name, nation.n_name, t.p_partkey, t.p_mfgr, supplier.s_address, supplier.s_phone, supplier.s_comment FROM (SELECT * FROM part WHERE p_size = 12 AND p_type LIKE '%NICKEL') AS t CROSS JOIN supplier INNER JOIN partsupp ON t.p_partkey = partsupp.ps_partkey AND supplier.s_suppkey = partsupp.ps_suppkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t0 ON nation.n_regionkey = t0.r_regionkey INNER JOIN (SELECT partsupp0.ps_partkey, MIN(partsupp0.ps_supplycost) AS EXPR0 FROM partsupp AS partsupp0 INNER JOIN supplier AS supplier0 ON partsupp0.ps_suppkey = supplier0.s_suppkey INNER JOIN nation AS nation0 ON supplier0.s_nationkey = nation0.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1 ON nation0.n_regionkey = t1.r_regionkey GROUP BY partsupp0.ps_partkey) AS t3 ON t.p_partkey = t3.ps_partkey AND partsupp.ps_supplycost = t3.EXPR0 ORDER BY supplier.s_acctbal DESC, nation.n_name, supplier.s_name, t.p_partkey","['FILTER_MERGE', 'FILTER_INTO_JOIN', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH', 'PROJECT_REDUCE_EXPRESSIONS', 'SORT_JOIN_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#32' and p_type not like 'MEDIUM PLATED%' and p_size in (17, 31, 4, 32, 2, 33, 26, 1) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_MERGE', 'FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH', 'PROJECT_REDUCE_EXPRESSIONS', 'SORT_JOIN_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE']""]"
212,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'FURNITURE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-06' and l_shipdate > date '1995-03-06' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t1.l_orderkey, SUM(t1.l_extendedprice * (1 - t1.l_discount)) AS revenue, t0.o_orderdate, t0.o_shippriority FROM (SELECT * FROM customer WHERE c_mktsegment = 'FURNITURE') AS t INNER JOIN (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-06') AS t0 ON t.c_custkey = t0.o_custkey INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-06') AS t1 ON t0.o_orderkey = t1.l_orderkey GROUP BY t1.l_orderkey, t0.o_orderdate, t0.o_shippriority ORDER BY SUM(t1.l_extendedprice * (1 - t1.l_discount)) DESC, t0.o_orderdate","['FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'AGGREGATE_PROJECT_MERGE', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#55' and p_type not like 'STANDARD PLATED%' and p_size in (28, 23, 46, 22, 9, 19, 26, 41) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'SORT_JOIN_TRANSPOSE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'AGGREGATE_UNION_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'SORT_UNION_TRANSPOSE']""]"
213,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1993-12-01' and o_orderdate < date '1993-12-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","SELECT t.o_orderpriority, COUNT(*) AS order_count FROM (SELECT * FROM orders WHERE o_orderdate >= DATE '1993-12-01' AND o_orderdate < (DATE '1993-12-01' + INTERVAL '3' MONTH)) AS t INNER JOIN (SELECT l_orderkey, MIN(TRUE) AS f1 FROM lineitem WHERE l_commitdate < l_receiptdate GROUP BY l_orderkey) AS t2 ON t.o_orderkey = t2.l_orderkey GROUP BY t.o_orderpriority ORDER BY t.o_orderpriority","['FILTER_INTO_JOIN', 'FILTER_AGGREGATE_TRANSPOSE']","[""select o_year, sum(case when nation = 'ROMANIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY BURNISHED BRASS' ) as all_nations group by o_year order by o_year;""]","[""['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_TO_CALC', 'FILTER_INTO_JOIN']""]"
214,tpch,"select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and o_orderdate >= date '1995-01-01' and o_orderdate < date '1995-01-01' + interval '1' year group by n_name order by revenue desc;","select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and o_orderdate >= date '1995-01-01' and o_orderdate < date '1995-01-01' + interval '1' year group by n_name order by revenue desc",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('36', '31', '22', '20', '24', '25', '39') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('36', '31', '22', '20', '24', '25', '39') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
215,tpch,select sum(l_extendedprice * l_discount) as revenue from lineitem where l_shipdate >= date '1995-01-01' and l_shipdate < date '1995-01-01' + interval '1' year and l_discount between 0.09 - 0.01 and 0.09 + 0.01 and l_quantity < 24;,SELECT SUM(l_extendedprice * l_discount) AS revenue FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate < (DATE '1995-01-01' + INTERVAL '1' YEAR) AND l_discount >= 0.09 - 0.01 AND l_discount <= 0.09 + 0.01 AND l_quantity < 24,"['FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#24' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 6 and l_quantity <= 6 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#55' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 16 and l_quantity <= 16 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#31' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 24 and l_quantity <= 24 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_INTO_JOIN', 'FILTER_SCAN', 'FILTER_CORRELATE', 'JOIN_CONDITION_PUSH', 'JOIN_REDUCE_EXPRESSIONS', 'PROJECT_REMOVE', 'PROJECT_REDUCE_EXPRESSIONS', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_REMOVE']""]"
216,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'RUSSIA' and n2.n_name = 'ALGERIA') or (n1.n_name = 'ALGERIA' and n2.n_name = 'RUSSIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation.n_name AS supp_nation, nation0.n_name AS cust_nation, EXTRACT(YEAR FROM t.l_shipdate) AS l_year, SUM(t.l_extendedprice * (1 - t.l_discount)) AS revenue FROM supplier INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t ON supplier.s_suppkey = t.l_suppkey INNER JOIN orders ON t.l_orderkey = orders.o_orderkey INNER JOIN customer ON orders.o_custkey = customer.c_custkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey INNER JOIN nation AS nation0 ON customer.c_nationkey = nation0.n_nationkey AND (nation.n_name = 'RUSSIA' AND nation0.n_name = 'ALGERIA' OR nation.n_name = 'ALGERIA' AND nation0.n_name = 'RUSSIA') GROUP BY nation.n_name, nation0.n_name, EXTRACT(YEAR FROM t.l_shipdate) ORDER BY nation.n_name, nation0.n_name, EXTRACT(YEAR FROM t.l_shipdate)","['FILTER_INTO_JOIN', 'JOIN_REDUCE_EXPRESSIONS', 'FILTER_REDUCE_EXPRESSIONS']","[""select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%red%' ) as profit group by nation, o_year order by nation, o_year desc;""]","[""['FILTER_INTO_JOIN']""]"
217,tpch,"select o_year, sum(case when nation = 'ALGERIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY ANODIZED COPPER' ) as all_nations group by o_year order by o_year;","select o_year, sum(case when nation = 'ALGERIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY ANODIZED COPPER' ) as all_nations group by o_year order by o_year",[],"[""select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'SAUDI ARABIA' and n2.n_name = 'ALGERIA') or (n1.n_name = 'ALGERIA' and n2.n_name = 'SAUDI ARABIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;""]","[""['Empty List']""]"
218,tpch,"select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from customer, orders, lineitem, nation where c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate >= date '1994-05-01' and o_orderdate < date '1994-05-01' + interval '3' month and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc;","select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from customer, orders, lineitem, nation where c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate >= date '1994-05-01' and o_orderdate < date '1994-05-01' + interval '3' month and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 21 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
219,tpch,"select ps_partkey, sum(ps_supplycost * ps_availqty) as value from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'MOZAMBIQUE' group by ps_partkey having sum(ps_supplycost * ps_availqty) > ( select sum(ps_supplycost * ps_availqty) * 0.0001000000 from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'MOZAMBIQUE' ) order by value desc;","select ps_partkey, sum(ps_supplycost * ps_availqty) as value from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'MOZAMBIQUE' group by ps_partkey having sum(ps_supplycost * ps_availqty) > ( select sum(ps_supplycost * ps_availqty) * 0.0001000000 from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'MOZAMBIQUE' ) order by value desc",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('30', '24', '25', '37', '27', '32', '38') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('30', '24', '25', '37', '27', '32', '38') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
220,tpch,"select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('AIR', 'RAIL') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1997-01-01' and l_receiptdate < date '1997-01-01' + interval '1' year group by l_shipmode order by l_shipmode;","select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('AIR', 'RAIL') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1997-01-01' and l_receiptdate < date '1997-01-01' + interval '1' year group by l_shipmode order by l_shipmode",[],"[""select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'SAUDI ARABIA' and n2.n_name = 'VIETNAM') or (n1.n_name = 'VIETNAM' and n2.n_name = 'SAUDI ARABIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;""]","[""['Empty List']""]"
221,tpch,"select 100.00 * sum(case when p_type like 'PROMO%' then l_extendedprice * (1 - l_discount) else 0 end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from lineitem, part where l_partkey = p_partkey and l_shipdate >= date '1993-11-01' and l_shipdate < date '1993-11-01' + interval '1' month;","select 100.00 * sum(case when p_type like 'PROMO%' then l_extendedprice * (1 - l_discount) else 0 end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from lineitem, part where l_partkey = p_partkey and l_shipdate >= date '1993-11-01' and l_shipdate < date '1993-11-01' + interval '1' month",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('25', '38', '23', '27', '24', '34', '44') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('25', '38', '23', '27', '24', '34', '44') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
222,tpch,"select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#51' and p_type not like 'LARGE POLISHED%' and p_size in (36, 33, 50, 7, 31, 16, 34, 23) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;","SELECT t6.p_brand, t6.p_type, t6.p_size, COUNT(t6.ps_suppkey) AS supplier_cnt FROM (SELECT t0.p_brand, t0.p_type, t0.p_size, t0.ps_suppkey FROM (SELECT * FROM (SELECT partsupp.ps_partkey, partsupp.ps_suppkey, partsupp.ps_availqty, partsupp.ps_supplycost, partsupp.ps_comment, part.p_partkey, part.p_name, part.p_mfgr, part.p_brand, part.p_type, part.p_size, part.p_container, part.p_retailprice, part.p_comment, partsupp.ps_suppkey AS ps_suppkey0 FROM partsupp, part) AS t WHERE t.p_partkey = t.ps_partkey AND CAST(t.p_brand AS CHAR(8)) <> 'Brand#51' AND t.p_size IN (7, 16, 23, 31, 33, 34, 36, 50) AND t.p_type NOT LIKE 'LARGE POLISHED%') AS t0 LEFT JOIN (SELECT s_suppkey, MIN(TRUE) AS f1 FROM supplier WHERE s_comment LIKE '%Customer%Complaints%' GROUP BY s_suppkey) AS t3 ON t0.ps_suppkey0 = t3.s_suppkey WHERE t3.f1 IS NOT TRUE GROUP BY t0.p_brand, t0.p_type, t0.p_size, t0.ps_suppkey) AS t6 GROUP BY t6.p_brand, t6.p_type, t6.p_size ORDER BY COUNT(t6.ps_suppkey) DESC, t6.p_brand, t6.p_type, t6.p_size","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS']","[""select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from customer, orders, lineitem, nation where c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate >= date '1993-12-01' and o_orderdate < date '1993-12-01' + interval '3' month and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc;""]","[""['FILTER_INTO_JOIN', 'PROJECT_TO_CALC', 'JOIN_EXTRACT_FILTER']""]"
223,tpch,"select sum(l_extendedprice) / 7.0 as avg_yearly from lineitem, part where p_partkey = l_partkey and p_brand = 'Brand#14' and p_container = 'JUMBO PACK' and l_quantity < ( select 0.2 * avg(l_quantity) from lineitem where l_partkey = p_partkey );","SELECT SUM(t0.l_extendedprice) / 7.0 AS avg_yearly FROM (SELECT * FROM lineitem, (SELECT * FROM part WHERE p_brand = 'Brand#14' AND p_container = 'JUMBO PACK') AS t WHERE t.p_partkey = lineitem.l_partkey) AS t0, (SELECT l_partkey, AVG(l_quantity) AS f1 FROM lineitem GROUP BY l_partkey) AS t2 WHERE t0.p_partkey = t2.l_partkey AND t0.l_quantity < 0.2 * t2.f1","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_CORRELATE']","[""select o_year, sum(case when nation = 'ARGENTINA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE BRUSHED BRASS' ) as all_nations group by o_year order by o_year;""]","[""['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_TO_CALC', 'FILTER_INTO_JOIN']""]"
224,tpch,"select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#44' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 7 and l_quantity <= 7 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#51' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 14 and l_quantity <= 14 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#32' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 23 and l_quantity <= 23 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );",SELECT SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS revenue FROM lineitem INNER JOIN part ON lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#44' AND ((part.p_container = 'SM CASE' OR part.p_container = 'SM BOX' OR part.p_container = 'SM PACK' OR part.p_container = 'SM PKG') AND lineitem.l_quantity >= 7) AND (lineitem.l_quantity <= 7 + 10 AND part.p_size >= 1 AND (part.p_size <= 5 AND ((lineitem.l_shipmode = 'AIR' OR lineitem.l_shipmode = 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))) OR lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#51' AND ((part.p_container = 'MED BAG' OR part.p_container = 'MED BOX' OR part.p_container = 'MED PKG' OR part.p_container = 'MED PACK') AND lineitem.l_quantity >= 14) AND (lineitem.l_quantity <= 14 + 10 AND part.p_size >= 1 AND (part.p_size <= 10 AND ((lineitem.l_shipmode = 'AIR' OR lineitem.l_shipmode = 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))) OR lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#32' AND ((part.p_container = 'LG CASE' OR part.p_container = 'LG BOX' OR part.p_container = 'LG PACK' OR part.p_container = 'LG PKG') AND lineitem.l_quantity >= 23) AND (lineitem.l_quantity <= 23 + 10 AND part.p_size >= 1 AND (part.p_size <= 15 AND ((lineitem.l_shipmode = 'AIR' OR lineitem.l_shipmode = 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))),"['FILTER_AGGREGATE_TRANSPOSE', 'FILTER_INTO_JOIN', 'AGGREGATE_PROJECT_MERGE']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#53' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 10 and l_quantity <= 10 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#43' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 14 and l_quantity <= 14 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#51' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 25 and l_quantity <= 25 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_AGGREGATE_TRANSPOSE', 'FILTER_INTO_JOIN', 'AGGREGATE_PROJECT_MERGE']""]"
225,tpch,"select s_name, s_address from supplier, nation where s_suppkey in ( select ps_suppkey from partsupp where ps_partkey in ( select p_partkey from part where p_name like 'orange%' ) and ps_availqty > ( select 0.5 * sum(l_quantity) from lineitem where l_partkey = ps_partkey and l_suppkey = ps_suppkey and l_shipdate >= date '1997-01-01' and l_shipdate < date '1997-01-01' + interval '1' year ) ) and s_nationkey = n_nationkey and n_name = 'ARGENTINA' order by s_name;","select s_name, s_address from supplier, nation where s_suppkey in ( select ps_suppkey from partsupp where ps_partkey in ( select p_partkey from part where p_name like 'orange%' ) and ps_availqty > ( select 0.5 * sum(l_quantity) from lineitem where l_partkey = ps_partkey and l_suppkey = ps_suppkey and l_shipdate >= date '1997-01-01' and l_shipdate < date '1997-01-01' + interval '1' year ) ) and s_nationkey = n_nationkey and n_name = 'ARGENTINA' order by s_name",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('35', '24', '29', '40', '43', '22', '39') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('35', '24', '29', '40', '43', '22', '39') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
226,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('21', '34', '27', '36', '31', '30', '25') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('21', '34', '27', '36', '31', '30', '25') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('21', '34', '27', '36', '31', '30', '25') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('21', '34', '27', '36', '31', '30', '25') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 49 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
227,tpch,"select l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order from lineitem where l_shipdate <= date '1998-12-01' - interval '66' day (3) group by l_returnflag, l_linestatus order by l_returnflag, l_linestatus;","select l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order from lineitem where l_shipdate <= date '1998-12-01' - interval '66' day (3) group by l_returnflag, l_linestatus order by l_returnflag, l_linestatus",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 4 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
228,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 41 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT supplier.s_acctbal, supplier.s_name, nation.n_name, t.p_partkey, t.p_mfgr, supplier.s_address, supplier.s_phone, supplier.s_comment FROM (SELECT * FROM part WHERE p_size = 41 AND p_type LIKE '%TIN') AS t CROSS JOIN supplier INNER JOIN partsupp ON t.p_partkey = partsupp.ps_partkey AND supplier.s_suppkey = partsupp.ps_suppkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'EUROPE') AS t0 ON nation.n_regionkey = t0.r_regionkey INNER JOIN (SELECT partsupp0.ps_partkey, MIN(partsupp0.ps_supplycost) AS EXPR0 FROM partsupp AS partsupp0 INNER JOIN supplier AS supplier0 ON partsupp0.ps_suppkey = supplier0.s_suppkey INNER JOIN nation AS nation0 ON supplier0.s_nationkey = nation0.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1 ON nation0.n_regionkey = t1.r_regionkey GROUP BY partsupp0.ps_partkey) AS t3 ON t.p_partkey = t3.ps_partkey AND partsupp.ps_supplycost = t3.EXPR0 ORDER BY supplier.s_acctbal DESC, nation.n_name, supplier.s_name, t.p_partkey","['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_REDUCE_EXPRESSIONS']","[""select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'SAUDI ARABIA' and n2.n_name = 'UNITED KINGDOM') or (n1.n_name = 'UNITED KINGDOM' and n2.n_name = 'SAUDI ARABIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;""]","[""['FILTER_INTO_JOIN']""]"
229,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'HOUSEHOLD' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-24' and l_shipdate > date '1995-03-24' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'HOUSEHOLD' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-24' and l_shipdate > date '1995-03-24' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate",[],"[""select o_year, sum(case when nation = 'INDIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL BURNISHED STEEL' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
230,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1996-10-01' and o_orderdate < date '1996-10-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1996-10-01' and o_orderdate < date '1996-10-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority",[],"[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#34' and p_type not like 'ECONOMY PLATED%' and p_size in (46, 43, 2, 27, 29, 6, 33, 13) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['Empty List']""]"
231,tpch,"select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and o_orderdate >= date '1995-01-01' and o_orderdate < date '1995-01-01' + interval '1' year group by n_name order by revenue desc;","select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and o_orderdate >= date '1995-01-01' and o_orderdate < date '1995-01-01' + interval '1' year group by n_name order by revenue desc",[],"[""select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'MACHINERY' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-20' and l_shipdate > date '1995-03-20' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;""]","[""['Empty List']""]"
232,tpch,select sum(l_extendedprice * l_discount) as revenue from lineitem where l_shipdate >= date '1995-01-01' and l_shipdate < date '1995-01-01' + interval '1' year and l_discount between 0.07 - 0.01 and 0.07 + 0.01 and l_quantity < 25;,SELECT SUM(l_extendedprice * l_discount) AS revenue FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate < (DATE '1995-01-01' + INTERVAL '1' YEAR) AND l_discount >= 0.07 - 0.01 AND l_discount <= 0.07 + 0.01 AND l_quantity < 25,"['PROJECT_REMOVE', 'FILTER_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_REMOVE']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#11' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 8 and l_quantity <= 8 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#42' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 13 and l_quantity <= 13 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#52' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 27 and l_quantity <= 27 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['PROJECT_REMOVE', 'FILTER_INTO_JOIN', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_REMOVE']""]"
233,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'MOZAMBIQUE' and n2.n_name = 'PERU') or (n1.n_name = 'PERU' and n2.n_name = 'MOZAMBIQUE') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation.n_name AS supp_nation, nation0.n_name AS cust_nation, EXTRACT(YEAR FROM t.l_shipdate) AS l_year, SUM(t.l_extendedprice * (1 - t.l_discount)) AS revenue FROM supplier INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t ON supplier.s_suppkey = t.l_suppkey INNER JOIN orders ON t.l_orderkey = orders.o_orderkey INNER JOIN customer ON orders.o_custkey = customer.c_custkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey INNER JOIN nation AS nation0 ON customer.c_nationkey = nation0.n_nationkey AND (nation.n_name = 'MOZAMBIQUE' AND nation0.n_name = 'PERU' OR nation.n_name = 'PERU' AND nation0.n_name = 'MOZAMBIQUE') GROUP BY nation.n_name, nation0.n_name, EXTRACT(YEAR FROM t.l_shipdate) ORDER BY nation.n_name, nation0.n_name, EXTRACT(YEAR FROM t.l_shipdate)","['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_MERGE', 'AGGREGATE_PROJECT_MERGE', 'SORT_REMOVE_CONSTANT_KEYS']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#54' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 6 and l_quantity <= 6 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#14' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 13 and l_quantity <= 13 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#14' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 30 and l_quantity <= 30 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'JOIN_RIGHT_INSTANCE', 'FILTER_INSTANCE', 'CALC_REMOVE', 'PROJECT_REMOVE', 'AGGREGATE_PROJECT_MERGE']""]"
234,tpch,"select o_year, sum(case when nation = 'PERU' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM BRUSHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t5.o_orderdate) AS o_year, SUM(CASE WHEN t5.n_name0 = 'PERU' THEN t5.l_extendedprice * (1 - t5.l_discount) ELSE 0 END) / SUM(t5.l_extendedprice * (1 - t5.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'MEDIUM BRUSHED NICKEL') AS t, supplier, lineitem WHERE t.p_partkey = lineitem.l_partkey AND supplier.s_suppkey = lineitem.l_suppkey) AS t0, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t1 WHERE t0.l_orderkey = t1.o_orderkey) AS t2, customer WHERE t2.o_custkey = customer.c_custkey) AS t3, nation WHERE t3.c_nationkey = nation.n_nationkey) AS t4, nation AS nation0 WHERE t4.s_nationkey = nation0.n_nationkey) AS t5, (SELECT * FROM region WHERE r_name = 'AMERICA') AS t6 WHERE t5.n_regionkey = t6.r_regionkey GROUP BY EXTRACT(YEAR FROM t5.o_orderdate) ORDER BY EXTRACT(YEAR FROM t5.o_orderdate)","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE']","[""select o_year, sum(case when nation = 'VIETNAM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM POLISHED COPPER' ) as all_nations group by o_year order by o_year;""]","[""['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_TO_CALC', 'FILTER_INTO_JOIN']""]"
235,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%lemon%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation.n_name AS nation, EXTRACT(YEAR FROM t2.o_orderdate) AS o_year, SUM(t2.l_extendedprice * (1 - t2.l_discount) - t2.ps_supplycost * t2.l_quantity) AS sum_profit FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_name LIKE '%lemon%') AS t, supplier, lineitem WHERE supplier.s_suppkey = lineitem.l_suppkey AND t.p_partkey = lineitem.l_partkey) AS t0, partsupp WHERE partsupp.ps_suppkey = t0.l_suppkey AND partsupp.ps_partkey = t0.l_partkey) AS t1, orders WHERE orders.o_orderkey = t1.l_orderkey) AS t2, nation WHERE t2.s_nationkey = nation.n_nationkey GROUP BY nation.n_name, EXTRACT(YEAR FROM t2.o_orderdate) ORDER BY nation.n_name, EXTRACT(YEAR FROM t2.o_orderdate) DESC","['FILTER_SCAN', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_PROJECT_TRANSPOSE', 'JOIN_LEFT_UNION_TRANSPOSE', 'JOIN_RIGHT_UNION_TRANSPOSE', 'FILTER_MERGE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'JOIN_EXTRACT_FILTER', 'PROJECT_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE', 'SORT_REMOVE_CONSTANT_KEYS']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#15' and p_type not like 'ECONOMY POLISHED%' and p_size in (3, 24, 9, 12, 17, 40, 23, 27) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_SCAN', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_PROJECT_TRANSPOSE', 'JOIN_LEFT_UNION_TRANSPOSE', 'JOIN_RIGHT_UNION_TRANSPOSE', 'FILTER_MERGE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'JOIN_EXTRACT_FILTER', 'PROJECT_TO_CALC', 'PROJECT_REDUCE_EXPRESSIONS', 'CALC_REMOVE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE', 'UNION_REMOVE']""]"
236,tpch,"select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from customer, orders, lineitem, nation where c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate >= date '1994-07-01' and o_orderdate < date '1994-07-01' + interval '3' month and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc;","SELECT customer.c_custkey, customer.c_name, SUM(t0.l_extendedprice * (1 - t0.l_discount)) AS revenue, customer.c_acctbal, nation.n_name, customer.c_address, customer.c_phone, customer.c_comment FROM customer INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1994-07-01' AND o_orderdate < (DATE '1994-07-01' + INTERVAL '3' MONTH)) AS t ON customer.c_custkey = t.o_custkey INNER JOIN (SELECT * FROM lineitem WHERE l_returnflag = 'R') AS t0 ON t.o_orderkey = t0.l_orderkey INNER JOIN nation ON customer.c_nationkey = nation.n_nationkey GROUP BY customer.c_custkey, customer.c_name, customer.c_acctbal, customer.c_phone, nation.n_name, customer.c_address, customer.c_comment ORDER BY SUM(t0.l_extendedprice * (1 - t0.l_discount)) DESC","['FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_INTO_JOIN', 'FILTER_MERGE', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_SCAN', 'JOIN_CONDITION_PUSH', 'JOIN_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'SORT_REMOVE_CONSTANT_KEYS', 'AGGREGATE_PROJECT_MERGE']","[""select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('RAIL', 'TRUCK') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1997-01-01' and l_receiptdate < date '1997-01-01' + interval '1' year group by l_shipmode order by l_shipmode;""]","[""['FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_INTO_JOIN', 'FILTER_MERGE', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_SCAN', 'JOIN_CONDITION_PUSH', 'JOIN_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'SORT_REMOVE', 'UNION_REMOVE', 'FILTER_INSTANCE', 'JOIN_LEFT_INSTANCE', 'JOIN_RIGHT_INSTANCE', 'SORT_INSTANCE', 'SORT_FETCH_ZERO_INSTANCE', 'UNION_INSTANCE']""]"
237,tpch,"select ps_partkey, sum(ps_supplycost * ps_availqty) as value from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'ARGENTINA' group by ps_partkey having sum(ps_supplycost * ps_availqty) > ( select sum(ps_supplycost * ps_availqty) * 0.0001000000 from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'ARGENTINA' ) order by value desc;","select ps_partkey, sum(ps_supplycost * ps_availqty) as value from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'ARGENTINA' group by ps_partkey having sum(ps_supplycost * ps_availqty) > ( select sum(ps_supplycost * ps_availqty) * 0.0001000000 from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'ARGENTINA' ) order by value desc",[],"[""select o_year, sum(case when nation = 'KENYA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE PLATED BRASS' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
238,tpch,"select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('SHIP', 'MAIL') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1994-01-01' and l_receiptdate < date '1994-01-01' + interval '1' year group by l_shipmode order by l_shipmode;","SELECT t.l_shipmode, SUM(CASE WHEN orders.o_orderpriority = '1-URGENT' OR orders.o_orderpriority = '2-HIGH' THEN 1 ELSE 0 END) AS high_line_count, SUM(CASE WHEN orders.o_orderpriority <> '1-URGENT' AND orders.o_orderpriority <> '2-HIGH' THEN 1 ELSE 0 END) AS low_line_count FROM orders, (SELECT * FROM lineitem WHERE l_shipmode IN ('MAIL', 'SHIP') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= DATE '1994-01-01' AND l_receiptdate < (DATE '1994-01-01' + INTERVAL '1' YEAR)) AS t WHERE orders.o_orderkey = t.l_orderkey GROUP BY t.l_shipmode ORDER BY t.l_shipmode","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_REDUCE_EXPRESSIONS']","[""select o_year, sum(case when nation = 'JORDAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD BURNISHED NICKEL' ) as all_nations group by o_year order by o_year;""]","[""['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_TO_CALC', 'FILTER_INTO_JOIN']""]"
239,tpch,"select c_count, count(*) as custdist from ( select c_custkey, count(o_orderkey) from customer left outer join orders on c_custkey = o_custkey and o_comment not like '%express%deposits%' group by c_custkey ) as c_orders (c_custkey, c_count) group by c_count order by custdist desc, c_count desc;","SELECT t0.EXPR1, COUNT(*) AS custdist FROM (SELECT customer.c_custkey, COUNT(t.o_orderkey) AS EXPR1 FROM customer LEFT JOIN (SELECT * FROM orders WHERE o_comment NOT LIKE '%express%deposits%') AS t ON customer.c_custkey = t.o_custkey GROUP BY customer.c_custkey) AS t0 GROUP BY t0.EXPR1 ORDER BY COUNT(*) DESC, t0.EXPR1 DESC","['FILTER_INTO_JOIN', 'FILTER_SCAN', 'JOIN_EXTRACT_FILTER', 'FILTER_REDUCE_EXPRESSIONS', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'AGGREGATE_UNION_TRANSPOSE', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'JOIN_CONDITION_PUSH', 'AGGREGATE_PROJECT_MERGE', 'FILTER_AGGREGATE_TRANSPOSE']","[""select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'FURNITURE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-31' and l_shipdate > date '1995-03-31' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;""]","[""['FILTER_INTO_JOIN', 'FILTER_SCAN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'FILTER_SCAN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'FILTER_SCAN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'FILTER_SCAN', 'JOIN_EXTRACT_FILTER', 'FILTER_MERGE', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_MERGE', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_MERGE', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_MERGE', 'FILTER_REDUCE_EXPRESSIONS', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'AGGREGATE_UNION_TRANSPOSE', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'JOIN_CONDITION_PUSH', 'AGGREGATE_PROJECT_MERGE', 'FILTER_AGGREGATE_TRANSPOSE']""]"
240,tpch,"select 100.00 * sum(case when p_type like 'PROMO%' then l_extendedprice * (1 - l_discount) else 0 end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from lineitem, part where l_partkey = p_partkey and l_shipdate >= date '1997-06-01' and l_shipdate < date '1997-06-01' + interval '1' month;","select 100.00 * sum(case when p_type like 'PROMO%' then l_extendedprice * (1 - l_discount) else 0 end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from lineitem, part where l_partkey = p_partkey and l_shipdate >= date '1997-06-01' and l_shipdate < date '1997-06-01' + interval '1' month",[],"[""select o_year, sum(case when nation = 'VIETNAM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL BRUSHED STEEL' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
241,tpch,"select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#23' and p_type not like 'ECONOMY BURNISHED%' and p_size in (31, 28, 7, 41, 16, 37, 26, 49) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;","SELECT t6.p_brand, t6.p_type, t6.p_size, COUNT(t6.ps_suppkey) AS supplier_cnt FROM (SELECT t0.p_brand, t0.p_type, t0.p_size, t0.ps_suppkey FROM (SELECT * FROM (SELECT partsupp.ps_partkey, partsupp.ps_suppkey, partsupp.ps_availqty, partsupp.ps_supplycost, partsupp.ps_comment, part.p_partkey, part.p_name, part.p_mfgr, part.p_brand, part.p_type, part.p_size, part.p_container, part.p_retailprice, part.p_comment, partsupp.ps_suppkey AS ps_suppkey0 FROM partsupp, part) AS t WHERE t.p_partkey = t.ps_partkey AND CAST(t.p_brand AS CHAR(8)) <> 'Brand#23' AND t.p_size IN (7, 16, 26, 28, 31, 37, 41, 49) AND t.p_type NOT LIKE 'ECONOMY BURNISHED%') AS t0 LEFT JOIN (SELECT s_suppkey, MIN(TRUE) AS f1 FROM supplier WHERE s_comment LIKE '%Customer%Complaints%' GROUP BY s_suppkey) AS t3 ON t0.ps_suppkey0 = t3.s_suppkey WHERE t3.f1 IS NOT TRUE GROUP BY t0.p_brand, t0.p_type, t0.p_size, t0.ps_suppkey) AS t6 GROUP BY t6.p_brand, t6.p_type, t6.p_size ORDER BY COUNT(t6.ps_suppkey) DESC, t6.p_brand, t6.p_type, t6.p_size","['FILTER_INTO_JOIN', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'SORT_JOIN_TRANSPOSE']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#21' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 9 and l_quantity <= 9 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#54' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 15 and l_quantity <= 15 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#24' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 28 and l_quantity <= 28 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_INTO_JOIN', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_REMOVE']""]"
242,tpch,"select sum(l_extendedprice) / 7.0 as avg_yearly from lineitem, part where p_partkey = l_partkey and p_brand = 'Brand#34' and p_container = 'JUMBO CASE' and l_quantity < ( select 0.2 * avg(l_quantity) from lineitem where l_partkey = p_partkey );","select sum(l_extendedprice) / 7.0 as avg_yearly from lineitem, part where p_partkey = l_partkey and p_brand = 'Brand#34' and p_container = 'JUMBO CASE' and l_quantity < ( select 0.2 * avg(l_quantity) from lineitem where l_partkey = p_partkey )",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('23', '20', '36', '21', '31', '43', '27') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('23', '20', '36', '21', '31', '43', '27') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
243,tpch,"select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#43' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 5 and l_quantity <= 5 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#15' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 20 and l_quantity <= 20 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#24' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 23 and l_quantity <= 23 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );","SELECT SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS revenue FROM lineitem, part WHERE part.p_partkey = lineitem.l_partkey AND part.p_brand = 'Brand#43' AND (part.p_container IN ('SM BOX', 'SM CASE', 'SM PACK', 'SM PKG') AND lineitem.l_quantity >= 5) AND (lineitem.l_quantity <= 5 + 10 AND (part.p_size >= 1 AND part.p_size <= 5) AND (lineitem.l_shipmode IN ('AIR', 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON')) OR part.p_partkey = lineitem.l_partkey AND part.p_brand = 'Brand#15' AND (part.p_container IN ('MED BAG', 'MED BOX', 'MED PACK', 'MED PKG') AND lineitem.l_quantity >= 20) AND (lineitem.l_quantity <= 20 + 10 AND (part.p_size >= 1 AND part.p_size <= 10) AND (lineitem.l_shipmode IN ('AIR', 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON')) OR part.p_partkey = lineitem.l_partkey AND part.p_brand = 'Brand#24' AND (part.p_container IN ('LG BOX', 'LG CASE', 'LG PACK', 'LG PKG') AND lineitem.l_quantity >= 23) AND (lineitem.l_quantity <= 23 + 10 AND (part.p_size >= 1 AND part.p_size <= 15) AND (lineitem.l_shipmode IN ('AIR', 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))","['AGGREGATE_ANY_PULL_UP_CONSTANTS', 'FILTER_MERGE', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_REDUCE_EXPRESSIONS']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#52' and p_type not like 'SMALL ANODIZED%' and p_size in (14, 31, 27, 10, 2, 47, 46, 7) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_ANY_PULL_UP_CONSTANTS', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'AGGREGATE_PROJECT_MERGE', 'FILTER_CORRELATE', 'FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'JOIN_REDUCE_EXPRESSIONS', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS']""]"
244,tpch,"select s_name, s_address from supplier, nation where s_suppkey in ( select ps_suppkey from partsupp where ps_partkey in ( select p_partkey from part where p_name like 'metallic%' ) and ps_availqty > ( select 0.5 * sum(l_quantity) from lineitem where l_partkey = ps_partkey and l_suppkey = ps_suppkey and l_shipdate >= date '1993-01-01' and l_shipdate < date '1993-01-01' + interval '1' year ) ) and s_nationkey = n_nationkey and n_name = 'SAUDI ARABIA' order by s_name;","SELECT supplier.s_name, supplier.s_address FROM supplier INNER JOIN (SELECT * FROM nation WHERE n_name = 'SAUDI ARABIA') AS t ON supplier.s_nationkey = t.n_nationkey INNER JOIN (SELECT partsupp.ps_suppkey FROM partsupp INNER JOIN (SELECT p_partkey FROM part WHERE p_name LIKE 'metallic%' GROUP BY p_partkey) AS t2 ON partsupp.ps_partkey = t2.p_partkey INNER JOIN (SELECT l_partkey, l_suppkey, SUM(l_quantity) AS f2 FROM lineitem WHERE l_shipdate >= DATE '1993-01-01' AND l_shipdate < (DATE '1993-01-01' + INTERVAL '1' YEAR) GROUP BY l_partkey, l_suppkey) AS t5 ON partsupp.ps_partkey = t5.l_partkey AND partsupp.ps_suppkey = t5.l_suppkey AND partsupp.ps_availqty > 0.5 * t5.f2 GROUP BY partsupp.ps_suppkey) AS t8 ON supplier.s_suppkey = t8.ps_suppkey ORDER BY supplier.s_name","['FILTER_INTO_JOIN', 'FILTER_MERGE', 'JOIN_CONDITION_PUSH']","[""select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'ETHIOPIA' and n2.n_name = 'GERMANY') or (n1.n_name = 'GERMANY' and n2.n_name = 'ETHIOPIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;""]","[""['FILTER_INTO_JOIN']""]"
245,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'BRAZIL' group by s_name order by numwait desc, s_name;","select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'BRAZIL' group by s_name order by numwait desc, s_name",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 3 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
246,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('40', '26', '37', '32', '44', '31', '34') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('40', '26', '37', '32', '44', '31', '34') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('40', '26', '37', '32', '44', '31', '34') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('40', '26', '37', '32', '44', '31', '34') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 26 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
247,tpch,"select l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order from lineitem where l_shipdate <= date '1998-12-01' - interval '75' day (3) group by l_returnflag, l_linestatus order by l_returnflag, l_linestatus;","SELECT l_returnflag, l_linestatus, SUM(l_quantity) AS sum_qty, SUM(l_extendedprice) AS sum_base_price, SUM(l_extendedprice * (1 - l_discount)) AS sum_disc_price, SUM(l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS sum_charge, AVG(l_quantity) AS avg_qty, AVG(l_extendedprice) AS avg_price, AVG(l_discount) AS avg_disc, COUNT(*) AS count_order FROM lineitem WHERE l_shipdate <= (DATE '1998-12-01' - INTERVAL '75' DAY(3)) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus","['AGGREGATE_PROJECT_MERGE', 'FILTER_AGGREGATE_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#12' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 7 and l_quantity <= 7 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#51' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 17 and l_quantity <= 17 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#41' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 25 and l_quantity <= 25 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['AGGREGATE_PROJECT_MERGE', 'FILTER_INTO_JOIN', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'SORT_REMOVE', 'JOIN_CONDITION_PUSH', 'FILTER_AGGREGATE_TRANSPOSE']""]"
248,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 12 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t5.s_acctbal, t5.s_name, t5.n_name, t5.p_partkey, t5.p_mfgr, t5.s_address, t5.s_phone, t5.s_comment FROM (SELECT t.p_partkey, t.p_name, t.p_mfgr, t.p_brand, t.p_type, t.p_size, t.p_container, t.p_retailprice, t.p_comment, supplier.s_suppkey, supplier.s_name, supplier.s_address, supplier.s_nationkey, supplier.s_phone, supplier.s_acctbal, supplier.s_comment, partsupp.ps_partkey, partsupp.ps_suppkey, partsupp.ps_availqty, partsupp.ps_supplycost, partsupp.ps_comment, nation.n_nationkey, nation.n_name, nation.n_regionkey, nation.n_comment, t0.r_regionkey, t0.r_name, t0.r_comment, CAST(t3.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t3.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 12 AND p_type LIKE '%NICKEL') AS t CROSS JOIN supplier INNER JOIN partsupp ON t.p_partkey = partsupp.ps_partkey AND supplier.s_suppkey = partsupp.ps_suppkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t0 ON nation.n_regionkey = t0.r_regionkey INNER JOIN (SELECT partsupp0.ps_partkey, MIN(partsupp0.ps_supplycost) AS EXPR0 FROM partsupp AS partsupp0 INNER JOIN supplier AS supplier0 ON partsupp0.ps_suppkey = supplier0.s_suppkey INNER JOIN nation AS nation0 ON supplier0.s_nationkey = nation0.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1 ON nation0.n_regionkey = t1.r_regionkey GROUP BY partsupp0.ps_partkey) AS t3 ON t.p_partkey = t3.ps_partkey AND partsupp.ps_supplycost = t3.EXPR0 ORDER BY supplier.s_acctbal DESC, nation.n_name, supplier.s_name, t.p_partkey) AS t5","['FILTER_SCAN', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'FILTER_MULTI_JOIN_MERGE', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_MERGE', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH', 'JOIN_LEFT_UNION_TRANSPOSE', 'JOIN_RIGHT_UNION_TRANSPOSE', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'JOIN_PROJECT_LEFT_TRANSPOSE', 'JOIN_PROJECT_RIGHT_TRANSPOSE', 'SEMI_JOIN_REMOVE', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'SORT_UNION_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE']","[""select o_year, sum(case when nation = 'JAPAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD PLATED BRASS' ) as all_nations group by o_year order by o_year;""]","[""['FILTER_SCAN', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'FILTER_MULTI_JOIN_MERGE', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_MERGE', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH', 'JOIN_LEFT_UNION_TRANSPOSE', 'JOIN_RIGHT_UNION_TRANSPOSE', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'JOIN_PROJECT_LEFT_TRANSPOSE', 'JOIN_PROJECT_RIGHT_TRANSPOSE', 'SEMI_JOIN_REMOVE', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'SORT_UNION_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE', 'UNION_MERGE', 'UNION_REMOVE', 'UNION_TO_DISTINCT', 'MINUS_INSTANCE', 'AGGREGATE_INSTANCE']""]"
249,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'BUILDING' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-10' and l_shipdate > date '1995-03-10' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'BUILDING' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-10' and l_shipdate > date '1995-03-10' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('24', '39', '32', '34', '42', '25', '29') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('24', '39', '32', '34', '42', '25', '29') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
250,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1994-08-01' and o_orderdate < date '1994-08-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","SELECT t.o_orderpriority, COUNT(*) AS order_count FROM (SELECT * FROM orders WHERE o_orderdate >= DATE '1994-08-01' AND o_orderdate < (DATE '1994-08-01' + INTERVAL '3' MONTH)) AS t INNER JOIN (SELECT l_orderkey, MIN(TRUE) AS f1 FROM lineitem WHERE l_commitdate < l_receiptdate GROUP BY l_orderkey) AS t2 ON t.o_orderkey = t2.l_orderkey GROUP BY t.o_orderpriority ORDER BY t.o_orderpriority","['JOIN_CONDITION_PUSH', 'JOIN_REDUCE_EXPRESSIONS', 'FILTER_AGGREGATE_TRANSPOSE', 'FILTER_CORRELATE', 'FILTER_MERGE', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE']","[""select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1993-09-01' and o_orderdate < date '1993-09-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;""]","[""['JOIN_CONDITION_PUSH', 'JOIN_REDUCE_EXPRESSIONS', 'FILTER_AGGREGATE_TRANSPOSE', 'FILTER_CORRELATE', 'FILTER_MERGE', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE']""]"
251,tpch,"select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and o_orderdate >= date '1997-01-01' and o_orderdate < date '1997-01-01' + interval '1' year group by n_name order by revenue desc;","select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and o_orderdate >= date '1997-01-01' and o_orderdate < date '1997-01-01' + interval '1' year group by n_name order by revenue desc",[],"[""select o_year, sum(case when nation = 'CANADA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE PLATED TIN' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
252,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'CANADA' and n2.n_name = 'EGYPT') or (n1.n_name = 'EGYPT' and n2.n_name = 'CANADA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'CANADA' and n2.n_name = 'EGYPT') or (n1.n_name = 'EGYPT' and n2.n_name = 'CANADA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year",[],"[""select o_year, sum(case when nation = 'JAPAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD PLATED BRASS' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
253,tpch,"select o_year, sum(case when nation = 'EGYPT' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM BURNISHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t0.o_orderdate) AS o_year, SUM(CASE WHEN nation0.n_name = 'EGYPT' THEN lineitem.l_extendedprice * (1 - lineitem.l_discount) ELSE 0 END) / SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'MEDIUM BURNISHED STEEL') AS t CROSS JOIN supplier INNER JOIN lineitem ON t.p_partkey = lineitem.l_partkey AND supplier.s_suppkey = lineitem.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t0 ON lineitem.l_orderkey = t0.o_orderkey INNER JOIN customer ON t0.o_custkey = customer.c_custkey INNER JOIN nation ON customer.c_nationkey = nation.n_nationkey INNER JOIN nation AS nation0 ON supplier.s_nationkey = nation0.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1 ON nation.n_regionkey = t1.r_regionkey GROUP BY EXTRACT(YEAR FROM t0.o_orderdate) ORDER BY EXTRACT(YEAR FROM t0.o_orderdate)","['FILTER_INTO_JOIN', 'FILTER_AGGREGATE_TRANSPOSE', 'PROJECT_REDUCE_EXPRESSIONS', 'AGGREGATE_ANY_PULL_UP_CONSTANTS']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#35' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 3 and l_quantity <= 3 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#51' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 20 and l_quantity <= 20 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#12' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 22 and l_quantity <= 22 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_MERGE', 'FILTER_INTO_JOIN', 'FILTER_AGGREGATE_TRANSPOSE', 'PROJECT_REDUCE_EXPRESSIONS', 'AGGREGATE_ANY_PULL_UP_CONSTANTS']""]"
254,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%honeydew%' ) as profit group by nation, o_year order by nation, o_year desc;","select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%honeydew%' ) as profit group by nation, o_year order by nation, o_year desc",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('29', '41', '36', '21', '43', '24', '32') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('29', '41', '36', '21', '43', '24', '32') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
255,tpch,"select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('AIR', 'RAIL') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1993-01-01' and l_receiptdate < date '1993-01-01' + interval '1' year group by l_shipmode order by l_shipmode;","select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('AIR', 'RAIL') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1993-01-01' and l_receiptdate < date '1993-01-01' + interval '1' year group by l_shipmode order by l_shipmode",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('27', '43', '29', '25', '35', '22', '21') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('27', '43', '29', '25', '35', '22', '21') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
256,tpch,"select 100.00 * sum(case when p_type like 'PROMO%' then l_extendedprice * (1 - l_discount) else 0 end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from lineitem, part where l_partkey = p_partkey and l_shipdate >= date '1993-09-01' and l_shipdate < date '1993-09-01' + interval '1' month;","SELECT 100.00 * SUM(CASE WHEN part.p_type LIKE 'PROMO%' THEN lineitem.l_extendedprice * (1 - lineitem.l_discount) ELSE 0 END) / SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS promo_revenue FROM lineitem, part WHERE lineitem.l_partkey = part.p_partkey AND lineitem.l_shipdate >= DATE '1993-09-01' AND lineitem.l_shipdate < (DATE '1993-09-01' + INTERVAL '1' MONTH)","['FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE', 'PROJECT_REDUCE_EXPRESSIONS']","[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 28 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_MERGE', 'FILTER_PROJECT_TRANSPOSE', 'JOIN_CONDITION_PUSH', 'JOIN_REDUCE_EXPRESSIONS', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE', 'PROJECT_REDUCE_EXPRESSIONS']""]"
257,tpch,"select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#52' and p_type not like 'MEDIUM ANODIZED%' and p_size in (34, 36, 25, 30, 15, 44, 10, 37) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;","select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#52' and p_type not like 'MEDIUM ANODIZED%' and p_size in (34, 36, 25, 30, 15, 44, 10, 37) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size",[],"[""select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%lime%' ) as profit group by nation, o_year order by nation, o_year desc;""]","[""['Empty List']""]"
258,tpch,"select sum(l_extendedprice) / 7.0 as avg_yearly from lineitem, part where p_partkey = l_partkey and p_brand = 'Brand#22' and p_container = 'JUMBO BAG' and l_quantity < ( select 0.2 * avg(l_quantity) from lineitem where l_partkey = p_partkey );","SELECT SUM(lineitem.l_extendedprice) / 7.0 AS avg_yearly FROM lineitem INNER JOIN (SELECT * FROM part WHERE p_brand = 'Brand#22' AND p_container = 'JUMBO BAG') AS t ON lineitem.l_partkey = t.p_partkey INNER JOIN (SELECT l_partkey, AVG(l_quantity) AS f1 FROM lineitem GROUP BY l_partkey) AS t0 ON t.p_partkey = t0.l_partkey AND lineitem.l_quantity < 0.2 * t0.f1","['FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH', 'FILTER_MERGE', 'FILTER_INTO_JOIN', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_ANY_PULL_UP_CONSTANTS', 'PROJECT_REDUCE_EXPRESSIONS']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#13' and p_type not like 'STANDARD ANODIZED%' and p_size in (47, 34, 49, 20, 15, 44, 1, 41) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH', 'FILTER_MERGE', 'FILTER_INTO_JOIN', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'PROJECT_REDUCE_EXPRESSIONS', 'SORT_REMOVE']""]"
259,tpch,"select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#44' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 1 and l_quantity <= 1 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#33' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 17 and l_quantity <= 17 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#25' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 21 and l_quantity <= 21 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );","select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#44' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 1 and l_quantity <= 1 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#33' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 17 and l_quantity <= 17 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#25' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 21 and l_quantity <= 21 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' )",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 3 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
260,tpch,"select s_name, s_address from supplier, nation where s_suppkey in ( select ps_suppkey from partsupp where ps_partkey in ( select p_partkey from part where p_name like 'pink%' ) and ps_availqty > ( select 0.5 * sum(l_quantity) from lineitem where l_partkey = ps_partkey and l_suppkey = ps_suppkey and l_shipdate >= date '1995-01-01' and l_shipdate < date '1995-01-01' + interval '1' year ) ) and s_nationkey = n_nationkey and n_name = 'JORDAN' order by s_name;","SELECT supplier.s_name, supplier.s_address FROM supplier INNER JOIN (SELECT * FROM nation WHERE n_name = 'JORDAN') AS t ON supplier.s_nationkey = t.n_nationkey INNER JOIN (SELECT partsupp.ps_suppkey FROM partsupp INNER JOIN (SELECT p_partkey FROM part WHERE p_name LIKE 'pink%' GROUP BY p_partkey) AS t2 ON partsupp.ps_partkey = t2.p_partkey INNER JOIN (SELECT l_partkey, l_suppkey, SUM(l_quantity) AS f2 FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate < (DATE '1995-01-01' + INTERVAL '1' YEAR) GROUP BY l_partkey, l_suppkey) AS t5 ON partsupp.ps_partkey = t5.l_partkey AND partsupp.ps_suppkey = t5.l_suppkey AND partsupp.ps_availqty > 0.5 * t5.f2 GROUP BY partsupp.ps_suppkey) AS t8 ON supplier.s_suppkey = t8.ps_suppkey ORDER BY supplier.s_name","['FILTER_SCAN', 'FILTER_PROJECT_TRANSPOSE', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'FILTER_INTO_JOIN', 'FILTER_MERGE']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#42' and p_type not like 'LARGE BRUSHED%' and p_size in (50, 42, 19, 8, 14, 6, 31, 29) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_SCAN', 'FILTER_PROJECT_TRANSPOSE', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_UNION_AGGREGATE']""]"
261,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('33', '26', '41', '24', '38', '28', '23') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('33', '26', '41', '24', '38', '28', '23') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('33', '26', '41', '24', '38', '28', '23') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('33', '26', '41', '24', '38', '28', '23') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode",[],"[""select o_year, sum(case when nation = 'JAPAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL BURNISHED STEEL' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
262,tpch,"select l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order from lineitem where l_shipdate <= date '1998-12-01' - interval '99' day (3) group by l_returnflag, l_linestatus order by l_returnflag, l_linestatus;","SELECT l_returnflag, l_linestatus, SUM(l_quantity) AS sum_qty, SUM(l_extendedprice) AS sum_base_price, SUM(l_extendedprice * (1 - l_discount)) AS sum_disc_price, SUM(l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS sum_charge, AVG(l_quantity) AS avg_qty, AVG(l_extendedprice) AS avg_price, AVG(l_discount) AS avg_disc, COUNT(*) AS count_order FROM lineitem WHERE l_shipdate <= (DATE '1998-12-01' - INTERVAL '99' DAY(3)) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus","['FILTER_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#23' and p_type not like 'LARGE POLISHED%' and p_size in (31, 12, 29, 39, 11, 30, 21, 13) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'FILTER_MERGE', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_CORRELATE_TRANSPOSE', 'PROJECT_REDUCE_EXPRESSIONS', 'JOIN_EXTRACT_FILTER', 'SORT_JOIN_TRANSPOSE']""]"
263,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 39 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT supplier.s_acctbal, supplier.s_name, nation.n_name, t.p_partkey, t.p_mfgr, supplier.s_address, supplier.s_phone, supplier.s_comment FROM (SELECT * FROM part WHERE p_size = 39 AND p_type LIKE '%COPPER') AS t CROSS JOIN supplier INNER JOIN partsupp ON t.p_partkey = partsupp.ps_partkey AND supplier.s_suppkey = partsupp.ps_suppkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t0 ON nation.n_regionkey = t0.r_regionkey INNER JOIN (SELECT partsupp0.ps_partkey, MIN(partsupp0.ps_supplycost) AS EXPR0 FROM partsupp AS partsupp0 INNER JOIN supplier AS supplier0 ON partsupp0.ps_suppkey = supplier0.s_suppkey INNER JOIN nation AS nation0 ON supplier0.s_nationkey = nation0.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1 ON nation0.n_regionkey = t1.r_regionkey GROUP BY partsupp0.ps_partkey) AS t3 ON t.p_partkey = t3.ps_partkey AND partsupp.ps_supplycost = t3.EXPR0 ORDER BY supplier.s_acctbal DESC, nation.n_name, supplier.s_name, t.p_partkey","['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'PROJECT_REDUCE_EXPRESSIONS']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#24' and p_type not like 'SMALL PLATED%' and p_size in (47, 24, 44, 3, 9, 1, 35, 6) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_INTO_JOIN', 'PROJECT_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH', 'FILTER_AGGREGATE_TRANSPOSE']""]"
264,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'BUILDING' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-12' and l_shipdate > date '1995-03-12' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'BUILDING' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-12' and l_shipdate > date '1995-03-12' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 22 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
265,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1994-12-01' and o_orderdate < date '1994-12-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","SELECT t.o_orderpriority, COUNT(*) AS order_count FROM (SELECT * FROM orders WHERE o_orderdate >= DATE '1994-12-01' AND o_orderdate < (DATE '1994-12-01' + INTERVAL '3' MONTH)) AS t INNER JOIN (SELECT l_orderkey, MIN(TRUE) AS f1 FROM lineitem WHERE l_commitdate < l_receiptdate GROUP BY l_orderkey) AS t2 ON t.o_orderkey = t2.l_orderkey GROUP BY t.o_orderpriority ORDER BY t.o_orderpriority","['FILTER_SCAN', 'FILTER_MERGE', 'FILTER_AGGREGATE_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE']","[""select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('RAIL', 'MAIL') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1996-01-01' and l_receiptdate < date '1996-01-01' + interval '1' year group by l_shipmode order by l_shipmode;""]","[""['FILTER_SCAN', 'FILTER_MERGE', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_INTO_JOIN', 'JOIN_REDUCE_EXPRESSIONS', 'FILTER_AGGREGATE_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_UNION_AGGREGATE', 'AGGREGATE_REMOVE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE']""]"
266,tpch,select sum(l_extendedprice * l_discount) as revenue from lineitem where l_shipdate >= date '1996-01-01' and l_shipdate < date '1996-01-01' + interval '1' year and l_discount between 0.09 - 0.01 and 0.09 + 0.01 and l_quantity < 24;,select sum(l_extendedprice * l_discount) as revenue from lineitem where l_shipdate >= date '1996-01-01' and l_shipdate < date '1996-01-01' + interval '1' year and l_discount between 0.09 - 0.01 and 0.09 + 0.01 and l_quantity < 24,[],"[""select o_year, sum(case when nation = 'ETHIOPIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO BURNISHED TIN' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
267,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'UNITED STATES' and n2.n_name = 'BRAZIL') or (n1.n_name = 'BRAZIL' and n2.n_name = 'UNITED STATES') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'UNITED STATES' and n2.n_name = 'BRAZIL') or (n1.n_name = 'BRAZIL' and n2.n_name = 'UNITED STATES') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year",[],"[""select o_year, sum(case when nation = 'JAPAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY PLATED COPPER' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
268,tpch,"select o_year, sum(case when nation = 'BRAZIL' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL BRUSHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t0.o_orderdate) AS o_year, SUM(CASE WHEN nation0.n_name = 'BRAZIL' THEN lineitem.l_extendedprice * (1 - lineitem.l_discount) ELSE 0 END) / SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'SMALL BRUSHED TIN') AS t CROSS JOIN supplier INNER JOIN lineitem ON t.p_partkey = lineitem.l_partkey AND supplier.s_suppkey = lineitem.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t0 ON lineitem.l_orderkey = t0.o_orderkey INNER JOIN customer ON t0.o_custkey = customer.c_custkey INNER JOIN nation ON customer.c_nationkey = nation.n_nationkey INNER JOIN nation AS nation0 ON supplier.s_nationkey = nation0.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1 ON nation.n_regionkey = t1.r_regionkey GROUP BY EXTRACT(YEAR FROM t0.o_orderdate) ORDER BY EXTRACT(YEAR FROM t0.o_orderdate)","['FILTER_INTO_JOIN', 'FILTER_AGGREGATE_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE', 'JOIN_CONDITION_PUSH', 'FILTER_PROJECT_TRANSPOSE']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#21' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 5 and l_quantity <= 5 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#21' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 12 and l_quantity <= 12 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#41' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 29 and l_quantity <= 29 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_AGGREGATE_TRANSPOSE', 'FILTER_INTO_JOIN', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_SCAN']""]"
269,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%floral%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation.n_name AS nation, EXTRACT(YEAR FROM orders.o_orderdate) AS o_year, SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount) - partsupp.ps_supplycost * lineitem.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%floral%') AS t CROSS JOIN supplier INNER JOIN lineitem ON supplier.s_suppkey = lineitem.l_suppkey AND t.p_partkey = lineitem.l_partkey INNER JOIN partsupp ON lineitem.l_suppkey = partsupp.ps_suppkey AND lineitem.l_partkey = partsupp.ps_partkey INNER JOIN orders ON lineitem.l_orderkey = orders.o_orderkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey GROUP BY nation.n_name, EXTRACT(YEAR FROM orders.o_orderdate) ORDER BY nation.n_name, EXTRACT(YEAR FROM orders.o_orderdate) DESC","['FILTER_INTO_JOIN', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'PROJECT_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE', 'SORT_PROJECT_TRANSPOSE']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#35' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 3 and l_quantity <= 3 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#24' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 13 and l_quantity <= 13 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#52' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 27 and l_quantity <= 27 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_INTO_JOIN', 'FILTER_PROJECT_TRANSPOSE', 'JOIN_LEFT_UNION_TRANSPOSE', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'PROJECT_REMOVE', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_REMOVE']""]"
270,tpch,"select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('AIR', 'RAIL') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1995-01-01' and l_receiptdate < date '1995-01-01' + interval '1' year group by l_shipmode order by l_shipmode;","select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('AIR', 'RAIL') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1995-01-01' and l_receiptdate < date '1995-01-01' + interval '1' year group by l_shipmode order by l_shipmode",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 34 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
271,tpch,"select c_count, count(*) as custdist from ( select c_custkey, count(o_orderkey) from customer left outer join orders on c_custkey = o_custkey and o_comment not like '%pending%requests%' group by c_custkey ) as c_orders (c_custkey, c_count) group by c_count order by custdist desc, c_count desc;","select c_count, count(*) as custdist from ( select c_custkey, count(o_orderkey) from customer left outer join orders on c_custkey = o_custkey and o_comment not like '%pending%requests%' group by c_custkey ) as c_orders (c_custkey, c_count) group by c_count order by custdist desc, c_count desc",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 46 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
272,tpch,"select 100.00 * sum(case when p_type like 'PROMO%' then l_extendedprice * (1 - l_discount) else 0 end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from lineitem, part where l_partkey = p_partkey and l_shipdate >= date '1995-06-01' and l_shipdate < date '1995-06-01' + interval '1' month;",SELECT 100.00 * SUM(CASE WHEN part.p_type LIKE 'PROMO%' THEN t.l_extendedprice * (1 - t.l_discount) ELSE 0 END) / SUM(t.l_extendedprice * (1 - t.l_discount)) AS promo_revenue FROM (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-06-01' AND l_shipdate < (DATE '1995-06-01' + INTERVAL '1' MONTH)) AS t INNER JOIN part ON t.l_partkey = part.p_partkey,"['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS']","[""select o_year, sum(case when nation = 'IRAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE BURNISHED TIN' ) as all_nations group by o_year order by o_year;""]","[""['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_PROJECT_MERGE', 'FILTER_AGGREGATE_TRANSPOSE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_MERGE', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS']""]"
273,tpch,"select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#51' and p_type not like 'PROMO PLATED%' and p_size in (6, 8, 2, 32, 11, 20, 42, 47) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;","select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#51' and p_type not like 'PROMO PLATED%' and p_size in (6, 8, 2, 32, 11, 20, 42, 47) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size",[],"[""select o_year, sum(case when nation = 'ALGERIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO ANODIZED BRASS' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
274,tpch,"select sum(l_extendedprice) / 7.0 as avg_yearly from lineitem, part where p_partkey = l_partkey and p_brand = 'Brand#15' and p_container = 'SM PACK' and l_quantity < ( select 0.2 * avg(l_quantity) from lineitem where l_partkey = p_partkey );","SELECT SUM(lineitem.l_extendedprice) / 7.0 AS avg_yearly FROM lineitem INNER JOIN (SELECT * FROM part WHERE p_brand = 'Brand#15' AND p_container = 'SM PACK') AS t ON lineitem.l_partkey = t.p_partkey INNER JOIN (SELECT l_partkey, AVG(l_quantity) AS f1 FROM lineitem GROUP BY l_partkey) AS t0 ON t.p_partkey = t0.l_partkey AND lineitem.l_quantity < 0.2 * t0.f1","['FILTER_PROJECT_TRANSPOSE', 'FILTER_INTO_JOIN', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'JOIN_CONDITION_PUSH', 'PROJECT_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#12' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 9 and l_quantity <= 9 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#55' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 20 and l_quantity <= 20 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#41' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 30 and l_quantity <= 30 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_PROJECT_TRANSPOSE', 'FILTER_INTO_JOIN', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'JOIN_CONDITION_PUSH', 'PROJECT_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES']""]"
275,tpch,"select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#11' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 8 and l_quantity <= 8 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#14' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 20 and l_quantity <= 20 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#12' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 22 and l_quantity <= 22 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );","select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#11' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 8 and l_quantity <= 8 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#14' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 20 and l_quantity <= 20 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#12' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 22 and l_quantity <= 22 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' )",[],"[""select o_year, sum(case when nation = 'CHINA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO BURNISHED COPPER' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
276,tpch,"select s_name, s_address from supplier, nation where s_suppkey in ( select ps_suppkey from partsupp where ps_partkey in ( select p_partkey from part where p_name like 'burnished%' ) and ps_availqty > ( select 0.5 * sum(l_quantity) from lineitem where l_partkey = ps_partkey and l_suppkey = ps_suppkey and l_shipdate >= date '1993-01-01' and l_shipdate < date '1993-01-01' + interval '1' year ) ) and s_nationkey = n_nationkey and n_name = 'MOROCCO' order by s_name;","select s_name, s_address from supplier, nation where s_suppkey in ( select ps_suppkey from partsupp where ps_partkey in ( select p_partkey from part where p_name like 'burnished%' ) and ps_availqty > ( select 0.5 * sum(l_quantity) from lineitem where l_partkey = ps_partkey and l_suppkey = ps_suppkey and l_shipdate >= date '1993-01-01' and l_shipdate < date '1993-01-01' + interval '1' year ) ) and s_nationkey = n_nationkey and n_name = 'MOROCCO' order by s_name",[],"[""select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%beige%' ) as profit group by nation, o_year order by nation, o_year desc;""]","[""['Empty List']""]"
277,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('35', '24', '29', '40', '43', '22', '39') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('35', '24', '29', '40', '43', '22', '39') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('35', '24', '29', '40', '43', '22', '39') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('35', '24', '29', '40', '43', '22', '39') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 4 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
278,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 36 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 36 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 17 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
279,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'HOUSEHOLD' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-31' and l_shipdate > date '1995-03-31' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t1.l_orderkey, SUM(t1.l_extendedprice * (1 - t1.l_discount)) AS revenue, t0.o_orderdate, t0.o_shippriority FROM (SELECT * FROM customer WHERE c_mktsegment = 'HOUSEHOLD') AS t INNER JOIN (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-31') AS t0 ON t.c_custkey = t0.o_custkey INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-31') AS t1 ON t0.o_orderkey = t1.l_orderkey GROUP BY t1.l_orderkey, t0.o_orderdate, t0.o_shippriority ORDER BY SUM(t1.l_extendedprice * (1 - t1.l_discount)) DESC, t0.o_orderdate","['FILTER_INTO_JOIN', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_MERGE', 'PROJECT_REDUCE_EXPRESSIONS', 'FILTER_REDUCE_EXPRESSIONS']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#35' and p_type not like 'SMALL PLATED%' and p_size in (39, 40, 21, 43, 29, 23, 18, 11) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'FILTER_INTO_JOIN', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_MERGE', 'PROJECT_REDUCE_EXPRESSIONS', 'FILTER_REDUCE_EXPRESSIONS', 'SORT_REMOVE', 'SORT_REMOVE_CONSTANT_KEYS']""]"
280,tpch,select sum(l_extendedprice * l_discount) as revenue from lineitem where l_shipdate >= date '1993-01-01' and l_shipdate < date '1993-01-01' + interval '1' year and l_discount between 0.08 - 0.01 and 0.08 + 0.01 and l_quantity < 25;,SELECT SUM(l_extendedprice * l_discount) AS revenue FROM lineitem WHERE l_shipdate >= DATE '1993-01-01' AND l_shipdate < (DATE '1993-01-01' + INTERVAL '1' YEAR) AND l_discount >= 0.08 - 0.01 AND l_discount <= 0.08 + 0.01 AND l_quantity < 25,"['FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#12' and p_type not like 'ECONOMY BRUSHED%' and p_size in (21, 3, 37, 13, 27, 26, 49, 1) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_INTO_JOIN', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'FILTER_MERGE', 'SORT_REMOVE_CONSTANT_KEYS']""]"
281,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'SAUDI ARABIA' and n2.n_name = 'UNITED KINGDOM') or (n1.n_name = 'UNITED KINGDOM' and n2.n_name = 'SAUDI ARABIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'SAUDI ARABIA' and n2.n_name = 'UNITED KINGDOM') or (n1.n_name = 'UNITED KINGDOM' and n2.n_name = 'SAUDI ARABIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('26', '37', '39', '28', '29', '22', '38') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('26', '37', '39', '28', '29', '22', '38') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
282,tpch,"select o_year, sum(case when nation = 'UNITED KINGDOM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD PLATED BRASS' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t5.o_orderdate) AS o_year, SUM(CASE WHEN t5.n_name0 = 'UNITED KINGDOM' THEN t5.l_extendedprice * (1 - t5.l_discount) ELSE 0 END) / SUM(t5.l_extendedprice * (1 - t5.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'STANDARD PLATED BRASS') AS t, supplier, lineitem WHERE t.p_partkey = lineitem.l_partkey AND supplier.s_suppkey = lineitem.l_suppkey) AS t0, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t1 WHERE t0.l_orderkey = t1.o_orderkey) AS t2, customer WHERE t2.o_custkey = customer.c_custkey) AS t3, nation WHERE t3.c_nationkey = nation.n_nationkey) AS t4, nation AS nation0 WHERE t4.s_nationkey = nation0.n_nationkey) AS t5, (SELECT * FROM region WHERE r_name = 'EUROPE') AS t6 WHERE t5.n_regionkey = t6.r_regionkey GROUP BY EXTRACT(YEAR FROM t5.o_orderdate) ORDER BY EXTRACT(YEAR FROM t5.o_orderdate)","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE']","[""select o_year, sum(case when nation = 'KENYA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY PLATED STEEL' ) as all_nations group by o_year order by o_year;""]","[""['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_TO_CALC', 'FILTER_INTO_JOIN']""]"
283,tpch,"select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from customer, orders, lineitem, nation where c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate >= date '1993-09-01' and o_orderdate < date '1993-09-01' + interval '3' month and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc;","SELECT customer.c_custkey, customer.c_name, SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS revenue, customer.c_acctbal, nation.n_name, customer.c_address, customer.c_phone, customer.c_comment FROM customer, orders, lineitem, nation WHERE customer.c_custkey = orders.o_custkey AND (lineitem.l_orderkey = orders.o_orderkey AND orders.o_orderdate >= DATE '1993-09-01') AND (orders.o_orderdate < (DATE '1993-09-01' + INTERVAL '3' MONTH) AND (lineitem.l_returnflag = 'R' AND customer.c_nationkey = nation.n_nationkey)) GROUP BY customer.c_custkey, customer.c_name, customer.c_acctbal, customer.c_phone, nation.n_name, customer.c_address, customer.c_comment ORDER BY SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) DESC","['FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'SORT_REMOVE_CONSTANT_KEYS', 'FILTER_AGGREGATE_TRANSPOSE', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#12' and p_type not like 'ECONOMY BURNISHED%' and p_size in (39, 12, 30, 42, 41, 16, 43, 4) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_CORRELATE', 'JOIN_CONDITION_PUSH', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'SORT_REMOVE_CONSTANT_KEYS', 'FILTER_INTO_JOIN', 'FILTER_AGGREGATE_TRANSPOSE', 'AGGREGATE_UNION_TRANSPOSE', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'FILTER_SET_OP_TRANSPOSE']""]"
284,tpch,"select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('AIR', 'SHIP') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1997-01-01' and l_receiptdate < date '1997-01-01' + interval '1' year group by l_shipmode order by l_shipmode;","select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('AIR', 'SHIP') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1997-01-01' and l_receiptdate < date '1997-01-01' + interval '1' year group by l_shipmode order by l_shipmode",[],"[""select o_year, sum(case when nation = 'FRANCE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL BRUSHED STEEL' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
285,tpch,"select 100.00 * sum(case when p_type like 'PROMO%' then l_extendedprice * (1 - l_discount) else 0 end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from lineitem, part where l_partkey = p_partkey and l_shipdate >= date '1997-03-01' and l_shipdate < date '1997-03-01' + interval '1' month;",SELECT 100.00 * SUM(CASE WHEN part.p_type LIKE 'PROMO%' THEN t.l_extendedprice * (1 - t.l_discount) ELSE 0 END) / SUM(t.l_extendedprice * (1 - t.l_discount)) AS promo_revenue FROM (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1997-03-01' AND l_shipdate < (DATE '1997-03-01' + INTERVAL '1' MONTH)) AS t INNER JOIN part ON t.l_partkey = part.p_partkey,"['FILTER_INTO_JOIN', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'FILTER_REDUCE_EXPRESSIONS']","[""select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('TRUCK', 'MAIL') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1995-01-01' and l_receiptdate < date '1995-01-01' + interval '1' year group by l_shipmode order by l_shipmode;""]","[""['FILTER_INTO_JOIN', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'FILTER_REDUCE_EXPRESSIONS', 'SORT_REMOVE_CONSTANT_KEYS']""]"
286,tpch,"select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#55' and p_type not like 'SMALL BRUSHED%' and p_size in (16, 8, 44, 29, 50, 13, 27, 43) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;","SELECT t6.p_brand, t6.p_type, t6.p_size, COUNT(t6.ps_suppkey) AS supplier_cnt FROM (SELECT t0.p_brand, t0.p_type, t0.p_size, t0.ps_suppkey FROM (SELECT * FROM (SELECT partsupp.ps_partkey, partsupp.ps_suppkey, partsupp.ps_availqty, partsupp.ps_supplycost, partsupp.ps_comment, part.p_partkey, part.p_name, part.p_mfgr, part.p_brand, part.p_type, part.p_size, part.p_container, part.p_retailprice, part.p_comment, partsupp.ps_suppkey AS ps_suppkey0 FROM partsupp, part) AS t WHERE t.p_partkey = t.ps_partkey AND CAST(t.p_brand AS CHAR(8)) <> 'Brand#55' AND t.p_size IN (8, 13, 16, 27, 29, 43, 44, 50) AND t.p_type NOT LIKE 'SMALL BRUSHED%') AS t0 LEFT JOIN (SELECT s_suppkey, MIN(TRUE) AS f1 FROM supplier WHERE s_comment LIKE '%Customer%Complaints%' GROUP BY s_suppkey) AS t3 ON t0.ps_suppkey0 = t3.s_suppkey WHERE t3.f1 IS NOT TRUE GROUP BY t0.p_brand, t0.p_type, t0.p_size, t0.ps_suppkey) AS t6 GROUP BY t6.p_brand, t6.p_type, t6.p_size ORDER BY COUNT(t6.ps_suppkey) DESC, t6.p_brand, t6.p_type, t6.p_size","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'FILTER_INTO_JOIN', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#22' and p_type not like 'SMALL PLATED%' and p_size in (1, 40, 46, 27, 45, 9, 38, 13) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'AGGREGATE_PROJECT_MERGE', 'FILTER_INTO_JOIN', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS']""]"
287,tpch,"select sum(l_extendedprice) / 7.0 as avg_yearly from lineitem, part where p_partkey = l_partkey and p_brand = 'Brand#52' and p_container = 'LG PACK' and l_quantity < ( select 0.2 * avg(l_quantity) from lineitem where l_partkey = p_partkey );","SELECT SUM(lineitem.l_extendedprice) / 7.0 AS avg_yearly FROM lineitem INNER JOIN (SELECT * FROM part WHERE p_brand = 'Brand#52' AND p_container = 'LG PACK') AS t ON lineitem.l_partkey = t.p_partkey INNER JOIN (SELECT l_partkey, AVG(l_quantity) AS f1 FROM lineitem GROUP BY l_partkey) AS t1 ON t.p_partkey = t1.l_partkey AND lineitem.l_quantity < 0.2 * t1.f1","['FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#41' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 9 and l_quantity <= 9 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#23' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 16 and l_quantity <= 16 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#45' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 27 and l_quantity <= 27 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH']""]"
288,tpch,"select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#21' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 5 and l_quantity <= 5 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#53' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 19 and l_quantity <= 19 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#51' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 24 and l_quantity <= 24 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );","SELECT SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS revenue FROM lineitem, part WHERE part.p_partkey = lineitem.l_partkey AND part.p_brand = 'Brand#21' AND (part.p_container IN ('SM BOX', 'SM CASE', 'SM PACK', 'SM PKG') AND lineitem.l_quantity >= 5) AND (lineitem.l_quantity <= 5 + 10 AND (part.p_size >= 1 AND part.p_size <= 5) AND (lineitem.l_shipmode IN ('AIR', 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON')) OR part.p_partkey = lineitem.l_partkey AND part.p_brand = 'Brand#53' AND (part.p_container IN ('MED BAG', 'MED BOX', 'MED PACK', 'MED PKG') AND lineitem.l_quantity >= 19) AND (lineitem.l_quantity <= 19 + 10 AND (part.p_size >= 1 AND part.p_size <= 10) AND (lineitem.l_shipmode IN ('AIR', 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON')) OR part.p_partkey = lineitem.l_partkey AND part.p_brand = 'Brand#51' AND (part.p_container IN ('LG BOX', 'LG CASE', 'LG PACK', 'LG PKG') AND lineitem.l_quantity >= 24) AND (lineitem.l_quantity <= 24 + 10 AND (part.p_size >= 1 AND part.p_size <= 15) AND (lineitem.l_shipmode IN ('AIR', 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))","['FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH', 'JOIN_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE']","[""select o_year, sum(case when nation = 'ETHIOPIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL BRUSHED COPPER' ) as all_nations group by o_year order by o_year;""]","[""['FILTER_SCAN', 'FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH', 'PROJECT_REDUCE_EXPRESSIONS', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE', 'AGGREGATE_PROJECT_MERGE']""]"
289,tpch,"select s_name, s_address from supplier, nation where s_suppkey in ( select ps_suppkey from partsupp where ps_partkey in ( select p_partkey from part where p_name like 'burlywood%' ) and ps_availqty > ( select 0.5 * sum(l_quantity) from lineitem where l_partkey = ps_partkey and l_suppkey = ps_suppkey and l_shipdate >= date '1997-01-01' and l_shipdate < date '1997-01-01' + interval '1' year ) ) and s_nationkey = n_nationkey and n_name = 'JORDAN' order by s_name;","SELECT supplier.s_name, supplier.s_address FROM supplier INNER JOIN (SELECT * FROM nation WHERE n_name = 'JORDAN') AS t ON supplier.s_nationkey = t.n_nationkey INNER JOIN (SELECT partsupp.ps_suppkey FROM partsupp INNER JOIN (SELECT p_partkey FROM part WHERE p_name LIKE 'burlywood%' GROUP BY p_partkey) AS t2 ON partsupp.ps_partkey = t2.p_partkey INNER JOIN (SELECT l_partkey, l_suppkey, SUM(l_quantity) AS f2 FROM lineitem WHERE l_shipdate >= DATE '1997-01-01' AND l_shipdate < (DATE '1997-01-01' + INTERVAL '1' YEAR) GROUP BY l_partkey, l_suppkey) AS t5 ON partsupp.ps_partkey = t5.l_partkey AND partsupp.ps_suppkey = t5.l_suppkey AND partsupp.ps_availqty > 0.5 * t5.f2 GROUP BY partsupp.ps_suppkey) AS t8 ON supplier.s_suppkey = t8.ps_suppkey ORDER BY supplier.s_name","['FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_CORRELATE', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_SET_OP_TRANSPOSE', 'JOIN_CONDITION_PUSH', 'JOIN_LEFT_UNION_TRANSPOSE', 'JOIN_RIGHT_UNION_TRANSPOSE', 'JOIN_REDUCE_EXPRESSIONS', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'JOIN_PROJECT_LEFT_TRANSPOSE', 'JOIN_PROJECT_RIGHT_TRANSPOSE', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'SORT_UNION_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#41' and p_type not like 'MEDIUM POLISHED%' and p_size in (24, 11, 8, 49, 26, 33, 6, 3) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_CORRELATE', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_SET_OP_TRANSPOSE', 'FILTER_AGGREGATE_TRANSPOSE', 'AGGREGATE_ANY_PULL_UP_CONSTANTS', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'AGGREGATE_UNION_TRANSPOSE', 'AGGREGATE_REMOVE', 'JOIN_CONDITION_PUSH', 'JOIN_LEFT_UNION_TRANSPOSE', 'JOIN_RIGHT_UNION_TRANSPOSE', 'JOIN_REDUCE_EXPRESSIONS', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'JOIN_PROJECT_LEFT_TRANSPOSE', 'JOIN_PROJECT_RIGHT_TRANSPOSE', 'SEMI_JOIN_REMOVE', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'SORT_UNION_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE']""]"
290,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'VIETNAM' group by s_name order by numwait desc, s_name;","SELECT t3.s_name, COUNT(*) AS numwait FROM (SELECT * FROM (SELECT supplier.s_suppkey, supplier.s_name, supplier.s_address, supplier.s_nationkey, supplier.s_phone, supplier.s_acctbal, supplier.s_comment, lineitem.l_orderkey, lineitem.l_partkey, lineitem.l_suppkey, lineitem.l_linenumber, lineitem.l_quantity, lineitem.l_extendedprice, lineitem.l_discount, lineitem.l_tax, lineitem.l_returnflag, lineitem.l_linestatus, lineitem.l_shipdate, lineitem.l_commitdate, lineitem.l_receiptdate, lineitem.l_shipinstruct, lineitem.l_shipmode, lineitem.l_comment, orders.o_orderkey, orders.o_custkey, orders.o_orderstatus, orders.o_totalprice, orders.o_orderdate, orders.o_orderpriority, orders.o_clerk, orders.o_shippriority, orders.o_comment, nation.n_nationkey, nation.n_name, nation.n_regionkey, nation.n_comment, t1.f2 AS f0 FROM supplier CROSS JOIN lineitem CROSS JOIN orders CROSS JOIN nation LEFT JOIN (SELECT t.l_orderkey AS l_orderkey0, t.l_suppkey AS l_suppkey0, MIN(TRUE) AS f2 FROM lineitem AS lineitem0 INNER JOIN (SELECT lineitem1.l_orderkey, lineitem1.l_suppkey FROM supplier AS supplier0, lineitem AS lineitem1, orders AS orders0, nation AS nation0 GROUP BY lineitem1.l_orderkey, lineitem1.l_suppkey) AS t ON lineitem0.l_orderkey = t.l_orderkey AND lineitem0.l_suppkey <> t.l_suppkey GROUP BY t.l_orderkey, t.l_suppkey) AS t1 ON lineitem.l_orderkey = t1.l_orderkey0 AND lineitem.l_suppkey = t1.l_suppkey0) AS t2 WHERE t2.s_suppkey = t2.l_suppkey AND (t2.o_orderkey = t2.l_orderkey AND t2.o_orderstatus = 'F') AND (t2.l_receiptdate > t2.l_commitdate AND t2.s_nationkey = t2.n_nationkey AND (t2.n_name = 'VIETNAM' AND t2.f0 IS NOT NULL))) AS t3 LEFT JOIN (SELECT t10.l_orderkey AS l_orderkey0, t10.l_suppkey AS l_suppkey0, MIN(TRUE) AS f2 FROM (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t4 INNER JOIN (SELECT l_orderkey, l_suppkey FROM (SELECT supplier1.s_suppkey, supplier1.s_name, supplier1.s_address, supplier1.s_nationkey, supplier1.s_phone, supplier1.s_acctbal, supplier1.s_comment, lineitem3.l_orderkey, lineitem3.l_partkey, lineitem3.l_suppkey, lineitem3.l_linenumber, lineitem3.l_quantity, lineitem3.l_extendedprice, lineitem3.l_discount, lineitem3.l_tax, lineitem3.l_returnflag, lineitem3.l_linestatus, lineitem3.l_shipdate, lineitem3.l_commitdate, lineitem3.l_receiptdate, lineitem3.l_shipinstruct, lineitem3.l_shipmode, lineitem3.l_comment, orders1.o_orderkey, orders1.o_custkey, orders1.o_orderstatus, orders1.o_totalprice, orders1.o_orderdate, orders1.o_orderpriority, orders1.o_clerk, orders1.o_shippriority, orders1.o_comment, nation1.n_nationkey, nation1.n_name, nation1.n_regionkey, nation1.n_comment, t7.f2 AS f0 FROM supplier AS supplier1 CROSS JOIN lineitem AS lineitem3 CROSS JOIN orders AS orders1 CROSS JOIN nation AS nation1 LEFT JOIN (SELECT t5.l_orderkey AS l_orderkey0, t5.l_suppkey AS l_suppkey0, MIN(TRUE) AS f2 FROM lineitem AS lineitem4 INNER JOIN (SELECT lineitem5.l_orderkey, lineitem5.l_suppkey FROM supplier AS supplier2, lineitem AS lineitem5, orders AS orders2, nation AS nation2 GROUP BY lineitem5.l_orderkey, lineitem5.l_suppkey) AS t5 ON lineitem4.l_orderkey = t5.l_orderkey AND lineitem4.l_suppkey <> t5.l_suppkey GROUP BY t5.l_orderkey, t5.l_suppkey) AS t7 ON lineitem3.l_orderkey = t7.l_orderkey0 AND lineitem3.l_suppkey = t7.l_suppkey0) AS t8 WHERE t8.s_suppkey = t8.l_suppkey AND (t8.o_orderkey = t8.l_orderkey AND t8.o_orderstatus = 'F') AND (t8.l_receiptdate > t8.l_commitdate AND t8.s_nationkey = t8.n_nationkey AND (t8.n_name = 'VIETNAM' AND t8.f0 IS NOT NULL)) GROUP BY l_orderkey, l_suppkey) AS t10 ON t4.l_orderkey = t10.l_orderkey AND t4.l_suppkey <> t10.l_suppkey GROUP BY t10.l_orderkey, t10.l_suppkey) AS t12 ON t3.l_orderkey = t12.l_orderkey0 AND t3.l_suppkey = t12.l_suppkey0 WHERE t12.f2 IS NULL GROUP BY t3.s_name ORDER BY COUNT(*) DESC, t3.s_name","['FILTER_INTO_JOIN', 'FILTER_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE']","[""select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'CHINA' and n2.n_name = 'BRAZIL') or (n1.n_name = 'BRAZIL' and n2.n_name = 'CHINA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;""]","[""['FILTER_INTO_JOIN']""]"
291,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('33', '44', '25', '20', '41', '32', '40') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('33', '44', '25', '20', '41', '32', '40') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(t.c_phone) + 1) < 1 THEN CHAR_LENGTH(t.c_phone) + 1 ELSE 1 END FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '33' OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '44' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '25') OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '20' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '41' OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '32' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '40'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '33' OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '44' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '25') OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '20' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '41' OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '32' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '40')))) AS t2 ON t.c_acctbal > t2.EXPR0 LEFT JOIN (SELECT o_custkey, MIN(TRUE) AS f1 FROM orders GROUP BY o_custkey) AS t4 ON t.c_custkey = t4.o_custkey WHERE t4.f1 IS NULL GROUP BY SUBSTR(t.c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(t.c_phone) + 1) < 1 THEN CHAR_LENGTH(t.c_phone) + 1 ELSE 1 END FOR 2) ORDER BY SUBSTR(t.c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(t.c_phone) + 1) < 1 THEN CHAR_LENGTH(t.c_phone) + 1 ELSE 1 END FOR 2)","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'FILTER_INTO_JOIN', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS']","[""select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'FURNITURE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-26' and l_shipdate > date '1995-03-26' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;""]","[""['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_REDUCE_EXPRESSIONS', 'SORT_JOIN_TRANSPOSE']""]"
292,tpch,"select l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order from lineitem where l_shipdate <= date '1998-12-01' - interval '117' day (3) group by l_returnflag, l_linestatus order by l_returnflag, l_linestatus;","select l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order from lineitem where l_shipdate <= date '1998-12-01' - interval '117' day (3) group by l_returnflag, l_linestatus order by l_returnflag, l_linestatus",[],"[""select o_year, sum(case when nation = 'CHINA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD PLATED BRASS' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
293,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 20 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 20 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey",[],"[""select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'MOROCCO' and n2.n_name = 'CHINA') or (n1.n_name = 'CHINA' and n2.n_name = 'MOROCCO') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;""]","[""['Empty List']""]"
294,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'AUTOMOBILE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-08' and l_shipdate > date '1995-03-08' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'AUTOMOBILE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-08' and l_shipdate > date '1995-03-08' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('36', '21', '39', '29', '43', '23', '40') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('36', '21', '39', '29', '43', '23', '40') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
295,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1994-03-01' and o_orderdate < date '1994-03-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1994-03-01' and o_orderdate < date '1994-03-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority",[],"[""select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'MACHINERY' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-20' and l_shipdate > date '1995-03-20' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;""]","[""['Empty List']""]"
296,tpch,"select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and o_orderdate >= date '1993-01-01' and o_orderdate < date '1993-01-01' + interval '1' year group by n_name order by revenue desc;","SELECT nation.n_name, SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS revenue FROM customer INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1993-01-01' AND o_orderdate < (DATE '1993-01-01' + INTERVAL '1' YEAR)) AS t ON customer.c_custkey = t.o_custkey INNER JOIN lineitem ON t.o_orderkey = lineitem.l_orderkey INNER JOIN supplier ON lineitem.l_suppkey = supplier.s_suppkey AND customer.c_nationkey = supplier.s_nationkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t0 ON nation.n_regionkey = t0.r_regionkey GROUP BY nation.n_name ORDER BY SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) DESC","['FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_INTO_JOIN', 'FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH', 'AGGREGATE_PROJECT_MERGE', 'SORT_REMOVE_CONSTANT_KEYS']","[""select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'HOUSEHOLD' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-28' and l_shipdate > date '1995-03-28' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;""]","[""['FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_INTO_JOIN', 'FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH', 'SORT_REMOVE_CONSTANT_KEYS', 'AGGREGATE_PROJECT_MERGE']""]"
297,tpch,select sum(l_extendedprice * l_discount) as revenue from lineitem where l_shipdate >= date '1993-01-01' and l_shipdate < date '1993-01-01' + interval '1' year and l_discount between 0.03 - 0.01 and 0.03 + 0.01 and l_quantity < 24;,SELECT SUM(l_extendedprice * l_discount) AS revenue FROM lineitem WHERE l_shipdate >= DATE '1993-01-01' AND l_shipdate < (DATE '1993-01-01' + INTERVAL '1' YEAR) AND l_discount >= 0.03 - 0.01 AND l_discount <= 0.03 + 0.01 AND l_quantity < 24,"['FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS']","[""select o_year, sum(case when nation = 'MOZAMBIQUE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL POLISHED TIN' ) as all_nations group by o_year order by o_year;""]","[""['FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_PROJECT_TRANSPOSE', 'JOIN_CONDITION_PUSH', 'FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_UNION_TRANSPOSE', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'AGGREGATE_PROJECT_MERGE']""]"
298,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'EGYPT' and n2.n_name = 'JORDAN') or (n1.n_name = 'JORDAN' and n2.n_name = 'EGYPT') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'EGYPT' and n2.n_name = 'JORDAN') or (n1.n_name = 'JORDAN' and n2.n_name = 'EGYPT') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 3 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
299,tpch,"select o_year, sum(case when nation = 'EGYPT' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE BURNISHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t0.o_orderdate) AS o_year, SUM(CASE WHEN nation0.n_name = 'EGYPT' THEN lineitem.l_extendedprice * (1 - lineitem.l_discount) ELSE 0 END) / SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'LARGE BURNISHED STEEL') AS t CROSS JOIN supplier INNER JOIN lineitem ON t.p_partkey = lineitem.l_partkey AND supplier.s_suppkey = lineitem.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t0 ON lineitem.l_orderkey = t0.o_orderkey INNER JOIN customer ON t0.o_custkey = customer.c_custkey INNER JOIN nation ON customer.c_nationkey = nation.n_nationkey INNER JOIN nation AS nation0 ON supplier.s_nationkey = nation0.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1 ON nation.n_regionkey = t1.r_regionkey GROUP BY EXTRACT(YEAR FROM t0.o_orderdate) ORDER BY EXTRACT(YEAR FROM t0.o_orderdate)","['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_PROJECT_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#51' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 2 and l_quantity <= 2 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#24' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 10 and l_quantity <= 10 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#23' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 20 and l_quantity <= 20 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'JOIN_RIGHT_INSTANCE', 'FILTER_INSTANCE', 'PROJECT_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE']""]"
300,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%midnight%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation.n_name AS nation, EXTRACT(YEAR FROM orders.o_orderdate) AS o_year, SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount) - partsupp.ps_supplycost * lineitem.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%midnight%') AS t CROSS JOIN supplier INNER JOIN lineitem ON supplier.s_suppkey = lineitem.l_suppkey AND t.p_partkey = lineitem.l_partkey INNER JOIN partsupp ON lineitem.l_suppkey = partsupp.ps_suppkey AND lineitem.l_partkey = partsupp.ps_partkey INNER JOIN orders ON lineitem.l_orderkey = orders.o_orderkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey GROUP BY nation.n_name, EXTRACT(YEAR FROM orders.o_orderdate) ORDER BY nation.n_name, EXTRACT(YEAR FROM orders.o_orderdate) DESC","['FILTER_INTO_JOIN', 'FILTER_MERGE', 'PROJECT_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#33' and p_type not like 'LARGE POLISHED%' and p_size in (36, 30, 40, 38, 39, 26, 7, 44) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_INTO_JOIN', 'FILTER_MERGE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH', 'SORT_REMOVE_CONSTANT_KEYS']""]"
301,tpch,"select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from customer, orders, lineitem, nation where c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate >= date '1993-03-01' and o_orderdate < date '1993-03-01' + interval '3' month and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc;","SELECT customer.c_custkey, customer.c_name, SUM(t0.l_extendedprice * (1 - t0.l_discount)) AS revenue, customer.c_acctbal, nation.n_name, customer.c_address, customer.c_phone, customer.c_comment FROM customer INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1993-03-01' AND o_orderdate < (DATE '1993-03-01' + INTERVAL '3' MONTH)) AS t ON customer.c_custkey = t.o_custkey INNER JOIN (SELECT * FROM lineitem WHERE l_returnflag = 'R') AS t0 ON t.o_orderkey = t0.l_orderkey INNER JOIN nation ON customer.c_nationkey = nation.n_nationkey GROUP BY customer.c_custkey, customer.c_name, customer.c_acctbal, customer.c_phone, nation.n_name, customer.c_address, customer.c_comment ORDER BY SUM(t0.l_extendedprice * (1 - t0.l_discount)) DESC","['AGGREGATE_PROJECT_MERGE', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_INTO_JOIN', 'SORT_PROJECT_TRANSPOSE']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#43' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 2 and l_quantity <= 2 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#42' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 17 and l_quantity <= 17 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#51' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 29 and l_quantity <= 29 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['AGGREGATE_PROJECT_MERGE', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_INTO_JOIN']""]"
302,tpch,"select ps_partkey, sum(ps_supplycost * ps_availqty) as value from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'INDIA' group by ps_partkey having sum(ps_supplycost * ps_availqty) > ( select sum(ps_supplycost * ps_availqty) * 0.0001000000 from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'INDIA' ) order by value desc;","select ps_partkey, sum(ps_supplycost * ps_availqty) as value from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'INDIA' group by ps_partkey having sum(ps_supplycost * ps_availqty) > ( select sum(ps_supplycost * ps_availqty) * 0.0001000000 from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'INDIA' ) order by value desc",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('22', '30', '36', '20', '43', '33', '31') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('22', '30', '36', '20', '43', '33', '31') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
303,tpch,"select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('TRUCK', 'RAIL') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1996-01-01' and l_receiptdate < date '1996-01-01' + interval '1' year group by l_shipmode order by l_shipmode;","SELECT lineitem.l_shipmode, SUM(CASE WHEN orders.o_orderpriority = '1-URGENT' OR orders.o_orderpriority = '2-HIGH' THEN 1 ELSE 0 END) AS high_line_count, SUM(CASE WHEN orders.o_orderpriority <> '1-URGENT' AND orders.o_orderpriority <> '2-HIGH' THEN 1 ELSE 0 END) AS low_line_count FROM orders, lineitem WHERE orders.o_orderkey = lineitem.l_orderkey AND (lineitem.l_shipmode IN ('RAIL', 'TRUCK') AND lineitem.l_commitdate < lineitem.l_receiptdate) AND (lineitem.l_shipdate < lineitem.l_commitdate AND (lineitem.l_receiptdate >= DATE '1996-01-01' AND lineitem.l_receiptdate < (DATE '1996-01-01' + INTERVAL '1' YEAR))) GROUP BY lineitem.l_shipmode ORDER BY lineitem.l_shipmode","['FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_CORRELATE', 'FILTER_MERGE', 'FILTER_MULTI_JOIN_MERGE', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_ANY_PULL_UP_CONSTANTS', 'JOIN_CONDITION_PUSH', 'SORT_PROJECT_TRANSPOSE', 'JOIN_REDUCE_EXPRESSIONS']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#43' and p_type not like 'STANDARD PLATED%' and p_size in (18, 28, 41, 22, 24, 13, 16, 40) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_CORRELATE', 'FILTER_MERGE', 'FILTER_MULTI_JOIN_MERGE', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_ANY_PULL_UP_CONSTANTS', 'AGGREGATE_REMOVE', 'JOIN_CONDITION_PUSH', 'SORT_PROJECT_TRANSPOSE', 'SORT_UNION_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE', 'JOIN_EXTRACT_FILTER', 'JOIN_REDUCE_EXPRESSIONS', 'UNION_REMOVE', 'UNION_TO_DISTINCT']""]"
304,tpch,"select 100.00 * sum(case when p_type like 'PROMO%' then l_extendedprice * (1 - l_discount) else 0 end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from lineitem, part where l_partkey = p_partkey and l_shipdate >= date '1996-03-01' and l_shipdate < date '1996-03-01' + interval '1' month;","select 100.00 * sum(case when p_type like 'PROMO%' then l_extendedprice * (1 - l_discount) else 0 end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from lineitem, part where l_partkey = p_partkey and l_shipdate >= date '1996-03-01' and l_shipdate < date '1996-03-01' + interval '1' month",[],"[""select o_year, sum(case when nation = 'RUSSIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY BRUSHED TIN' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
305,tpch,"select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#43' and p_type not like 'STANDARD PLATED%' and p_size in (28, 21, 36, 6, 17, 30, 43, 18) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;","SELECT t6.p_brand, t6.p_type, t6.p_size, COUNT(t6.ps_suppkey) AS supplier_cnt FROM (SELECT t0.p_brand, t0.p_type, t0.p_size, t0.ps_suppkey FROM (SELECT * FROM (SELECT partsupp.ps_partkey, partsupp.ps_suppkey, partsupp.ps_availqty, partsupp.ps_supplycost, partsupp.ps_comment, part.p_partkey, part.p_name, part.p_mfgr, part.p_brand, part.p_type, part.p_size, part.p_container, part.p_retailprice, part.p_comment, partsupp.ps_suppkey AS ps_suppkey0 FROM partsupp, part) AS t WHERE t.p_partkey = t.ps_partkey AND CAST(t.p_brand AS CHAR(8)) <> 'Brand#43' AND t.p_size IN (6, 17, 18, 21, 28, 30, 36, 43) AND t.p_type NOT LIKE 'STANDARD PLATED%') AS t0 LEFT JOIN (SELECT s_suppkey, MIN(TRUE) AS f1 FROM supplier WHERE s_comment LIKE '%Customer%Complaints%' GROUP BY s_suppkey) AS t3 ON t0.ps_suppkey0 = t3.s_suppkey WHERE t3.f1 IS NOT TRUE GROUP BY t0.p_brand, t0.p_type, t0.p_size, t0.ps_suppkey) AS t6 GROUP BY t6.p_brand, t6.p_type, t6.p_size ORDER BY COUNT(t6.ps_suppkey) DESC, t6.p_brand, t6.p_type, t6.p_size","['FILTER_INTO_JOIN', 'FILTER_MERGE', 'JOIN_PROJECT_LEFT_TRANSPOSE', 'JOIN_PROJECT_RIGHT_TRANSPOSE', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#45' and p_type not like 'PROMO ANODIZED%' and p_size in (36, 20, 1, 15, 33, 30, 39, 50) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_INTO_JOIN', 'FILTER_MERGE', 'JOIN_PROJECT_LEFT_TRANSPOSE', 'JOIN_PROJECT_RIGHT_TRANSPOSE', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE']""]"
306,tpch,"select sum(l_extendedprice) / 7.0 as avg_yearly from lineitem, part where p_partkey = l_partkey and p_brand = 'Brand#31' and p_container = 'MED PKG' and l_quantity < ( select 0.2 * avg(l_quantity) from lineitem where l_partkey = p_partkey );","SELECT SUM(lineitem.l_extendedprice) / 7.0 AS avg_yearly FROM lineitem INNER JOIN (SELECT * FROM part WHERE p_brand = 'Brand#31' AND p_container = 'MED PKG') AS t ON lineitem.l_partkey = t.p_partkey INNER JOIN (SELECT l_partkey, AVG(l_quantity) AS f1 FROM lineitem GROUP BY l_partkey) AS t0 ON t.p_partkey = t0.l_partkey AND lineitem.l_quantity < 0.2 * t0.f1","['FILTER_AGGREGATE_TRANSPOSE', 'FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH', 'AGGREGATE_PROJECT_MERGE']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#33' and p_type not like 'STANDARD BURNISHED%' and p_size in (11, 49, 37, 6, 28, 13, 10, 48) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_AGGREGATE_TRANSPOSE', 'FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_SET_OP_TRANSPOSE', 'FILTER_MERGE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_REMOVE', 'JOIN_CONDITION_PUSH']""]"
307,tpch,"select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#32' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 9 and l_quantity <= 9 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#41' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 12 and l_quantity <= 12 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#23' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 25 and l_quantity <= 25 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );","select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#32' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 9 and l_quantity <= 9 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#41' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 12 and l_quantity <= 12 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#23' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 25 and l_quantity <= 25 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' )",[],"[""select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'BUILDING' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-28' and l_shipdate > date '1995-03-28' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;""]","[""['Empty List']""]"
308,tpch,"select s_name, s_address from supplier, nation where s_suppkey in ( select ps_suppkey from partsupp where ps_partkey in ( select p_partkey from part where p_name like 'honeydew%' ) and ps_availqty > ( select 0.5 * sum(l_quantity) from lineitem where l_partkey = ps_partkey and l_suppkey = ps_suppkey and l_shipdate >= date '1996-01-01' and l_shipdate < date '1996-01-01' + interval '1' year ) ) and s_nationkey = n_nationkey and n_name = 'ARGENTINA' order by s_name;","select s_name, s_address from supplier, nation where s_suppkey in ( select ps_suppkey from partsupp where ps_partkey in ( select p_partkey from part where p_name like 'honeydew%' ) and ps_availqty > ( select 0.5 * sum(l_quantity) from lineitem where l_partkey = ps_partkey and l_suppkey = ps_suppkey and l_shipdate >= date '1996-01-01' and l_shipdate < date '1996-01-01' + interval '1' year ) ) and s_nationkey = n_nationkey and n_name = 'ARGENTINA' order by s_name",[],"[""select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1993-02-01' and o_orderdate < date '1993-02-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;""]","[""['Empty List']""]"
309,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'PERU' group by s_name order by numwait desc, s_name;","SELECT t3.s_name, COUNT(*) AS numwait FROM (SELECT * FROM (SELECT supplier.s_suppkey, supplier.s_name, supplier.s_address, supplier.s_nationkey, supplier.s_phone, supplier.s_acctbal, supplier.s_comment, lineitem.l_orderkey, lineitem.l_partkey, lineitem.l_suppkey, lineitem.l_linenumber, lineitem.l_quantity, lineitem.l_extendedprice, lineitem.l_discount, lineitem.l_tax, lineitem.l_returnflag, lineitem.l_linestatus, lineitem.l_shipdate, lineitem.l_commitdate, lineitem.l_receiptdate, lineitem.l_shipinstruct, lineitem.l_shipmode, lineitem.l_comment, orders.o_orderkey, orders.o_custkey, orders.o_orderstatus, orders.o_totalprice, orders.o_orderdate, orders.o_orderpriority, orders.o_clerk, orders.o_shippriority, orders.o_comment, nation.n_nationkey, nation.n_name, nation.n_regionkey, nation.n_comment, t1.f2 AS f0 FROM supplier CROSS JOIN lineitem CROSS JOIN orders CROSS JOIN nation LEFT JOIN (SELECT t.l_orderkey AS l_orderkey0, t.l_suppkey AS l_suppkey0, MIN(TRUE) AS f2 FROM lineitem AS lineitem0 INNER JOIN (SELECT lineitem1.l_orderkey, lineitem1.l_suppkey FROM supplier AS supplier0, lineitem AS lineitem1, orders AS orders0, nation AS nation0 GROUP BY lineitem1.l_orderkey, lineitem1.l_suppkey) AS t ON lineitem0.l_orderkey = t.l_orderkey AND lineitem0.l_suppkey <> t.l_suppkey GROUP BY t.l_orderkey, t.l_suppkey) AS t1 ON lineitem.l_orderkey = t1.l_orderkey0 AND lineitem.l_suppkey = t1.l_suppkey0) AS t2 WHERE t2.s_suppkey = t2.l_suppkey AND (t2.o_orderkey = t2.l_orderkey AND t2.o_orderstatus = 'F') AND (t2.l_receiptdate > t2.l_commitdate AND t2.s_nationkey = t2.n_nationkey AND (t2.n_name = 'PERU' AND t2.f0 IS NOT NULL))) AS t3 LEFT JOIN (SELECT t10.l_orderkey AS l_orderkey0, t10.l_suppkey AS l_suppkey0, MIN(TRUE) AS f2 FROM (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t4 INNER JOIN (SELECT l_orderkey, l_suppkey FROM (SELECT supplier1.s_suppkey, supplier1.s_name, supplier1.s_address, supplier1.s_nationkey, supplier1.s_phone, supplier1.s_acctbal, supplier1.s_comment, lineitem3.l_orderkey, lineitem3.l_partkey, lineitem3.l_suppkey, lineitem3.l_linenumber, lineitem3.l_quantity, lineitem3.l_extendedprice, lineitem3.l_discount, lineitem3.l_tax, lineitem3.l_returnflag, lineitem3.l_linestatus, lineitem3.l_shipdate, lineitem3.l_commitdate, lineitem3.l_receiptdate, lineitem3.l_shipinstruct, lineitem3.l_shipmode, lineitem3.l_comment, orders1.o_orderkey, orders1.o_custkey, orders1.o_orderstatus, orders1.o_totalprice, orders1.o_orderdate, orders1.o_orderpriority, orders1.o_clerk, orders1.o_shippriority, orders1.o_comment, nation1.n_nationkey, nation1.n_name, nation1.n_regionkey, nation1.n_comment, t7.f2 AS f0 FROM supplier AS supplier1 CROSS JOIN lineitem AS lineitem3 CROSS JOIN orders AS orders1 CROSS JOIN nation AS nation1 LEFT JOIN (SELECT t5.l_orderkey AS l_orderkey0, t5.l_suppkey AS l_suppkey0, MIN(TRUE) AS f2 FROM lineitem AS lineitem4 INNER JOIN (SELECT lineitem5.l_orderkey, lineitem5.l_suppkey FROM supplier AS supplier2, lineitem AS lineitem5, orders AS orders2, nation AS nation2 GROUP BY lineitem5.l_orderkey, lineitem5.l_suppkey) AS t5 ON lineitem4.l_orderkey = t5.l_orderkey AND lineitem4.l_suppkey <> t5.l_suppkey GROUP BY t5.l_orderkey, t5.l_suppkey) AS t7 ON lineitem3.l_orderkey = t7.l_orderkey0 AND lineitem3.l_suppkey = t7.l_suppkey0) AS t8 WHERE t8.s_suppkey = t8.l_suppkey AND (t8.o_orderkey = t8.l_orderkey AND t8.o_orderstatus = 'F') AND (t8.l_receiptdate > t8.l_commitdate AND t8.s_nationkey = t8.n_nationkey AND (t8.n_name = 'PERU' AND t8.f0 IS NOT NULL)) GROUP BY l_orderkey, l_suppkey) AS t10 ON t4.l_orderkey = t10.l_orderkey AND t4.l_suppkey <> t10.l_suppkey GROUP BY t10.l_orderkey, t10.l_suppkey) AS t12 ON t3.l_orderkey = t12.l_orderkey0 AND t3.l_suppkey = t12.l_suppkey0 WHERE t12.f2 IS NULL GROUP BY t3.s_name ORDER BY COUNT(*) DESC, t3.s_name","['AGGREGATE_PROJECT_MERGE', 'FILTER_INTO_JOIN', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH', 'SORT_JOIN_TRANSPOSE']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#45' and p_type not like 'STANDARD PLATED%' and p_size in (24, 5, 34, 22, 27, 23, 40, 9) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_PROJECT_MERGE', 'FILTER_INTO_JOIN', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH', 'SORT_JOIN_TRANSPOSE']""]"
310,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('21', '27', '34', '41', '29', '22', '31') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('21', '27', '34', '41', '29', '22', '31') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('21', '27', '34', '41', '29', '22', '31') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('21', '27', '34', '41', '29', '22', '31') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode",[],"[""select o_year, sum(case when nation = 'INDIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM BURNISHED NICKEL' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
311,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 7 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 7 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('28', '22', '30', '41', '20', '27', '43') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('28', '22', '30', '41', '20', '27', '43') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
312,tpch,"select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and o_orderdate >= date '1994-01-01' and o_orderdate < date '1994-01-01' + interval '1' year group by n_name order by revenue desc;","SELECT nation.n_name, SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS revenue FROM customer INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1994-01-01' AND o_orderdate < (DATE '1994-01-01' + INTERVAL '1' YEAR)) AS t ON customer.c_custkey = t.o_custkey INNER JOIN lineitem ON t.o_orderkey = lineitem.l_orderkey INNER JOIN supplier ON lineitem.l_suppkey = supplier.s_suppkey AND customer.c_nationkey = supplier.s_nationkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t0 ON nation.n_regionkey = t0.r_regionkey GROUP BY nation.n_name ORDER BY SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) DESC","['FILTER_SCAN', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_MERGE', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_AGGREGATE_TRANSPOSE', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'AGGREGATE_PROJECT_MERGE', 'PROJECT_REDUCE_EXPRESSIONS', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#41' and p_type not like 'ECONOMY PLATED%' and p_size in (2, 19, 37, 28, 33, 16, 12, 25) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_SCAN', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_MERGE', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'FILTER_AGGREGATE_TRANSPOSE', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'AGGREGATE_PROJECT_MERGE', 'PROJECT_CORRELATE_TRANSPOSE', 'PROJECT_REDUCE_EXPRESSIONS', 'PROJECT_CALC_MERGE']""]"
313,tpch,select sum(l_extendedprice * l_discount) as revenue from lineitem where l_shipdate >= date '1994-01-01' and l_shipdate < date '1994-01-01' + interval '1' year and l_discount between 0.08 - 0.01 and 0.08 + 0.01 and l_quantity < 25;,SELECT SUM(l_extendedprice * l_discount) AS revenue FROM lineitem WHERE l_shipdate >= DATE '1994-01-01' AND l_shipdate < (DATE '1994-01-01' + INTERVAL '1' YEAR) AND l_discount >= 0.08 - 0.01 AND l_discount <= 0.08 + 0.01 AND l_quantity < 25,['FILTER_REDUCE_EXPRESSIONS'],"[""select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1995-03-01' and o_orderdate < date '1995-03-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;""]","[""['AGGREGATE_PROJECT_MERGE']""]"
314,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'VIETNAM' and n2.n_name = 'JAPAN') or (n1.n_name = 'JAPAN' and n2.n_name = 'VIETNAM') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation.n_name AS supp_nation, nation0.n_name AS cust_nation, EXTRACT(YEAR FROM t.l_shipdate) AS l_year, SUM(t.l_extendedprice * (1 - t.l_discount)) AS revenue FROM supplier INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t ON supplier.s_suppkey = t.l_suppkey INNER JOIN orders ON t.l_orderkey = orders.o_orderkey INNER JOIN customer ON orders.o_custkey = customer.c_custkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey INNER JOIN nation AS nation0 ON customer.c_nationkey = nation0.n_nationkey AND (nation.n_name = 'VIETNAM' AND nation0.n_name = 'JAPAN' OR nation.n_name = 'JAPAN' AND nation0.n_name = 'VIETNAM') GROUP BY nation.n_name, nation0.n_name, EXTRACT(YEAR FROM t.l_shipdate) ORDER BY nation.n_name, nation0.n_name, EXTRACT(YEAR FROM t.l_shipdate)","['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'AGGREGATE_PROJECT_MERGE', 'SORT_REMOVE_CONSTANT_KEYS']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#54' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 6 and l_quantity <= 6 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#52' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 11 and l_quantity <= 11 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#52' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 23 and l_quantity <= 23 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_INTO_JOIN', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_REMOVE']""]"
315,tpch,"select o_year, sum(case when nation = 'VIETNAM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM BRUSHED COPPER' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t0.o_orderdate) AS o_year, SUM(CASE WHEN nation0.n_name = 'VIETNAM' THEN lineitem.l_extendedprice * (1 - lineitem.l_discount) ELSE 0 END) / SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'MEDIUM BRUSHED COPPER') AS t CROSS JOIN supplier INNER JOIN lineitem ON t.p_partkey = lineitem.l_partkey AND supplier.s_suppkey = lineitem.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t0 ON lineitem.l_orderkey = t0.o_orderkey INNER JOIN customer ON t0.o_custkey = customer.c_custkey INNER JOIN nation ON customer.c_nationkey = nation.n_nationkey INNER JOIN nation AS nation0 ON supplier.s_nationkey = nation0.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'ASIA') AS t1 ON nation.n_regionkey = t1.r_regionkey GROUP BY EXTRACT(YEAR FROM t0.o_orderdate) ORDER BY EXTRACT(YEAR FROM t0.o_orderdate)","['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_AGGREGATE_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE', 'SORT_PROJECT_TRANSPOSE']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#31' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 6 and l_quantity <= 6 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#53' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 19 and l_quantity <= 19 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#22' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 28 and l_quantity <= 28 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_INTO_JOIN', 'FILTER_AGGREGATE_TRANSPOSE', 'JOIN_CONDITION_PUSH', 'AGGREGATE_PROJECT_MERGE']""]"
316,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%lime%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation.n_name AS nation, EXTRACT(YEAR FROM orders.o_orderdate) AS o_year, SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount) - partsupp.ps_supplycost * lineitem.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%lime%') AS t CROSS JOIN supplier INNER JOIN lineitem ON supplier.s_suppkey = lineitem.l_suppkey AND t.p_partkey = lineitem.l_partkey INNER JOIN partsupp ON lineitem.l_suppkey = partsupp.ps_suppkey AND lineitem.l_partkey = partsupp.ps_partkey INNER JOIN orders ON lineitem.l_orderkey = orders.o_orderkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey GROUP BY nation.n_name, EXTRACT(YEAR FROM orders.o_orderdate) ORDER BY nation.n_name, EXTRACT(YEAR FROM orders.o_orderdate) DESC","['SORT_REMOVE', 'FILTER_INTO_JOIN', 'PROJECT_REDUCE_EXPRESSIONS']","[""select o_year, sum(case when nation = 'JAPAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD BURNISHED BRASS' ) as all_nations group by o_year order by o_year;""]","[""['SORT_REMOVE', 'PROJECT_REMOVE', 'FILTER_INTO_JOIN']""]"
317,tpch,"select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from customer, orders, lineitem, nation where c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate >= date '1994-01-01' and o_orderdate < date '1994-01-01' + interval '3' month and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc;","select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from customer, orders, lineitem, nation where c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate >= date '1994-01-01' and o_orderdate < date '1994-01-01' + interval '3' month and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 48 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
318,tpch,"select ps_partkey, sum(ps_supplycost * ps_availqty) as value from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'SAUDI ARABIA' group by ps_partkey having sum(ps_supplycost * ps_availqty) > ( select sum(ps_supplycost * ps_availqty) * 0.0001000000 from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'SAUDI ARABIA' ) order by value desc;","select ps_partkey, sum(ps_supplycost * ps_availqty) as value from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'SAUDI ARABIA' group by ps_partkey having sum(ps_supplycost * ps_availqty) > ( select sum(ps_supplycost * ps_availqty) * 0.0001000000 from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'SAUDI ARABIA' ) order by value desc",[],"[""select o_year, sum(case when nation = 'BRAZIL' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE BURNISHED BRASS' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
319,tpch,"select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('RAIL', 'MAIL') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1995-01-01' and l_receiptdate < date '1995-01-01' + interval '1' year group by l_shipmode order by l_shipmode;","select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('RAIL', 'MAIL') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1995-01-01' and l_receiptdate < date '1995-01-01' + interval '1' year group by l_shipmode order by l_shipmode",[],"[""select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'EGYPT' and n2.n_name = 'FRANCE') or (n1.n_name = 'FRANCE' and n2.n_name = 'EGYPT') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;""]","[""['Empty List']""]"
320,tpch,"select 100.00 * sum(case when p_type like 'PROMO%' then l_extendedprice * (1 - l_discount) else 0 end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from lineitem, part where l_partkey = p_partkey and l_shipdate >= date '1996-06-01' and l_shipdate < date '1996-06-01' + interval '1' month;","select 100.00 * sum(case when p_type like 'PROMO%' then l_extendedprice * (1 - l_discount) else 0 end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from lineitem, part where l_partkey = p_partkey and l_shipdate >= date '1996-06-01' and l_shipdate < date '1996-06-01' + interval '1' month",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 41 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
321,tpch,"select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#23' and p_type not like 'MEDIUM POLISHED%' and p_size in (31, 41, 21, 34, 14, 23, 22, 7) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;","SELECT t6.p_brand, t6.p_type, t6.p_size, COUNT(t6.ps_suppkey) AS supplier_cnt FROM (SELECT t0.p_brand, t0.p_type, t0.p_size, t0.ps_suppkey FROM (SELECT * FROM (SELECT partsupp.ps_partkey, partsupp.ps_suppkey, partsupp.ps_availqty, partsupp.ps_supplycost, partsupp.ps_comment, part.p_partkey, part.p_name, part.p_mfgr, part.p_brand, part.p_type, part.p_size, part.p_container, part.p_retailprice, part.p_comment, partsupp.ps_suppkey AS ps_suppkey0 FROM partsupp, part) AS t WHERE t.p_partkey = t.ps_partkey AND CAST(t.p_brand AS CHAR(8)) <> 'Brand#23' AND t.p_size IN (7, 14, 21, 22, 23, 31, 34, 41) AND t.p_type NOT LIKE 'MEDIUM POLISHED%') AS t0 LEFT JOIN (SELECT s_suppkey, MIN(TRUE) AS f1 FROM supplier WHERE s_comment LIKE '%Customer%Complaints%' GROUP BY s_suppkey) AS t3 ON t0.ps_suppkey0 = t3.s_suppkey WHERE t3.f1 IS NOT TRUE GROUP BY t0.p_brand, t0.p_type, t0.p_size, t0.ps_suppkey) AS t6 GROUP BY t6.p_brand, t6.p_type, t6.p_size ORDER BY COUNT(t6.ps_suppkey) DESC, t6.p_brand, t6.p_type, t6.p_size","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'FILTER_INTO_JOIN', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_MERGE', 'JOIN_EXTRACT_FILTER', 'JOIN_REDUCE_EXPRESSIONS', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#25' and p_type not like 'LARGE BURNISHED%' and p_size in (17, 49, 50, 22, 36, 6, 42, 28) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'FILTER_INTO_JOIN', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_MERGE', 'JOIN_EXTRACT_FILTER', 'JOIN_REDUCE_EXPRESSIONS', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE']""]"
322,tpch,"select sum(l_extendedprice) / 7.0 as avg_yearly from lineitem, part where p_partkey = l_partkey and p_brand = 'Brand#33' and p_container = 'JUMBO CASE' and l_quantity < ( select 0.2 * avg(l_quantity) from lineitem where l_partkey = p_partkey );","select sum(l_extendedprice) / 7.0 as avg_yearly from lineitem, part where p_partkey = l_partkey and p_brand = 'Brand#33' and p_container = 'JUMBO CASE' and l_quantity < ( select 0.2 * avg(l_quantity) from lineitem where l_partkey = p_partkey )",[],"[""select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'CHINA' and n2.n_name = 'ROMANIA') or (n1.n_name = 'ROMANIA' and n2.n_name = 'CHINA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;""]","[""['Empty List']""]"
323,tpch,"select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#45' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 4 and l_quantity <= 4 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#24' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 13 and l_quantity <= 13 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#22' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 21 and l_quantity <= 21 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );","select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#45' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 4 and l_quantity <= 4 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#24' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 13 and l_quantity <= 13 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#22' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 21 and l_quantity <= 21 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' )",[],"[""select o_year, sum(case when nation = 'MOZAMBIQUE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM ANODIZED NICKEL' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
324,tpch,"select s_name, s_address from supplier, nation where s_suppkey in ( select ps_suppkey from partsupp where ps_partkey in ( select p_partkey from part where p_name like 'salmon%' ) and ps_availqty > ( select 0.5 * sum(l_quantity) from lineitem where l_partkey = ps_partkey and l_suppkey = ps_suppkey and l_shipdate >= date '1994-01-01' and l_shipdate < date '1994-01-01' + interval '1' year ) ) and s_nationkey = n_nationkey and n_name = 'MOROCCO' order by s_name;","SELECT supplier.s_name, supplier.s_address FROM supplier INNER JOIN (SELECT * FROM nation WHERE n_name = 'MOROCCO') AS t ON supplier.s_nationkey = t.n_nationkey INNER JOIN (SELECT partsupp.ps_suppkey FROM partsupp INNER JOIN (SELECT p_partkey FROM part WHERE p_name LIKE 'salmon%' GROUP BY p_partkey) AS t2 ON partsupp.ps_partkey = t2.p_partkey INNER JOIN (SELECT l_partkey, l_suppkey, SUM(l_quantity) AS f2 FROM lineitem WHERE l_shipdate >= DATE '1994-01-01' AND l_shipdate < (DATE '1994-01-01' + INTERVAL '1' YEAR) GROUP BY l_partkey, l_suppkey) AS t5 ON partsupp.ps_partkey = t5.l_partkey AND partsupp.ps_suppkey = t5.l_suppkey AND partsupp.ps_availqty > 0.5 * t5.f2 GROUP BY partsupp.ps_suppkey) AS t8 ON supplier.s_suppkey = t8.ps_suppkey ORDER BY supplier.s_name","['FILTER_INTO_JOIN', 'FILTER_REDUCE_EXPRESSIONS']","[""select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'RUSSIA' and n2.n_name = 'UNITED STATES') or (n1.n_name = 'UNITED STATES' and n2.n_name = 'RUSSIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;""]","[""['FILTER_INTO_JOIN']""]"
325,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'INDONESIA' group by s_name order by numwait desc, s_name;","select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'INDONESIA' group by s_name order by numwait desc, s_name",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('23', '32', '34', '31', '39', '44', '38') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('23', '32', '34', '31', '39', '44', '38') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
326,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('35', '25', '30', '22', '31', '27', '39') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('35', '25', '30', '22', '31', '27', '39') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(t.c_phone) + 1) < 1 THEN CHAR_LENGTH(t.c_phone) + 1 ELSE 1 END FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '35' OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '25' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '30') OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '22' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '31' OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '27' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '39'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '35' OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '25' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '30') OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '22' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '31' OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '27' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '39')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, MIN(TRUE) AS f1 FROM orders GROUP BY o_custkey) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f1 IS NULL GROUP BY SUBSTR(t.c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(t.c_phone) + 1) < 1 THEN CHAR_LENGTH(t.c_phone) + 1 ELSE 1 END FOR 2) ORDER BY SUBSTR(t.c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(t.c_phone) + 1) < 1 THEN CHAR_LENGTH(t.c_phone) + 1 ELSE 1 END FOR 2)","['FILTER_INTO_JOIN', 'FILTER_PROJECT_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE', 'SORT_REMOVE_CONSTANT_KEYS']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#14' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 9 and l_quantity <= 9 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#15' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 17 and l_quantity <= 17 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#42' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 23 and l_quantity <= 23 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_INTO_JOIN', 'FILTER_PROJECT_TRANSPOSE', 'JOIN_LEFT_UNION_TRANSPOSE', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'PROJECT_REMOVE', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_REMOVE']""]"
327,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 48 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t12.s_acctbal, t12.s_name, t12.n_name, t12.p_partkey, t12.p_mfgr, t12.s_address, t12.s_phone, t12.s_comment FROM (SELECT t3.p_partkey, t3.p_name, t3.p_mfgr, t3.p_brand, t3.p_type, t3.p_size, t3.p_container, t3.p_retailprice, t3.p_comment, t3.s_suppkey, t3.s_name, t3.s_address, t3.s_nationkey, t3.s_phone, t3.s_acctbal, t3.s_comment, t3.ps_partkey, t3.ps_suppkey, t3.ps_availqty, t3.ps_supplycost, t3.ps_comment, t3.n_nationkey, t3.n_name, t3.n_regionkey, t3.n_comment, t3.r_regionkey, t3.r_name, t3.r_comment, CAST(t9.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t9.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 48 AND p_type LIKE '%COPPER') AS t, supplier, partsupp WHERE t.p_partkey = partsupp.ps_partkey AND supplier.s_suppkey = partsupp.ps_suppkey) AS t0, nation WHERE t0.s_nationkey = nation.n_nationkey) AS t1, (SELECT * FROM region WHERE r_name = 'ASIA') AS t2 WHERE t1.n_regionkey = t2.r_regionkey) AS t3, (SELECT t5.ps_partkey, MIN(t5.ps_supplycost) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM partsupp AS partsupp0, supplier AS supplier0 WHERE supplier0.s_suppkey = partsupp0.ps_suppkey) AS t4, nation AS nation0 WHERE t4.s_nationkey = nation0.n_nationkey) AS t5, (SELECT * FROM region WHERE r_name = 'ASIA') AS t6 WHERE t5.n_regionkey = t6.r_regionkey GROUP BY t5.ps_partkey) AS t9 WHERE t3.p_partkey = t9.ps_partkey AND t3.ps_supplycost = t9.EXPR0 ORDER BY t3.s_acctbal DESC, t3.n_name, t3.s_name, t3.p_partkey) AS t12","['FILTER_INTO_JOIN', 'FILTER_MULTI_JOIN_MERGE', 'JOIN_EXTRACT_FILTER', 'JOIN_CONDITION_PUSH', 'JOIN_LEFT_UNION_TRANSPOSE', 'JOIN_RIGHT_UNION_TRANSPOSE', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE', 'PROJECT_REDUCE_EXPRESSIONS']","[""select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('SHIP', 'REG AIR') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1993-01-01' and l_receiptdate < date '1993-01-01' + interval '1' year group by l_shipmode order by l_shipmode;""]","[""['FILTER_INTO_JOIN', 'FILTER_MULTI_JOIN_MERGE', 'PROJECT_REDUCE_EXPRESSIONS', 'JOIN_EXTRACT_FILTER', 'JOIN_CONDITION_PUSH', 'JOIN_LEFT_UNION_TRANSPOSE', 'JOIN_RIGHT_UNION_TRANSPOSE', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'AGGREGATE_ANY_PULL_UP_CONSTANTS', 'AGGREGATE_REMOVE']""]"
328,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'BUILDING' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-15' and l_shipdate > date '1995-03-15' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'BUILDING' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-15' and l_shipdate > date '1995-03-15' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('31', '21', '36', '27', '23', '33', '38') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('31', '21', '36', '27', '23', '33', '38') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
329,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1995-04-01' and o_orderdate < date '1995-04-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1995-04-01' and o_orderdate < date '1995-04-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 25 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
330,tpch,"select o_year, sum(case when nation = 'FRANCE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD BRUSHED BRASS' ) as all_nations group by o_year order by o_year;","select o_year, sum(case when nation = 'FRANCE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD BRUSHED BRASS' ) as all_nations group by o_year order by o_year",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 10 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
331,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%chartreuse%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation.n_name AS nation, EXTRACT(YEAR FROM orders.o_orderdate) AS o_year, SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount) - partsupp.ps_supplycost * lineitem.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%chartreuse%') AS t CROSS JOIN supplier INNER JOIN lineitem ON supplier.s_suppkey = lineitem.l_suppkey AND t.p_partkey = lineitem.l_partkey INNER JOIN partsupp ON lineitem.l_suppkey = partsupp.ps_suppkey AND lineitem.l_partkey = partsupp.ps_partkey INNER JOIN orders ON lineitem.l_orderkey = orders.o_orderkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey GROUP BY nation.n_name, EXTRACT(YEAR FROM orders.o_orderdate) ORDER BY nation.n_name, EXTRACT(YEAR FROM orders.o_orderdate) DESC","['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_PROJECT_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE', 'SORT_PROJECT_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#11' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 5 and l_quantity <= 5 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#25' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 14 and l_quantity <= 14 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#51' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 24 and l_quantity <= 24 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_INTO_JOIN', 'FILTER_AGGREGATE_TRANSPOSE', 'JOIN_CONDITION_PUSH', 'PROJECT_CORRELATE_TRANSPOSE', 'PROJECT_INSTANCE', 'CALC_MERGE', 'CALC_REMOVE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE']""]"
332,tpch,"select ps_partkey, sum(ps_supplycost * ps_availqty) as value from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'ALGERIA' group by ps_partkey having sum(ps_supplycost * ps_availqty) > ( select sum(ps_supplycost * ps_availqty) * 0.0001000000 from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'ALGERIA' ) order by value desc;","select ps_partkey, sum(ps_supplycost * ps_availqty) as value from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'ALGERIA' group by ps_partkey having sum(ps_supplycost * ps_availqty) > ( select sum(ps_supplycost * ps_availqty) * 0.0001000000 from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'ALGERIA' ) order by value desc",[],"[""select o_year, sum(case when nation = 'UNITED KINGDOM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE POLISHED STEEL' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
333,tpch,"select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('RAIL', 'SHIP') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1996-01-01' and l_receiptdate < date '1996-01-01' + interval '1' year group by l_shipmode order by l_shipmode;","SELECT t.l_shipmode, SUM(CASE WHEN orders.o_orderpriority = '1-URGENT' OR orders.o_orderpriority = '2-HIGH' THEN 1 ELSE 0 END) AS high_line_count, SUM(CASE WHEN orders.o_orderpriority <> '1-URGENT' AND orders.o_orderpriority <> '2-HIGH' THEN 1 ELSE 0 END) AS low_line_count FROM orders INNER JOIN (SELECT * FROM lineitem WHERE l_shipmode IN ('RAIL', 'SHIP') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= DATE '1996-01-01' AND l_receiptdate < (DATE '1996-01-01' + INTERVAL '1' YEAR)) AS t ON orders.o_orderkey = t.l_orderkey GROUP BY t.l_shipmode ORDER BY t.l_shipmode","['FILTER_INTO_JOIN', 'FILTER_PROJECT_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE', 'SORT_PROJECT_TRANSPOSE']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#43' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 3 and l_quantity <= 3 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#53' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 15 and l_quantity <= 15 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#12' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 23 and l_quantity <= 23 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_INTO_JOIN', 'AGGREGATE_PROJECT_MERGE']""]"
334,tpch,"select 100.00 * sum(case when p_type like 'PROMO%' then l_extendedprice * (1 - l_discount) else 0 end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from lineitem, part where l_partkey = p_partkey and l_shipdate >= date '1996-12-01' and l_shipdate < date '1996-12-01' + interval '1' month;","select 100.00 * sum(case when p_type like 'PROMO%' then l_extendedprice * (1 - l_discount) else 0 end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from lineitem, part where l_partkey = p_partkey and l_shipdate >= date '1996-12-01' and l_shipdate < date '1996-12-01' + interval '1' month",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('35', '44', '38', '39', '34', '31', '41') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('35', '44', '38', '39', '34', '31', '41') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
335,tpch,"select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#15' and p_type not like 'PROMO PLATED%' and p_size in (13, 36, 11, 48, 7, 19, 4, 39) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;","select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#15' and p_type not like 'PROMO PLATED%' and p_size in (13, 36, 11, 48, 7, 19, 4, 39) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 39 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
336,tpch,"select sum(l_extendedprice) / 7.0 as avg_yearly from lineitem, part where p_partkey = l_partkey and p_brand = 'Brand#55' and p_container = 'LG BOX' and l_quantity < ( select 0.2 * avg(l_quantity) from lineitem where l_partkey = p_partkey );","SELECT SUM(lineitem.l_extendedprice) / 7.0 AS avg_yearly FROM lineitem INNER JOIN (SELECT * FROM part WHERE p_brand = 'Brand#55' AND p_container = 'LG BOX') AS t ON lineitem.l_partkey = t.p_partkey INNER JOIN (SELECT l_partkey, AVG(l_quantity) AS f1 FROM lineitem GROUP BY l_partkey) AS t1 ON t.p_partkey = t1.l_partkey AND lineitem.l_quantity < 0.2 * t1.f1","['FILTER_SCAN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_PROJECT_TRANSPOSE', 'AGGREGATE_ANY_PULL_UP_CONSTANTS', 'AGGREGATE_REMOVE']","[""select o_year, sum(case when nation = 'IRAQ' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE BRUSHED BRASS' ) as all_nations group by o_year order by o_year;""]","[""['FILTER_SCAN', 'JOIN_EXTRACT_FILTER', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_PROJECT_TRANSPOSE', 'PROJECT_REMOVE', 'PROJECT_CALC_MERGE', 'CALC_MERGE', 'CALC_REMOVE', 'UNION_MERGE', 'UNION_REMOVE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE']""]"
337,tpch,"select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#24' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 10 and l_quantity <= 10 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#15' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 17 and l_quantity <= 17 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#12' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 27 and l_quantity <= 27 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );","SELECT SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS revenue FROM lineitem, part WHERE part.p_partkey = lineitem.l_partkey AND part.p_brand = 'Brand#24' AND (part.p_container IN ('SM BOX', 'SM CASE', 'SM PACK', 'SM PKG') AND lineitem.l_quantity >= 10) AND (lineitem.l_quantity <= 10 + 10 AND (part.p_size >= 1 AND part.p_size <= 5) AND (lineitem.l_shipmode IN ('AIR', 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON')) OR part.p_partkey = lineitem.l_partkey AND part.p_brand = 'Brand#15' AND (part.p_container IN ('MED BAG', 'MED BOX', 'MED PACK', 'MED PKG') AND lineitem.l_quantity >= 17) AND (lineitem.l_quantity <= 17 + 10 AND (part.p_size >= 1 AND part.p_size <= 10) AND (lineitem.l_shipmode IN ('AIR', 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON')) OR part.p_partkey = lineitem.l_partkey AND part.p_brand = 'Brand#12' AND (part.p_container IN ('LG BOX', 'LG CASE', 'LG PACK', 'LG PKG') AND lineitem.l_quantity >= 27) AND (lineitem.l_quantity <= 27 + 10 AND (part.p_size >= 1 AND part.p_size <= 15) AND (lineitem.l_shipmode IN ('AIR', 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))","['FILTER_MERGE', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'AGGREGATE_REMOVE']","[""select o_year, sum(case when nation = 'IRAQ' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE POLISHED COPPER' ) as all_nations group by o_year order by o_year;""]","[""['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_TO_CALC', 'FILTER_INTO_JOIN']""]"
338,tpch,"select s_name, s_address from supplier, nation where s_suppkey in ( select ps_suppkey from partsupp where ps_partkey in ( select p_partkey from part where p_name like 'plum%' ) and ps_availqty > ( select 0.5 * sum(l_quantity) from lineitem where l_partkey = ps_partkey and l_suppkey = ps_suppkey and l_shipdate >= date '1993-01-01' and l_shipdate < date '1993-01-01' + interval '1' year ) ) and s_nationkey = n_nationkey and n_name = 'UNITED KINGDOM' order by s_name;","SELECT supplier.s_name, supplier.s_address FROM supplier INNER JOIN (SELECT * FROM nation WHERE n_name = 'UNITED KINGDOM') AS t ON supplier.s_nationkey = t.n_nationkey INNER JOIN (SELECT partsupp.ps_suppkey FROM partsupp INNER JOIN (SELECT p_partkey FROM part WHERE p_name LIKE 'plum%' GROUP BY p_partkey) AS t2 ON partsupp.ps_partkey = t2.p_partkey INNER JOIN (SELECT l_partkey, l_suppkey, SUM(l_quantity) AS f2 FROM lineitem WHERE l_shipdate >= DATE '1993-01-01' AND l_shipdate < (DATE '1993-01-01' + INTERVAL '1' YEAR) GROUP BY l_partkey, l_suppkey) AS t5 ON partsupp.ps_partkey = t5.l_partkey AND partsupp.ps_suppkey = t5.l_suppkey AND partsupp.ps_availqty > 0.5 * t5.f2 GROUP BY partsupp.ps_suppkey) AS t8 ON supplier.s_suppkey = t8.ps_suppkey ORDER BY supplier.s_name","['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'SORT_PROJECT_TRANSPOSE']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#55' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 3 and l_quantity <= 3 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#22' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 19 and l_quantity <= 19 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#31' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 29 and l_quantity <= 29 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH']""]"
339,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'EGYPT' group by s_name order by numwait desc, s_name;","SELECT t3.s_name, COUNT(*) AS numwait FROM (SELECT * FROM (SELECT supplier.s_suppkey, supplier.s_name, supplier.s_address, supplier.s_nationkey, supplier.s_phone, supplier.s_acctbal, supplier.s_comment, lineitem.l_orderkey, lineitem.l_partkey, lineitem.l_suppkey, lineitem.l_linenumber, lineitem.l_quantity, lineitem.l_extendedprice, lineitem.l_discount, lineitem.l_tax, lineitem.l_returnflag, lineitem.l_linestatus, lineitem.l_shipdate, lineitem.l_commitdate, lineitem.l_receiptdate, lineitem.l_shipinstruct, lineitem.l_shipmode, lineitem.l_comment, orders.o_orderkey, orders.o_custkey, orders.o_orderstatus, orders.o_totalprice, orders.o_orderdate, orders.o_orderpriority, orders.o_clerk, orders.o_shippriority, orders.o_comment, nation.n_nationkey, nation.n_name, nation.n_regionkey, nation.n_comment, t1.f2 AS f0 FROM supplier CROSS JOIN lineitem CROSS JOIN orders CROSS JOIN nation LEFT JOIN (SELECT t.l_orderkey AS l_orderkey0, t.l_suppkey AS l_suppkey0, MIN(TRUE) AS f2 FROM lineitem AS lineitem0 INNER JOIN (SELECT lineitem1.l_orderkey, lineitem1.l_suppkey FROM supplier AS supplier0, lineitem AS lineitem1, orders AS orders0, nation AS nation0 GROUP BY lineitem1.l_orderkey, lineitem1.l_suppkey) AS t ON lineitem0.l_orderkey = t.l_orderkey AND lineitem0.l_suppkey <> t.l_suppkey GROUP BY t.l_orderkey, t.l_suppkey) AS t1 ON lineitem.l_orderkey = t1.l_orderkey0 AND lineitem.l_suppkey = t1.l_suppkey0) AS t2 WHERE t2.s_suppkey = t2.l_suppkey AND (t2.o_orderkey = t2.l_orderkey AND t2.o_orderstatus = 'F') AND (t2.l_receiptdate > t2.l_commitdate AND t2.s_nationkey = t2.n_nationkey AND (t2.n_name = 'EGYPT' AND t2.f0 IS NOT NULL))) AS t3 LEFT JOIN (SELECT t10.l_orderkey AS l_orderkey0, t10.l_suppkey AS l_suppkey0, MIN(TRUE) AS f2 FROM (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t4 INNER JOIN (SELECT l_orderkey, l_suppkey FROM (SELECT supplier1.s_suppkey, supplier1.s_name, supplier1.s_address, supplier1.s_nationkey, supplier1.s_phone, supplier1.s_acctbal, supplier1.s_comment, lineitem3.l_orderkey, lineitem3.l_partkey, lineitem3.l_suppkey, lineitem3.l_linenumber, lineitem3.l_quantity, lineitem3.l_extendedprice, lineitem3.l_discount, lineitem3.l_tax, lineitem3.l_returnflag, lineitem3.l_linestatus, lineitem3.l_shipdate, lineitem3.l_commitdate, lineitem3.l_receiptdate, lineitem3.l_shipinstruct, lineitem3.l_shipmode, lineitem3.l_comment, orders1.o_orderkey, orders1.o_custkey, orders1.o_orderstatus, orders1.o_totalprice, orders1.o_orderdate, orders1.o_orderpriority, orders1.o_clerk, orders1.o_shippriority, orders1.o_comment, nation1.n_nationkey, nation1.n_name, nation1.n_regionkey, nation1.n_comment, t7.f2 AS f0 FROM supplier AS supplier1 CROSS JOIN lineitem AS lineitem3 CROSS JOIN orders AS orders1 CROSS JOIN nation AS nation1 LEFT JOIN (SELECT t5.l_orderkey AS l_orderkey0, t5.l_suppkey AS l_suppkey0, MIN(TRUE) AS f2 FROM lineitem AS lineitem4 INNER JOIN (SELECT lineitem5.l_orderkey, lineitem5.l_suppkey FROM supplier AS supplier2, lineitem AS lineitem5, orders AS orders2, nation AS nation2 GROUP BY lineitem5.l_orderkey, lineitem5.l_suppkey) AS t5 ON lineitem4.l_orderkey = t5.l_orderkey AND lineitem4.l_suppkey <> t5.l_suppkey GROUP BY t5.l_orderkey, t5.l_suppkey) AS t7 ON lineitem3.l_orderkey = t7.l_orderkey0 AND lineitem3.l_suppkey = t7.l_suppkey0) AS t8 WHERE t8.s_suppkey = t8.l_suppkey AND (t8.o_orderkey = t8.l_orderkey AND t8.o_orderstatus = 'F') AND (t8.l_receiptdate > t8.l_commitdate AND t8.s_nationkey = t8.n_nationkey AND (t8.n_name = 'EGYPT' AND t8.f0 IS NOT NULL)) GROUP BY l_orderkey, l_suppkey) AS t10 ON t4.l_orderkey = t10.l_orderkey AND t4.l_suppkey <> t10.l_suppkey GROUP BY t10.l_orderkey, t10.l_suppkey) AS t12 ON t3.l_orderkey = t12.l_orderkey0 AND t3.l_suppkey = t12.l_suppkey0 WHERE t12.f2 IS NULL GROUP BY t3.s_name ORDER BY COUNT(*) DESC, t3.s_name","['FILTER_AGGREGATE_TRANSPOSE', 'FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_MERGE', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE']","[""select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'SAUDI ARABIA' and n2.n_name = 'PERU') or (n1.n_name = 'PERU' and n2.n_name = 'SAUDI ARABIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;""]","[""['FILTER_AGGREGATE_TRANSPOSE', 'FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'SORT_UNION_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS', 'UNION_INSTANCE', 'PROJECT_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_UNION_TRANSPOSE', 'AGGREGATE_REMOVE']""]"
340,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('43', '22', '29', '20', '39', '24', '32') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('43', '22', '29', '20', '39', '24', '32') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(t.c_phone) + 1) < 1 THEN CHAR_LENGTH(t.c_phone) + 1 ELSE 1 END FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '43' OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '22' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '29') OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '20' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '39' OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '24' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '32'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '43' OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '22' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '29') OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '20' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '39' OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '24' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '32')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, MIN(TRUE) AS f1 FROM orders GROUP BY o_custkey) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f1 IS NULL GROUP BY SUBSTR(t.c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(t.c_phone) + 1) < 1 THEN CHAR_LENGTH(t.c_phone) + 1 ELSE 1 END FOR 2) ORDER BY SUBSTR(t.c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(t.c_phone) + 1) < 1 THEN CHAR_LENGTH(t.c_phone) + 1 ELSE 1 END FOR 2)","['FILTER_INTO_JOIN', 'FILTER_CORRELATE', 'AGGREGATE_PROJECT_MERGE', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS']","[""select o_year, sum(case when nation = 'VIETNAM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM BURNISHED COPPER' ) as all_nations group by o_year order by o_year;""]","[""['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_TO_CALC', 'FILTER_INTO_JOIN']""]"
341,tpch,"select l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order from lineitem where l_shipdate <= date '1998-12-01' - interval '91' day (3) group by l_returnflag, l_linestatus order by l_returnflag, l_linestatus;","SELECT l_returnflag, l_linestatus, SUM(l_quantity) AS sum_qty, SUM(l_extendedprice) AS sum_base_price, SUM(l_extendedprice * (1 - l_discount)) AS sum_disc_price, SUM(l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS sum_charge, AVG(l_quantity) AS avg_qty, AVG(l_extendedprice) AS avg_price, AVG(l_discount) AS avg_disc, COUNT(*) AS count_order FROM lineitem WHERE l_shipdate <= (DATE '1998-12-01' - INTERVAL '91' DAY(3)) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus","['FILTER_REDUCE_EXPRESSIONS', 'AGGREGATE_ANY_PULL_UP_CONSTANTS', 'SORT_PROJECT_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#32' and p_type not like 'MEDIUM PLATED%' and p_size in (8, 39, 9, 49, 37, 16, 43, 38) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_MERGE', 'PROJECT_REDUCE_EXPRESSIONS', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS', 'AGGREGATE_REMOVE']""]"
342,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 1 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t3.s_acctbal, t3.s_name, t3.n_name, t3.p_partkey, t3.p_mfgr, t3.s_address, t3.s_phone, t3.s_comment FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 1 AND p_type LIKE '%TIN') AS t, supplier, partsupp WHERE t.p_partkey = partsupp.ps_partkey AND supplier.s_suppkey = partsupp.ps_suppkey) AS t0, nation WHERE t0.s_nationkey = nation.n_nationkey) AS t1, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t2 WHERE t1.n_regionkey = t2.r_regionkey) AS t3, (SELECT t5.ps_partkey, MIN(t5.ps_supplycost) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM partsupp AS partsupp0, supplier AS supplier0 WHERE supplier0.s_suppkey = partsupp0.ps_suppkey) AS t4, nation AS nation0 WHERE t4.s_nationkey = nation0.n_nationkey) AS t5, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t6 WHERE t5.n_regionkey = t6.r_regionkey GROUP BY t5.ps_partkey) AS t9 WHERE t3.p_partkey = t9.ps_partkey AND t3.ps_supplycost = t9.EXPR0 ORDER BY t3.s_acctbal DESC, t3.n_name, t3.s_name, t3.p_partkey","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'AGGREGATE_REMOVE', 'SORT_REMOVE_CONSTANT_KEYS']","[""select o_year, sum(case when nation = 'ARGENTINA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD BRUSHED BRASS' ) as all_nations group by o_year order by o_year;""]","[""['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_TO_CALC', 'FILTER_INTO_JOIN']""]"
343,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'MACHINERY' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-27' and l_shipdate > date '1995-03-27' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t2.l_orderkey, SUM(t2.l_extendedprice * (1 - t2.l_discount)) AS revenue, t1.o_orderdate, t1.o_shippriority FROM (SELECT * FROM (SELECT * FROM customer WHERE c_mktsegment = 'MACHINERY') AS t, (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-27') AS t0 WHERE t.c_custkey = t0.o_custkey) AS t1, (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-27') AS t2 WHERE t2.l_orderkey = t1.o_orderkey GROUP BY t2.l_orderkey, t1.o_orderdate, t1.o_shippriority ORDER BY SUM(t2.l_extendedprice * (1 - t2.l_discount)) DESC, t1.o_orderdate","['FILTER_SCAN', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_INTO_JOIN', 'FILTER_CORRELATE', 'FILTER_MERGE', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH', 'JOIN_EXTRACT_FILTER', 'JOIN_PROJECT_RIGHT_TRANSPOSE', 'JOIN_RIGHT_UNION_TRANSPOSE', 'JOIN_LEFT_UNION_TRANSPOSE', 'JOIN_PROJECT_LEFT_TRANSPOSE', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'SEMI_JOIN_REMOVE', 'JOIN_REDUCE_EXPRESSIONS', 'AGGREGATE_ANY_PULL_UP_CONSTANTS', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'AGGREGATE_PROJECT_MERGE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE']","[""select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from customer, orders, lineitem, nation where c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate >= date '1994-02-01' and o_orderdate < date '1994-02-01' + interval '3' month and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc;""]","[""['FILTER_SCAN', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_INTO_JOIN', 'FILTER_CORRELATE', 'FILTER_INSTANCE', 'FILTER_MERGE', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'PROJECT_INSTANCE', 'PROJECT_REMOVE', 'PROJECT_CALC_MERGE', 'SORT_INSTANCE', 'SORT_REMOVE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_FETCH_ZERO_INSTANCE', 'SORT_UNION_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'JOIN_CONDITION_PUSH', 'JOIN_EXTRACT_FILTER', 'JOIN_PROJECT_RIGHT_TRANSPOSE', 'JOIN_RIGHT_UNION_TRANSPOSE', 'JOIN_LEFT_UNION_TRANSPOSE', 'JOIN_PROJECT_LEFT_TRANSPOSE', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'SEMI_JOIN_REMOVE', 'JOIN_REDUCE_EXPRESSIONS', 'UNION_REMOVE', 'UNION_INSTANCE', 'UNION_MERGE', 'UNION_TO_DISTINCT', 'INTERSECT_INSTANCE', 'MINUS_INSTANCE', 'AGGREGATE_ANY_PULL_UP_CONSTANTS', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'AGGREGATE_VALUES']""]"
344,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1997-03-01' and o_orderdate < date '1997-03-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","SELECT t.o_orderpriority, COUNT(*) AS order_count FROM (SELECT * FROM orders WHERE o_orderdate >= DATE '1997-03-01' AND o_orderdate < (DATE '1997-03-01' + INTERVAL '3' MONTH)) AS t INNER JOIN (SELECT l_orderkey, MIN(TRUE) AS f1 FROM lineitem WHERE l_commitdate < l_receiptdate GROUP BY l_orderkey) AS t2 ON t.o_orderkey = t2.l_orderkey GROUP BY t.o_orderpriority ORDER BY t.o_orderpriority","['FILTER_MERGE', 'FILTER_CORRELATE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'FILTER_PROJECT_TRANSPOSE', 'SORT_REMOVE']","[""select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('TRUCK', 'AIR') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1993-01-01' and l_receiptdate < date '1993-01-01' + interval '1' year group by l_shipmode order by l_shipmode;""]","[""['FILTER_MERGE', 'FILTER_INTO_JOIN', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'FILTER_PROJECT_TRANSPOSE', 'SORT_REMOVE']""]"
345,tpch,select sum(l_extendedprice * l_discount) as revenue from lineitem where l_shipdate >= date '1996-01-01' and l_shipdate < date '1996-01-01' + interval '1' year and l_discount between 0.04 - 0.01 and 0.04 + 0.01 and l_quantity < 24;,SELECT SUM(l_extendedprice * l_discount) AS revenue FROM lineitem WHERE l_shipdate >= DATE '1996-01-01' AND l_shipdate < (DATE '1996-01-01' + INTERVAL '1' YEAR) AND l_discount >= 0.04 - 0.01 AND l_discount <= 0.04 + 0.01 AND l_quantity < 24,"['FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#33' and p_type not like 'ECONOMY BRUSHED%' and p_size in (23, 15, 39, 46, 33, 20, 9, 4) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'FILTER_SCAN', 'FILTER_MERGE', 'PROJECT_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'SORT_REMOVE', 'UNION_REMOVE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_UNION_TRANSPOSE']""]"
346,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'GERMANY' and n2.n_name = 'IRAN') or (n1.n_name = 'IRAN' and n2.n_name = 'GERMANY') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'GERMANY' and n2.n_name = 'IRAN') or (n1.n_name = 'IRAN' and n2.n_name = 'GERMANY') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('37', '34', '25', '38', '42', '24', '20') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('37', '34', '25', '38', '42', '24', '20') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
347,tpch,"select o_year, sum(case when nation = 'IRAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM BURNISHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t0.o_orderdate) AS o_year, SUM(CASE WHEN nation0.n_name = 'IRAN' THEN lineitem.l_extendedprice * (1 - lineitem.l_discount) ELSE 0 END) / SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'MEDIUM BURNISHED TIN') AS t CROSS JOIN supplier INNER JOIN lineitem ON t.p_partkey = lineitem.l_partkey AND supplier.s_suppkey = lineitem.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t0 ON lineitem.l_orderkey = t0.o_orderkey INNER JOIN customer ON t0.o_custkey = customer.c_custkey INNER JOIN nation ON customer.c_nationkey = nation.n_nationkey INNER JOIN nation AS nation0 ON supplier.s_nationkey = nation0.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t1 ON nation.n_regionkey = t1.r_regionkey GROUP BY EXTRACT(YEAR FROM t0.o_orderdate) ORDER BY EXTRACT(YEAR FROM t0.o_orderdate)","['FILTER_PROJECT_TRANSPOSE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'AGGREGATE_PROJECT_MERGE']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#43' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 3 and l_quantity <= 3 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#11' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 17 and l_quantity <= 17 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#24' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 30 and l_quantity <= 30 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_PROJECT_TRANSPOSE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'JOIN_LEFT_UNION_TRANSPOSE']""]"
348,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%green%' ) as profit group by nation, o_year order by nation, o_year desc;","select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%green%' ) as profit group by nation, o_year order by nation, o_year desc",[],"[""select o_year, sum(case when nation = 'UNITED KINGDOM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL PLATED NICKEL' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
349,tpch,"select ps_partkey, sum(ps_supplycost * ps_availqty) as value from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'FRANCE' group by ps_partkey having sum(ps_supplycost * ps_availqty) > ( select sum(ps_supplycost * ps_availqty) * 0.0001000000 from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'FRANCE' ) order by value desc;","select ps_partkey, sum(ps_supplycost * ps_availqty) as value from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'FRANCE' group by ps_partkey having sum(ps_supplycost * ps_availqty) > ( select sum(ps_supplycost * ps_availqty) * 0.0001000000 from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'FRANCE' ) order by value desc",[],"[""select o_year, sum(case when nation = 'ETHIOPIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO BRUSHED NICKEL' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
350,tpch,"select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('RAIL', 'TRUCK') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1993-01-01' and l_receiptdate < date '1993-01-01' + interval '1' year group by l_shipmode order by l_shipmode;","select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('RAIL', 'TRUCK') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1993-01-01' and l_receiptdate < date '1993-01-01' + interval '1' year group by l_shipmode order by l_shipmode",[],"[""select o_year, sum(case when nation = 'MOZAMBIQUE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO BRUSHED COPPER' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
351,tpch,"select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#21' and p_type not like 'LARGE ANODIZED%' and p_size in (3, 37, 23, 5, 15, 26, 18, 43) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;","select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#21' and p_type not like 'LARGE ANODIZED%' and p_size in (3, 37, 23, 5, 15, 26, 18, 43) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 27 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
352,tpch,"select sum(l_extendedprice) / 7.0 as avg_yearly from lineitem, part where p_partkey = l_partkey and p_brand = 'Brand#13' and p_container = 'SM BOX' and l_quantity < ( select 0.2 * avg(l_quantity) from lineitem where l_partkey = p_partkey );","SELECT SUM(lineitem.l_extendedprice) / 7.0 AS avg_yearly FROM lineitem INNER JOIN (SELECT * FROM part WHERE p_brand = 'Brand#13' AND p_container = 'SM BOX') AS t ON lineitem.l_partkey = t.p_partkey INNER JOIN (SELECT l_partkey, AVG(l_quantity) AS f1 FROM lineitem GROUP BY l_partkey) AS t1 ON t.p_partkey = t1.l_partkey AND lineitem.l_quantity < 0.2 * t1.f1","['FILTER_INTO_JOIN', 'FILTER_REDUCE_EXPRESSIONS']","[""select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'KENYA' and n2.n_name = 'MOZAMBIQUE') or (n1.n_name = 'MOZAMBIQUE' and n2.n_name = 'KENYA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;""]","[""['FILTER_INTO_JOIN']""]"
353,tpch,"select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#14' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 3 and l_quantity <= 3 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#31' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 19 and l_quantity <= 19 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#23' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 26 and l_quantity <= 26 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );","select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#14' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 3 and l_quantity <= 3 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#31' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 19 and l_quantity <= 19 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#23' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 26 and l_quantity <= 26 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' )",[],"[""select o_year, sum(case when nation = 'BRAZIL' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO PLATED BRASS' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
354,tpch,"select s_name, s_address from supplier, nation where s_suppkey in ( select ps_suppkey from partsupp where ps_partkey in ( select p_partkey from part where p_name like 'powder%' ) and ps_availqty > ( select 0.5 * sum(l_quantity) from lineitem where l_partkey = ps_partkey and l_suppkey = ps_suppkey and l_shipdate >= date '1995-01-01' and l_shipdate < date '1995-01-01' + interval '1' year ) ) and s_nationkey = n_nationkey and n_name = 'ALGERIA' order by s_name;","SELECT supplier.s_name, supplier.s_address FROM supplier INNER JOIN (SELECT * FROM nation WHERE n_name = 'ALGERIA') AS t ON supplier.s_nationkey = t.n_nationkey INNER JOIN (SELECT partsupp.ps_suppkey FROM partsupp INNER JOIN (SELECT p_partkey FROM part WHERE p_name LIKE 'powder%' GROUP BY p_partkey) AS t2 ON partsupp.ps_partkey = t2.p_partkey INNER JOIN (SELECT l_partkey, l_suppkey, SUM(l_quantity) AS f2 FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate < (DATE '1995-01-01' + INTERVAL '1' YEAR) GROUP BY l_partkey, l_suppkey) AS t5 ON partsupp.ps_partkey = t5.l_partkey AND partsupp.ps_suppkey = t5.l_suppkey AND partsupp.ps_availqty > 0.5 * t5.f2 GROUP BY partsupp.ps_suppkey) AS t8 ON supplier.s_suppkey = t8.ps_suppkey ORDER BY supplier.s_name","['FILTER_SCAN', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS']","[""select 100.00 * sum(case when p_type like 'PROMO%' then l_extendedprice * (1 - l_discount) else 0 end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from lineitem, part where l_partkey = p_partkey and l_shipdate >= date '1997-02-01' and l_shipdate < date '1997-02-01' + interval '1' month;""]","[""['FILTER_SCAN', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'PROJECT_CALC_MERGE', 'PROJECT_CORRELATE_TRANSPOSE', 'CALC_MERGE', 'CALC_REMOVE', 'AGGREGATE_PROJECT_MERGE']""]"
355,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'IRAN' group by s_name order by numwait desc, s_name;","SELECT t5.s_name, COUNT(*) AS numwait FROM (SELECT supplier.s_suppkey, supplier.s_name, supplier.s_address, supplier.s_nationkey, supplier.s_phone, supplier.s_acctbal, supplier.s_comment, lineitem.l_orderkey, lineitem.l_partkey, lineitem.l_suppkey, lineitem.l_linenumber, lineitem.l_quantity, lineitem.l_extendedprice, lineitem.l_discount, lineitem.l_tax, lineitem.l_returnflag, lineitem.l_linestatus, lineitem.l_shipdate, lineitem.l_commitdate, lineitem.l_receiptdate, lineitem.l_shipinstruct, lineitem.l_shipmode, lineitem.l_comment, orders.o_orderkey, orders.o_custkey, orders.o_orderstatus, orders.o_totalprice, orders.o_orderdate, orders.o_orderpriority, orders.o_clerk, orders.o_shippriority, orders.o_comment, nation.n_nationkey, nation.n_name, nation.n_regionkey, nation.n_comment, t3.f2 AS f0 FROM supplier CROSS JOIN lineitem CROSS JOIN orders CROSS JOIN nation LEFT JOIN (SELECT t0.l_orderkey AS l_orderkey0, t0.l_suppkey AS l_suppkey0, MIN(TRUE) AS f2 FROM lineitem AS lineitem0, (SELECT lineitem1.l_orderkey, lineitem1.l_suppkey FROM supplier AS supplier0, lineitem AS lineitem1, orders AS orders0, nation AS nation0 GROUP BY lineitem1.l_orderkey, lineitem1.l_suppkey) AS t0 WHERE lineitem0.l_orderkey = t0.l_orderkey AND lineitem0.l_suppkey <> t0.l_suppkey GROUP BY t0.l_orderkey, t0.l_suppkey) AS t3 ON lineitem.l_orderkey = t3.l_orderkey0 AND lineitem.l_suppkey = t3.l_suppkey0 WHERE supplier.s_suppkey = lineitem.l_suppkey AND (orders.o_orderkey = lineitem.l_orderkey AND orders.o_orderstatus = 'F') AND (lineitem.l_receiptdate > lineitem.l_commitdate AND supplier.s_nationkey = nation.n_nationkey AND (nation.n_name = 'IRAN' AND t3.f2 IS NOT NULL))) AS t5 LEFT JOIN (SELECT t15.l_orderkey AS l_orderkey0, t15.l_suppkey AS l_suppkey0, MIN(TRUE) AS f2 FROM (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t6, (SELECT lineitem3.l_orderkey, lineitem3.l_suppkey FROM supplier AS supplier1 CROSS JOIN lineitem AS lineitem3 CROSS JOIN orders AS orders1 CROSS JOIN nation AS nation1 LEFT JOIN (SELECT t8.l_orderkey AS l_orderkey0, t8.l_suppkey AS l_suppkey0, MIN(TRUE) AS f2 FROM lineitem AS lineitem4, (SELECT lineitem5.l_orderkey, lineitem5.l_suppkey FROM supplier AS supplier2, lineitem AS lineitem5, orders AS orders2, nation AS nation2 GROUP BY lineitem5.l_orderkey, lineitem5.l_suppkey) AS t8 WHERE lineitem4.l_orderkey = t8.l_orderkey AND lineitem4.l_suppkey <> t8.l_suppkey GROUP BY t8.l_orderkey, t8.l_suppkey) AS t11 ON lineitem3.l_orderkey = t11.l_orderkey0 AND lineitem3.l_suppkey = t11.l_suppkey0 WHERE supplier1.s_suppkey = lineitem3.l_suppkey AND (orders1.o_orderkey = lineitem3.l_orderkey AND orders1.o_orderstatus = 'F') AND (lineitem3.l_receiptdate > lineitem3.l_commitdate AND supplier1.s_nationkey = nation1.n_nationkey AND (nation1.n_name = 'IRAN' AND t11.f2 IS NOT NULL)) GROUP BY lineitem3.l_orderkey, lineitem3.l_suppkey) AS t15 WHERE t6.l_orderkey = t15.l_orderkey AND t6.l_suppkey <> t15.l_suppkey GROUP BY t15.l_orderkey, t15.l_suppkey) AS t18 ON t5.l_orderkey = t18.l_orderkey0 AND t5.l_suppkey = t18.l_suppkey0 WHERE t18.f2 IS NULL GROUP BY t5.s_name ORDER BY COUNT(*) DESC, t5.s_name","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_PROJECT_TRANSPOSE']","[""select o_year, sum(case when nation = 'FRANCE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE POLISHED NICKEL' ) as all_nations group by o_year order by o_year;""]","[""['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_TO_CALC', 'FILTER_INTO_JOIN']""]"
356,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('20', '26', '32', '28', '41', '36', '22') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('20', '26', '32', '28', '41', '36', '22') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('20', '26', '32', '28', '41', '36', '22') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('20', '26', '32', '28', '41', '36', '22') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('32', '42', '27', '38', '24', '40', '33') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('32', '42', '27', '38', '24', '40', '33') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
357,tpch,"select l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order from lineitem where l_shipdate <= date '1998-12-01' - interval '83' day (3) group by l_returnflag, l_linestatus order by l_returnflag, l_linestatus;","SELECT l_returnflag, l_linestatus, SUM(l_quantity) AS sum_qty, SUM(l_extendedprice) AS sum_base_price, SUM(l_extendedprice * (1 - l_discount)) AS sum_disc_price, SUM(l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS sum_charge, AVG(l_quantity) AS avg_qty, AVG(l_extendedprice) AS avg_price, AVG(l_discount) AS avg_disc, COUNT(*) AS count_order FROM lineitem WHERE l_shipdate <= (DATE '1998-12-01' - INTERVAL '83' DAY(3)) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus","['FILTER_AGGREGATE_TRANSPOSE', 'SORT_REMOVE', 'SORT_REMOVE_CONSTANT_KEYS']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#53' and p_type not like 'STANDARD BURNISHED%' and p_size in (22, 46, 4, 1, 5, 9, 47, 28) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_INTO_JOIN', 'FILTER_AGGREGATE_TRANSPOSE', 'SORT_REMOVE', 'SORT_REMOVE_CONSTANT_KEYS']""]"
358,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 49 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t3.s_acctbal, t3.s_name, t3.n_name, t3.p_partkey, t3.p_mfgr, t3.s_address, t3.s_phone, t3.s_comment FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 49 AND p_type LIKE '%TIN') AS t, supplier, partsupp WHERE t.p_partkey = partsupp.ps_partkey AND supplier.s_suppkey = partsupp.ps_suppkey) AS t0, nation WHERE t0.s_nationkey = nation.n_nationkey) AS t1, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t2 WHERE t1.n_regionkey = t2.r_regionkey) AS t3, (SELECT t5.ps_partkey, MIN(t5.ps_supplycost) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM partsupp AS partsupp0, supplier AS supplier0 WHERE supplier0.s_suppkey = partsupp0.ps_suppkey) AS t4, nation AS nation0 WHERE t4.s_nationkey = nation0.n_nationkey) AS t5, (SELECT * FROM region WHERE r_name = 'MIDDLE EAST') AS t6 WHERE t5.n_regionkey = t6.r_regionkey GROUP BY t5.ps_partkey) AS t9 WHERE t3.p_partkey = t9.ps_partkey AND t3.ps_supplycost = t9.EXPR0 ORDER BY t3.s_acctbal DESC, t3.n_name, t3.s_name, t3.p_partkey","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_REDUCE_EXPRESSIONS', 'SORT_REMOVE_CONSTANT_KEYS']","[""select o_year, sum(case when nation = 'CANADA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY PLATED STEEL' ) as all_nations group by o_year order by o_year;""]","[""['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_TO_CALC', 'FILTER_INTO_JOIN']""]"
359,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1997-02-01' and o_orderdate < date '1997-02-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1997-02-01' and o_orderdate < date '1997-02-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority",[],"[""select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1997-10-01' and o_orderdate < date '1997-10-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;""]","[""['Empty List']""]"
360,tpch,select sum(l_extendedprice * l_discount) as revenue from lineitem where l_shipdate >= date '1997-01-01' and l_shipdate < date '1997-01-01' + interval '1' year and l_discount between 0.08 - 0.01 and 0.08 + 0.01 and l_quantity < 25;,select sum(l_extendedprice * l_discount) as revenue from lineitem where l_shipdate >= date '1997-01-01' and l_shipdate < date '1997-01-01' + interval '1' year and l_discount between 0.08 - 0.01 and 0.08 + 0.01 and l_quantity < 25,[],"[""select o_year, sum(case when nation = 'IRAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD BRUSHED STEEL' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
361,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'SAUDI ARABIA' and n2.n_name = 'VIETNAM') or (n1.n_name = 'VIETNAM' and n2.n_name = 'SAUDI ARABIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation.n_name AS supp_nation, nation0.n_name AS cust_nation, EXTRACT(YEAR FROM t.l_shipdate) AS l_year, SUM(t.l_extendedprice * (1 - t.l_discount)) AS revenue FROM supplier INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t ON supplier.s_suppkey = t.l_suppkey INNER JOIN orders ON t.l_orderkey = orders.o_orderkey INNER JOIN customer ON orders.o_custkey = customer.c_custkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey INNER JOIN nation AS nation0 ON customer.c_nationkey = nation0.n_nationkey AND (nation.n_name = 'SAUDI ARABIA' AND nation0.n_name = 'VIETNAM' OR nation.n_name = 'VIETNAM' AND nation0.n_name = 'SAUDI ARABIA') GROUP BY nation.n_name, nation0.n_name, EXTRACT(YEAR FROM t.l_shipdate) ORDER BY nation.n_name, nation0.n_name, EXTRACT(YEAR FROM t.l_shipdate)","['FILTER_AGGREGATE_TRANSPOSE', 'FILTER_INTO_JOIN', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE', 'SORT_REMOVE_CONSTANT_KEYS']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#52' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 1 and l_quantity <= 1 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#31' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 12 and l_quantity <= 12 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#14' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 22 and l_quantity <= 22 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_AGGREGATE_TRANSPOSE', 'FILTER_INTO_JOIN', 'AGGREGATE_PROJECT_MERGE']""]"
362,tpch,"select o_year, sum(case when nation = 'VIETNAM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL BRUSHED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t0.o_orderdate) AS o_year, SUM(CASE WHEN nation0.n_name = 'VIETNAM' THEN lineitem.l_extendedprice * (1 - lineitem.l_discount) ELSE 0 END) / SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'SMALL BRUSHED STEEL') AS t CROSS JOIN supplier INNER JOIN lineitem ON t.p_partkey = lineitem.l_partkey AND supplier.s_suppkey = lineitem.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t0 ON lineitem.l_orderkey = t0.o_orderkey INNER JOIN customer ON t0.o_custkey = customer.c_custkey INNER JOIN nation ON customer.c_nationkey = nation.n_nationkey INNER JOIN nation AS nation0 ON supplier.s_nationkey = nation0.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'ASIA') AS t1 ON nation.n_regionkey = t1.r_regionkey GROUP BY EXTRACT(YEAR FROM t0.o_orderdate) ORDER BY EXTRACT(YEAR FROM t0.o_orderdate)","['JOIN_CONDITION_PUSH', 'FILTER_INTO_JOIN', 'FILTER_AGGREGATE_TRANSPOSE', 'PROJECT_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE', 'SORT_REMOVE_CONSTANT_KEYS']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#54' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 10 and l_quantity <= 10 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#34' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 14 and l_quantity <= 14 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#35' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 21 and l_quantity <= 21 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_INTO_JOIN', 'FILTER_AGGREGATE_TRANSPOSE', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'SORT_REMOVE', 'JOIN_LEFT_INSTANCE', 'SORT_INSTANCE', 'FILTER_INSTANCE', 'AGGREGATE_INSTANCE']""]"
363,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%frosted%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation.n_name AS nation, EXTRACT(YEAR FROM orders.o_orderdate) AS o_year, SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount) - partsupp.ps_supplycost * lineitem.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%frosted%') AS t CROSS JOIN supplier INNER JOIN lineitem ON supplier.s_suppkey = lineitem.l_suppkey AND t.p_partkey = lineitem.l_partkey INNER JOIN partsupp ON lineitem.l_suppkey = partsupp.ps_suppkey AND lineitem.l_partkey = partsupp.ps_partkey INNER JOIN orders ON lineitem.l_orderkey = orders.o_orderkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey GROUP BY nation.n_name, EXTRACT(YEAR FROM orders.o_orderdate) ORDER BY nation.n_name, EXTRACT(YEAR FROM orders.o_orderdate) DESC","['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_PROJECT_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE', 'SORT_PROJECT_TRANSPOSE']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#11' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 8 and l_quantity <= 8 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#34' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 11 and l_quantity <= 11 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#45' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 21 and l_quantity <= 21 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_REMOVE']""]"
364,tpch,"select ps_partkey, sum(ps_supplycost * ps_availqty) as value from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'GERMANY' group by ps_partkey having sum(ps_supplycost * ps_availqty) > ( select sum(ps_supplycost * ps_availqty) * 0.0001000000 from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'GERMANY' ) order by value desc;","SELECT t1.ps_partkey, t1.value FROM (SELECT partsupp.ps_partkey, SUM(partsupp.ps_supplycost * partsupp.ps_availqty) AS value FROM partsupp INNER JOIN supplier ON partsupp.ps_suppkey = supplier.s_suppkey INNER JOIN (SELECT * FROM nation WHERE n_name = 'GERMANY') AS t ON supplier.s_nationkey = t.n_nationkey GROUP BY partsupp.ps_partkey) AS t1 INNER JOIN (SELECT SUM(partsupp0.ps_supplycost * partsupp0.ps_availqty) * 0.0001000000 AS EXPR0 FROM partsupp AS partsupp0 INNER JOIN supplier AS supplier0 ON partsupp0.ps_suppkey = supplier0.s_suppkey INNER JOIN (SELECT * FROM nation WHERE n_name = 'GERMANY') AS t2 ON supplier0.s_nationkey = t2.n_nationkey) AS t5 ON t1.value > t5.EXPR0 ORDER BY t1.value DESC","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'AGGREGATE_PROJECT_MERGE']","[""select o_year, sum(case when nation = 'ARGENTINA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO POLISHED STEEL' ) as all_nations group by o_year order by o_year;""]","[""['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN']""]"
365,tpch,"select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('REG AIR', 'RAIL') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1993-01-01' and l_receiptdate < date '1993-01-01' + interval '1' year group by l_shipmode order by l_shipmode;","SELECT t.l_shipmode, SUM(CASE WHEN orders.o_orderpriority = '1-URGENT' OR orders.o_orderpriority = '2-HIGH' THEN 1 ELSE 0 END) AS high_line_count, SUM(CASE WHEN orders.o_orderpriority <> '1-URGENT' AND orders.o_orderpriority <> '2-HIGH' THEN 1 ELSE 0 END) AS low_line_count FROM orders, (SELECT * FROM lineitem WHERE l_shipmode IN ('RAIL', 'REG AIR') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= DATE '1993-01-01' AND l_receiptdate < (DATE '1993-01-01' + INTERVAL '1' YEAR)) AS t WHERE orders.o_orderkey = t.l_orderkey GROUP BY t.l_shipmode ORDER BY t.l_shipmode","['FILTER_INTO_JOIN', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_EXTRACT_FILTER', 'JOIN_CONDITION_PUSH']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#51' and p_type not like 'SMALL POLISHED%' and p_size in (4, 6, 9, 29, 43, 37, 24, 18) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_EXTRACT_FILTER', 'JOIN_CONDITION_PUSH', 'PROJECT_REMOVE', 'SORT_REMOVE_CONSTANT_KEYS']""]"
366,tpch,"select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#32' and p_type not like 'ECONOMY BURNISHED%' and p_size in (38, 7, 10, 3, 11, 37, 33, 41) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;","SELECT t6.p_brand, t6.p_type, t6.p_size, COUNT(t6.ps_suppkey) AS supplier_cnt FROM (SELECT t0.p_brand, t0.p_type, t0.p_size, t0.ps_suppkey FROM (SELECT * FROM (SELECT partsupp.ps_partkey, partsupp.ps_suppkey, partsupp.ps_availqty, partsupp.ps_supplycost, partsupp.ps_comment, part.p_partkey, part.p_name, part.p_mfgr, part.p_brand, part.p_type, part.p_size, part.p_container, part.p_retailprice, part.p_comment, partsupp.ps_suppkey AS ps_suppkey0 FROM partsupp, part) AS t WHERE t.p_partkey = t.ps_partkey AND CAST(t.p_brand AS CHAR(8)) <> 'Brand#32' AND t.p_size IN (3, 7, 10, 11, 33, 37, 38, 41) AND t.p_type NOT LIKE 'ECONOMY BURNISHED%') AS t0 LEFT JOIN (SELECT s_suppkey, MIN(TRUE) AS f1 FROM supplier WHERE s_comment LIKE '%Customer%Complaints%' GROUP BY s_suppkey) AS t3 ON t0.ps_suppkey0 = t3.s_suppkey WHERE t3.f1 IS NOT TRUE GROUP BY t0.p_brand, t0.p_type, t0.p_size, t0.ps_suppkey) AS t6 GROUP BY t6.p_brand, t6.p_type, t6.p_size ORDER BY COUNT(t6.ps_suppkey) DESC, t6.p_brand, t6.p_type, t6.p_size","['AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'FILTER_INTO_JOIN', 'SORT_REMOVE']","[""select o_year, sum(case when nation = 'JAPAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD BURNISHED BRASS' ) as all_nations group by o_year order by o_year;""]","[""['SORT_REMOVE', 'PROJECT_REMOVE', 'FILTER_INTO_JOIN']""]"
367,tpch,"select sum(l_extendedprice) / 7.0 as avg_yearly from lineitem, part where p_partkey = l_partkey and p_brand = 'Brand#24' and p_container = 'JUMBO PKG' and l_quantity < ( select 0.2 * avg(l_quantity) from lineitem where l_partkey = p_partkey );","SELECT SUM(lineitem.l_extendedprice) / 7.0 AS avg_yearly FROM lineitem INNER JOIN (SELECT * FROM part WHERE p_brand = 'Brand#24' AND p_container = 'JUMBO PKG') AS t ON lineitem.l_partkey = t.p_partkey INNER JOIN (SELECT l_partkey, AVG(l_quantity) AS f1 FROM lineitem GROUP BY l_partkey) AS t1 ON t.p_partkey = t1.l_partkey AND lineitem.l_quantity < 0.2 * t1.f1","['FILTER_CORRELATE', 'FILTER_INTO_JOIN']","[""select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'GERMANY' and n2.n_name = 'JAPAN') or (n1.n_name = 'JAPAN' and n2.n_name = 'GERMANY') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;""]","[""['FILTER_INTO_JOIN']""]"
368,tpch,"select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#41' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 7 and l_quantity <= 7 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#11' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 18 and l_quantity <= 18 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#14' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 28 and l_quantity <= 28 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );","select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#41' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 7 and l_quantity <= 7 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#11' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 18 and l_quantity <= 18 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#14' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 28 and l_quantity <= 28 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' )",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('31', '40', '22', '26', '39', '35', '21') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('31', '40', '22', '26', '39', '35', '21') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
369,tpch,"select s_name, s_address from supplier, nation where s_suppkey in ( select ps_suppkey from partsupp where ps_partkey in ( select p_partkey from part where p_name like 'brown%' ) and ps_availqty > ( select 0.5 * sum(l_quantity) from lineitem where l_partkey = ps_partkey and l_suppkey = ps_suppkey and l_shipdate >= date '1993-01-01' and l_shipdate < date '1993-01-01' + interval '1' year ) ) and s_nationkey = n_nationkey and n_name = 'CANADA' order by s_name;","SELECT supplier.s_name, supplier.s_address FROM supplier INNER JOIN (SELECT * FROM nation WHERE n_name = 'CANADA') AS t ON supplier.s_nationkey = t.n_nationkey INNER JOIN (SELECT partsupp.ps_suppkey FROM partsupp INNER JOIN (SELECT p_partkey FROM part WHERE p_name LIKE 'brown%' GROUP BY p_partkey) AS t2 ON partsupp.ps_partkey = t2.p_partkey INNER JOIN (SELECT l_partkey, l_suppkey, SUM(l_quantity) AS f2 FROM lineitem WHERE l_shipdate >= DATE '1993-01-01' AND l_shipdate < (DATE '1993-01-01' + INTERVAL '1' YEAR) GROUP BY l_partkey, l_suppkey) AS t5 ON partsupp.ps_partkey = t5.l_partkey AND partsupp.ps_suppkey = t5.l_suppkey AND partsupp.ps_availqty > 0.5 * t5.f2 GROUP BY partsupp.ps_suppkey) AS t8 ON supplier.s_suppkey = t8.ps_suppkey ORDER BY supplier.s_name","['FILTER_INTO_JOIN', 'FILTER_MERGE', 'JOIN_CONDITION_PUSH']","[""select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%lawn%' ) as profit group by nation, o_year order by nation, o_year desc;""]","[""['FILTER_INTO_JOIN']""]"
370,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('23', '24', '37', '36', '40', '41', '27') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('23', '24', '37', '36', '40', '41', '27') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('23', '24', '37', '36', '40', '41', '27') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('23', '24', '37', '36', '40', '41', '27') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode",[],"[""select o_year, sum(case when nation = 'MOZAMBIQUE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY BRUSHED NICKEL' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
371,tpch,"select l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order from lineitem where l_shipdate <= date '1998-12-01' - interval '74' day (3) group by l_returnflag, l_linestatus order by l_returnflag, l_linestatus;","SELECT l_returnflag, l_linestatus, SUM(l_quantity) AS sum_qty, SUM(l_extendedprice) AS sum_base_price, SUM(l_extendedprice * (1 - l_discount)) AS sum_disc_price, SUM(l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS sum_charge, AVG(l_quantity) AS avg_qty, AVG(l_extendedprice) AS avg_price, AVG(l_discount) AS avg_disc, COUNT(*) AS count_order FROM lineitem WHERE l_shipdate <= (DATE '1998-12-01' - INTERVAL '74' DAY(3)) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus","['FILTER_AGGREGATE_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE']","[""select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('TRUCK', 'SHIP') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1995-01-01' and l_receiptdate < date '1995-01-01' + interval '1' year group by l_shipmode order by l_shipmode;""]","[""['FILTER_INTO_JOIN', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_PROJECT_MERGE']""]"
372,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 28 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT supplier.s_acctbal, supplier.s_name, nation.n_name, t.p_partkey, t.p_mfgr, supplier.s_address, supplier.s_phone, supplier.s_comment FROM (SELECT * FROM part WHERE p_size = 28 AND p_type LIKE '%STEEL') AS t CROSS JOIN supplier INNER JOIN partsupp ON t.p_partkey = partsupp.ps_partkey AND supplier.s_suppkey = partsupp.ps_suppkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t0 ON nation.n_regionkey = t0.r_regionkey INNER JOIN (SELECT partsupp0.ps_partkey, MIN(partsupp0.ps_supplycost) AS EXPR0 FROM partsupp AS partsupp0 INNER JOIN supplier AS supplier0 ON partsupp0.ps_suppkey = supplier0.s_suppkey INNER JOIN nation AS nation0 ON supplier0.s_nationkey = nation0.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1 ON nation0.n_regionkey = t1.r_regionkey GROUP BY partsupp0.ps_partkey) AS t3 ON t.p_partkey = t3.ps_partkey AND partsupp.ps_supplycost = t3.EXPR0 ORDER BY supplier.s_acctbal DESC, nation.n_name, supplier.s_name, t.p_partkey","['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'PROJECT_REDUCE_EXPRESSIONS', 'SORT_REMOVE_CONSTANT_KEYS']","[""select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and o_orderdate >= date '1997-01-01' and o_orderdate < date '1997-01-01' + interval '1' year group by n_name order by revenue desc;""]","[""['AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'FILTER_AGGREGATE_TRANSPOSE', 'FILTER_INTO_JOIN', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE', 'PROJECT_REDUCE_EXPRESSIONS']""]"
373,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1994-07-01' and o_orderdate < date '1994-07-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1994-07-01' and o_orderdate < date '1994-07-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority",[],"[""select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from customer, orders, lineitem, nation where c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate >= date '1993-10-01' and o_orderdate < date '1993-10-01' + interval '3' month and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc;""]","[""['Empty List']""]"
374,tpch,select sum(l_extendedprice * l_discount) as revenue from lineitem where l_shipdate >= date '1995-01-01' and l_shipdate < date '1995-01-01' + interval '1' year and l_discount between 0.04 - 0.01 and 0.04 + 0.01 and l_quantity < 24;,select sum(l_extendedprice * l_discount) as revenue from lineitem where l_shipdate >= date '1995-01-01' and l_shipdate < date '1995-01-01' + interval '1' year and l_discount between 0.04 - 0.01 and 0.04 + 0.01 and l_quantity < 24,[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('31', '36', '34', '24', '26', '44', '35') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('31', '36', '34', '24', '26', '44', '35') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
375,tpch,"select o_year, sum(case when nation = 'INDONESIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM PLATED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t0.o_orderdate) AS o_year, SUM(CASE WHEN nation0.n_name = 'INDONESIA' THEN lineitem.l_extendedprice * (1 - lineitem.l_discount) ELSE 0 END) / SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'MEDIUM PLATED NICKEL') AS t CROSS JOIN supplier INNER JOIN lineitem ON t.p_partkey = lineitem.l_partkey AND supplier.s_suppkey = lineitem.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t0 ON lineitem.l_orderkey = t0.o_orderkey INNER JOIN customer ON t0.o_custkey = customer.c_custkey INNER JOIN nation ON customer.c_nationkey = nation.n_nationkey INNER JOIN nation AS nation0 ON supplier.s_nationkey = nation0.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'ASIA') AS t1 ON nation.n_regionkey = t1.r_regionkey GROUP BY EXTRACT(YEAR FROM t0.o_orderdate) ORDER BY EXTRACT(YEAR FROM t0.o_orderdate)","['AGGREGATE_PROJECT_MERGE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'PROJECT_REDUCE_EXPRESSIONS', 'FILTER_REDUCE_EXPRESSIONS', 'SORT_PROJECT_TRANSPOSE']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#33' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 4 and l_quantity <= 4 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#15' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 20 and l_quantity <= 20 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#54' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 29 and l_quantity <= 29 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['AGGREGATE_PROJECT_MERGE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'PROJECT_REDUCE_EXPRESSIONS', 'FILTER_REDUCE_EXPRESSIONS']""]"
376,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%indian%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation.n_name AS nation, EXTRACT(YEAR FROM t2.o_orderdate) AS o_year, SUM(t2.l_extendedprice * (1 - t2.l_discount) - t2.ps_supplycost * t2.l_quantity) AS sum_profit FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_name LIKE '%indian%') AS t, supplier, lineitem WHERE supplier.s_suppkey = lineitem.l_suppkey AND t.p_partkey = lineitem.l_partkey) AS t0, partsupp WHERE partsupp.ps_suppkey = t0.l_suppkey AND partsupp.ps_partkey = t0.l_partkey) AS t1, orders WHERE orders.o_orderkey = t1.l_orderkey) AS t2, nation WHERE t2.s_nationkey = nation.n_nationkey GROUP BY nation.n_name, EXTRACT(YEAR FROM t2.o_orderdate) ORDER BY nation.n_name, EXTRACT(YEAR FROM t2.o_orderdate) DESC","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_PROJECT_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE']","[""select o_year, sum(case when nation = 'SAUDI ARABIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO POLISHED COPPER' ) as all_nations group by o_year order by o_year;""]","[""['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_TO_CALC', 'FILTER_INTO_JOIN']""]"
377,tpch,"select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from customer, orders, lineitem, nation where c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate >= date '1993-04-01' and o_orderdate < date '1993-04-01' + interval '3' month and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc;","select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from customer, orders, lineitem, nation where c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate >= date '1993-04-01' and o_orderdate < date '1993-04-01' + interval '3' month and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('33', '30', '32', '25', '26', '23', '36') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('33', '30', '32', '25', '26', '23', '36') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
378,tpch,"select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('MAIL', 'SHIP') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1997-01-01' and l_receiptdate < date '1997-01-01' + interval '1' year group by l_shipmode order by l_shipmode;","SELECT t.l_shipmode, SUM(CASE WHEN orders.o_orderpriority = '1-URGENT' OR orders.o_orderpriority = '2-HIGH' THEN 1 ELSE 0 END) AS high_line_count, SUM(CASE WHEN orders.o_orderpriority <> '1-URGENT' AND orders.o_orderpriority <> '2-HIGH' THEN 1 ELSE 0 END) AS low_line_count FROM orders INNER JOIN (SELECT * FROM lineitem WHERE l_shipmode IN ('MAIL', 'SHIP') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= DATE '1997-01-01' AND l_receiptdate < (DATE '1997-01-01' + INTERVAL '1' YEAR)) AS t ON orders.o_orderkey = t.l_orderkey GROUP BY t.l_shipmode ORDER BY t.l_shipmode","['FILTER_INTO_JOIN', 'FILTER_AGGREGATE_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#53' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 4 and l_quantity <= 4 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#33' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 10 and l_quantity <= 10 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#24' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 29 and l_quantity <= 29 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_INTO_JOIN', 'FILTER_AGGREGATE_TRANSPOSE']""]"
379,tpch,"select 100.00 * sum(case when p_type like 'PROMO%' then l_extendedprice * (1 - l_discount) else 0 end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from lineitem, part where l_partkey = p_partkey and l_shipdate >= date '1997-09-01' and l_shipdate < date '1997-09-01' + interval '1' month;","select 100.00 * sum(case when p_type like 'PROMO%' then l_extendedprice * (1 - l_discount) else 0 end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from lineitem, part where l_partkey = p_partkey and l_shipdate >= date '1997-09-01' and l_shipdate < date '1997-09-01' + interval '1' month",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 20 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
380,tpch,"select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#53' and p_type not like 'STANDARD PLATED%' and p_size in (34, 49, 40, 22, 13, 30, 50, 10) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;","SELECT t6.p_brand, t6.p_type, t6.p_size, COUNT(t6.ps_suppkey) AS supplier_cnt FROM (SELECT t0.p_brand, t0.p_type, t0.p_size, t0.ps_suppkey FROM (SELECT * FROM (SELECT partsupp.ps_partkey, partsupp.ps_suppkey, partsupp.ps_availqty, partsupp.ps_supplycost, partsupp.ps_comment, part.p_partkey, part.p_name, part.p_mfgr, part.p_brand, part.p_type, part.p_size, part.p_container, part.p_retailprice, part.p_comment, partsupp.ps_suppkey AS ps_suppkey0 FROM partsupp, part) AS t WHERE t.p_partkey = t.ps_partkey AND CAST(t.p_brand AS CHAR(8)) <> 'Brand#53' AND t.p_size IN (10, 13, 22, 30, 34, 40, 49, 50) AND t.p_type NOT LIKE 'STANDARD PLATED%') AS t0 LEFT JOIN (SELECT s_suppkey, MIN(TRUE) AS f1 FROM supplier WHERE s_comment LIKE '%Customer%Complaints%' GROUP BY s_suppkey) AS t3 ON t0.ps_suppkey0 = t3.s_suppkey WHERE t3.f1 IS NOT TRUE GROUP BY t0.p_brand, t0.p_type, t0.p_size, t0.ps_suppkey) AS t6 GROUP BY t6.p_brand, t6.p_type, t6.p_size ORDER BY COUNT(t6.ps_suppkey) DESC, t6.p_brand, t6.p_type, t6.p_size","['FILTER_INTO_JOIN', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'FILTER_CORRELATE']","[""select o_year, sum(case when nation = 'MOROCCO' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE BURNISHED STEEL' ) as all_nations group by o_year order by o_year;""]","[""['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_TO_CALC', 'FILTER_INTO_JOIN']""]"
381,tpch,"select sum(l_extendedprice) / 7.0 as avg_yearly from lineitem, part where p_partkey = l_partkey and p_brand = 'Brand#31' and p_container = 'JUMBO JAR' and l_quantity < ( select 0.2 * avg(l_quantity) from lineitem where l_partkey = p_partkey );","SELECT SUM(lineitem.l_extendedprice) / 7.0 AS avg_yearly FROM lineitem INNER JOIN (SELECT * FROM part WHERE p_brand = 'Brand#31' AND p_container = 'JUMBO JAR') AS t ON lineitem.l_partkey = t.p_partkey INNER JOIN (SELECT l_partkey, AVG(l_quantity) AS f1 FROM lineitem GROUP BY l_partkey) AS t1 ON t.p_partkey = t1.l_partkey AND lineitem.l_quantity < 0.2 * t1.f1","['FILTER_CORRELATE', 'JOIN_CONDITION_PUSH', 'FILTER_INTO_JOIN', 'FILTER_AGGREGATE_TRANSPOSE', 'PROJECT_REDUCE_EXPRESSIONS']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#15' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 10 and l_quantity <= 10 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#33' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 14 and l_quantity <= 14 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#41' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 25 and l_quantity <= 25 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_INTO_JOIN', 'FILTER_AGGREGATE_TRANSPOSE', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'SORT_REMOVE', 'JOIN_LEFT_INSTANCE', 'SORT_INSTANCE', 'FILTER_INSTANCE', 'AGGREGATE_INSTANCE']""]"
382,tpch,"select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#45' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 10 and l_quantity <= 10 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#42' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 10 and l_quantity <= 10 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#13' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 30 and l_quantity <= 30 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );","select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#45' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 10 and l_quantity <= 10 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#42' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 10 and l_quantity <= 10 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#13' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 30 and l_quantity <= 30 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' )",[],"[""select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%antique%' ) as profit group by nation, o_year order by nation, o_year desc;""]","[""['Empty List']""]"
383,tpch,"select s_name, s_address from supplier, nation where s_suppkey in ( select ps_suppkey from partsupp where ps_partkey in ( select p_partkey from part where p_name like 'violet%' ) and ps_availqty > ( select 0.5 * sum(l_quantity) from lineitem where l_partkey = ps_partkey and l_suppkey = ps_suppkey and l_shipdate >= date '1996-01-01' and l_shipdate < date '1996-01-01' + interval '1' year ) ) and s_nationkey = n_nationkey and n_name = 'INDONESIA' order by s_name;","SELECT supplier.s_name, supplier.s_address FROM supplier INNER JOIN (SELECT * FROM nation WHERE n_name = 'INDONESIA') AS t ON supplier.s_nationkey = t.n_nationkey INNER JOIN (SELECT partsupp.ps_suppkey FROM partsupp INNER JOIN (SELECT p_partkey FROM part WHERE p_name LIKE 'violet%' GROUP BY p_partkey) AS t2 ON partsupp.ps_partkey = t2.p_partkey INNER JOIN (SELECT l_partkey, l_suppkey, SUM(l_quantity) AS f2 FROM lineitem WHERE l_shipdate >= DATE '1996-01-01' AND l_shipdate < (DATE '1996-01-01' + INTERVAL '1' YEAR) GROUP BY l_partkey, l_suppkey) AS t5 ON partsupp.ps_partkey = t5.l_partkey AND partsupp.ps_suppkey = t5.l_suppkey AND partsupp.ps_availqty > 0.5 * t5.f2 GROUP BY partsupp.ps_suppkey) AS t8 ON supplier.s_suppkey = t8.ps_suppkey ORDER BY supplier.s_name","['FILTER_INTO_JOIN', 'FILTER_MERGE', 'JOIN_CONDITION_PUSH']","[""select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'PERU' and n2.n_name = 'SAUDI ARABIA') or (n1.n_name = 'SAUDI ARABIA' and n2.n_name = 'PERU') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;""]","[""['FILTER_INTO_JOIN']""]"
384,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'ROMANIA' group by s_name order by numwait desc, s_name;","SELECT t4.s_name, COUNT(*) AS numwait FROM (SELECT * FROM (SELECT supplier.s_suppkey, supplier.s_name, supplier.s_address, supplier.s_nationkey, supplier.s_phone, supplier.s_acctbal, supplier.s_comment, lineitem.l_orderkey, lineitem.l_partkey, lineitem.l_suppkey, lineitem.l_linenumber, lineitem.l_quantity, lineitem.l_extendedprice, lineitem.l_discount, lineitem.l_tax, lineitem.l_returnflag, lineitem.l_linestatus, lineitem.l_shipdate, lineitem.l_commitdate, lineitem.l_receiptdate, lineitem.l_shipinstruct, lineitem.l_shipmode, lineitem.l_comment, orders.o_orderkey, orders.o_custkey, orders.o_orderstatus, orders.o_totalprice, orders.o_orderdate, orders.o_orderpriority, orders.o_clerk, orders.o_shippriority, orders.o_comment, nation.n_nationkey, nation.n_name, nation.n_regionkey, nation.n_comment, t2.f2 AS f0 FROM supplier CROSS JOIN lineitem CROSS JOIN orders CROSS JOIN nation LEFT JOIN (SELECT t0.l_orderkey AS l_orderkey0, t0.l_suppkey AS l_suppkey0, MIN(TRUE) AS f2 FROM lineitem AS lineitem0 INNER JOIN (SELECT lineitem1.l_orderkey, lineitem1.l_suppkey FROM supplier AS supplier0, lineitem AS lineitem1, orders AS orders0, nation AS nation0 GROUP BY lineitem1.l_orderkey, lineitem1.l_suppkey) AS t0 ON lineitem0.l_orderkey = t0.l_orderkey AND lineitem0.l_suppkey <> t0.l_suppkey GROUP BY t0.l_orderkey, t0.l_suppkey) AS t2 ON lineitem.l_orderkey = t2.l_orderkey0 AND lineitem.l_suppkey = t2.l_suppkey0) AS t3 WHERE t3.s_suppkey = t3.l_suppkey AND (t3.o_orderkey = t3.l_orderkey AND t3.o_orderstatus = 'F') AND (t3.l_receiptdate > t3.l_commitdate AND t3.s_nationkey = t3.n_nationkey AND (t3.n_name = 'ROMANIA' AND t3.f0 IS NOT NULL))) AS t4 LEFT JOIN (SELECT t13.l_orderkey AS l_orderkey0, t13.l_suppkey AS l_suppkey0, MIN(TRUE) AS f2 FROM (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t5 INNER JOIN (SELECT l_orderkey, l_suppkey FROM (SELECT supplier1.s_suppkey, supplier1.s_name, supplier1.s_address, supplier1.s_nationkey, supplier1.s_phone, supplier1.s_acctbal, supplier1.s_comment, lineitem3.l_orderkey, lineitem3.l_partkey, lineitem3.l_suppkey, lineitem3.l_linenumber, lineitem3.l_quantity, lineitem3.l_extendedprice, lineitem3.l_discount, lineitem3.l_tax, lineitem3.l_returnflag, lineitem3.l_linestatus, lineitem3.l_shipdate, lineitem3.l_commitdate, lineitem3.l_receiptdate, lineitem3.l_shipinstruct, lineitem3.l_shipmode, lineitem3.l_comment, orders1.o_orderkey, orders1.o_custkey, orders1.o_orderstatus, orders1.o_totalprice, orders1.o_orderdate, orders1.o_orderpriority, orders1.o_clerk, orders1.o_shippriority, orders1.o_comment, nation1.n_nationkey, nation1.n_name, nation1.n_regionkey, nation1.n_comment, t9.f2 AS f0 FROM supplier AS supplier1 CROSS JOIN lineitem AS lineitem3 CROSS JOIN orders AS orders1 CROSS JOIN nation AS nation1 LEFT JOIN (SELECT t7.l_orderkey AS l_orderkey0, t7.l_suppkey AS l_suppkey0, MIN(TRUE) AS f2 FROM lineitem AS lineitem4 INNER JOIN (SELECT lineitem5.l_orderkey, lineitem5.l_suppkey FROM supplier AS supplier2, lineitem AS lineitem5, orders AS orders2, nation AS nation2 GROUP BY lineitem5.l_orderkey, lineitem5.l_suppkey) AS t7 ON lineitem4.l_orderkey = t7.l_orderkey AND lineitem4.l_suppkey <> t7.l_suppkey GROUP BY t7.l_orderkey, t7.l_suppkey) AS t9 ON lineitem3.l_orderkey = t9.l_orderkey0 AND lineitem3.l_suppkey = t9.l_suppkey0) AS t10 WHERE t10.s_suppkey = t10.l_suppkey AND (t10.o_orderkey = t10.l_orderkey AND t10.o_orderstatus = 'F') AND (t10.l_receiptdate > t10.l_commitdate AND t10.s_nationkey = t10.n_nationkey AND (t10.n_name = 'ROMANIA' AND t10.f0 IS NOT NULL)) GROUP BY l_orderkey, l_suppkey) AS t13 ON t5.l_orderkey = t13.l_orderkey AND t5.l_suppkey <> t13.l_suppkey GROUP BY t13.l_orderkey, t13.l_suppkey) AS t15 ON t4.l_orderkey = t15.l_orderkey0 AND t4.l_suppkey = t15.l_suppkey0 WHERE t15.f2 IS NULL GROUP BY t4.s_name ORDER BY COUNT(*) DESC, t4.s_name","['FILTER_MERGE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_CORRELATE']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#23' and p_type not like 'MEDIUM POLISHED%' and p_size in (21, 48, 26, 50, 1, 6, 40, 44) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_MERGE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_CORRELATE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES']""]"
385,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('29', '25', '34', '44', '21', '23', '42') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('29', '25', '34', '44', '21', '23', '42') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('29', '25', '34', '44', '21', '23', '42') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('29', '25', '34', '44', '21', '23', '42') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 22 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
386,tpch,"select l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order from lineitem where l_shipdate <= date '1998-12-01' - interval '104' day (3) group by l_returnflag, l_linestatus order by l_returnflag, l_linestatus;","SELECT l_returnflag, l_linestatus, SUM(l_quantity) AS sum_qty, SUM(l_extendedprice) AS sum_base_price, SUM(l_extendedprice * (1 - l_discount)) AS sum_disc_price, SUM(l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS sum_charge, AVG(l_quantity) AS avg_qty, AVG(l_extendedprice) AS avg_price, AVG(l_discount) AS avg_disc, COUNT(*) AS count_order FROM lineitem WHERE l_shipdate <= (DATE '1998-12-01' - INTERVAL '104' DAY(3)) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus","['FILTER_SCAN', 'AGGREGATE_REMOVE', 'SORT_REMOVE']","[""select o_year, sum(case when nation = 'KENYA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY POLISHED TIN' ) as all_nations group by o_year order by o_year;""]","[""['SORT_REMOVE', 'PROJECT_REMOVE', 'FILTER_INTO_JOIN', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN']""]"
387,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 24 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT supplier.s_acctbal, supplier.s_name, nation.n_name, t.p_partkey, t.p_mfgr, supplier.s_address, supplier.s_phone, supplier.s_comment FROM (SELECT * FROM part WHERE p_size = 24 AND p_type LIKE '%BRASS') AS t CROSS JOIN supplier INNER JOIN partsupp ON t.p_partkey = partsupp.ps_partkey AND supplier.s_suppkey = partsupp.ps_suppkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'EUROPE') AS t0 ON nation.n_regionkey = t0.r_regionkey INNER JOIN (SELECT partsupp0.ps_partkey, MIN(partsupp0.ps_supplycost) AS EXPR0 FROM partsupp AS partsupp0 INNER JOIN supplier AS supplier0 ON partsupp0.ps_suppkey = supplier0.s_suppkey INNER JOIN nation AS nation0 ON supplier0.s_nationkey = nation0.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'EUROPE') AS t1 ON nation0.n_regionkey = t1.r_regionkey GROUP BY partsupp0.ps_partkey) AS t3 ON t.p_partkey = t3.ps_partkey AND partsupp.ps_supplycost = t3.EXPR0 ORDER BY supplier.s_acctbal DESC, nation.n_name, supplier.s_name, t.p_partkey","['FILTER_INTO_JOIN', 'FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH', 'JOIN_REDUCE_EXPRESSIONS', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'AGGREGATE_ANY_PULL_UP_CONSTANTS', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#13' and p_type not like 'STANDARD BURNISHED%' and p_size in (17, 23, 21, 37, 40, 33, 50, 38) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_INTO_JOIN', 'FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_LEFT_UNION_TRANSPOSE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'AGGREGATE_ANY_PULL_UP_CONSTANTS', 'AGGREGATE_REMOVE', 'UNION_REMOVE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE']""]"
388,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'AUTOMOBILE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-21' and l_shipdate > date '1995-03-21' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'AUTOMOBILE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-21' and l_shipdate > date '1995-03-21' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 7 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
389,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1996-03-01' and o_orderdate < date '1996-03-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","SELECT t.o_orderpriority, COUNT(*) AS order_count FROM (SELECT * FROM orders WHERE o_orderdate >= DATE '1996-03-01' AND o_orderdate < (DATE '1996-03-01' + INTERVAL '3' MONTH)) AS t INNER JOIN (SELECT l_orderkey, MIN(TRUE) AS f1 FROM lineitem WHERE l_commitdate < l_receiptdate GROUP BY l_orderkey) AS t2 ON t.o_orderkey = t2.l_orderkey GROUP BY t.o_orderpriority ORDER BY t.o_orderpriority","['FILTER_SCAN', 'FILTER_CORRELATE', 'FILTER_PROJECT_TRANSPOSE', 'JOIN_CONDITION_PUSH', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#42' and p_type not like 'SMALL PLATED%' and p_size in (2, 45, 18, 12, 29, 33, 48, 15) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_SCAN', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'FILTER_MERGE', 'FILTER_CORRELATE', 'FILTER_PROJECT_TRANSPOSE', 'JOIN_CONDITION_PUSH', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN']""]"
390,tpch,select sum(l_extendedprice * l_discount) as revenue from lineitem where l_shipdate >= date '1995-01-01' and l_shipdate < date '1995-01-01' + interval '1' year and l_discount between 0.03 - 0.01 and 0.03 + 0.01 and l_quantity < 24;,SELECT SUM(l_extendedprice * l_discount) AS revenue FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate < (DATE '1995-01-01' + INTERVAL '1' YEAR) AND l_discount >= 0.03 - 0.01 AND l_discount <= 0.03 + 0.01 AND l_quantity < 24,"['FILTER_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#22' and p_type not like 'MEDIUM BRUSHED%' and p_size in (33, 2, 13, 50, 28, 26, 43, 25) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_INTO_JOIN', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'JOIN_CONDITION_PUSH', 'PROJECT_REMOVE']""]"
391,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'ETHIOPIA' and n2.n_name = 'INDIA') or (n1.n_name = 'INDIA' and n2.n_name = 'ETHIOPIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'ETHIOPIA' and n2.n_name = 'INDIA') or (n1.n_name = 'INDIA' and n2.n_name = 'ETHIOPIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year",[],"[""select o_year, sum(case when nation = 'RUSSIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL BURNISHED TIN' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
392,tpch,"select o_year, sum(case when nation = 'INDIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY PLATED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t5.o_orderdate) AS o_year, SUM(CASE WHEN t5.n_name0 = 'INDIA' THEN t5.l_extendedprice * (1 - t5.l_discount) ELSE 0 END) / SUM(t5.l_extendedprice * (1 - t5.l_discount)) AS mkt_share FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_type = 'ECONOMY PLATED STEEL') AS t, supplier, lineitem WHERE t.p_partkey = lineitem.l_partkey AND supplier.s_suppkey = lineitem.l_suppkey) AS t0, (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t1 WHERE t0.l_orderkey = t1.o_orderkey) AS t2, customer WHERE t2.o_custkey = customer.c_custkey) AS t3, nation WHERE t3.c_nationkey = nation.n_nationkey) AS t4, nation AS nation0 WHERE t4.s_nationkey = nation0.n_nationkey) AS t5, (SELECT * FROM region WHERE r_name = 'ASIA') AS t6 WHERE t5.n_regionkey = t6.r_regionkey GROUP BY EXTRACT(YEAR FROM t5.o_orderdate) ORDER BY EXTRACT(YEAR FROM t5.o_orderdate)","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_REDUCE_EXPRESSIONS']","[""select o_year, sum(case when nation = 'JORDAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM ANODIZED TIN' ) as all_nations group by o_year order by o_year;""]","[""['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_TO_CALC', 'FILTER_INTO_JOIN']""]"
393,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%red%' ) as profit group by nation, o_year order by nation, o_year desc;","select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%red%' ) as profit group by nation, o_year order by nation, o_year desc",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 22 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
394,tpch,"select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from customer, orders, lineitem, nation where c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate >= date '1993-07-01' and o_orderdate < date '1993-07-01' + interval '3' month and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc;","select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from customer, orders, lineitem, nation where c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate >= date '1993-07-01' and o_orderdate < date '1993-07-01' + interval '3' month and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc",[],"[""select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'AUTOMOBILE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-08' and l_shipdate > date '1995-03-08' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;""]","[""['Empty List']""]"
395,tpch,"select ps_partkey, sum(ps_supplycost * ps_availqty) as value from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'CANADA' group by ps_partkey having sum(ps_supplycost * ps_availqty) > ( select sum(ps_supplycost * ps_availqty) * 0.0001000000 from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'CANADA' ) order by value desc;","select ps_partkey, sum(ps_supplycost * ps_availqty) as value from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'CANADA' group by ps_partkey having sum(ps_supplycost * ps_availqty) > ( select sum(ps_supplycost * ps_availqty) * 0.0001000000 from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'CANADA' ) order by value desc",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('43', '32', '36', '22', '24', '21', '28') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('43', '32', '36', '22', '24', '21', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
396,tpch,"select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('RAIL', 'REG AIR') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1993-01-01' and l_receiptdate < date '1993-01-01' + interval '1' year group by l_shipmode order by l_shipmode;","SELECT t.l_shipmode, SUM(CASE WHEN orders.o_orderpriority = '1-URGENT' OR orders.o_orderpriority = '2-HIGH' THEN 1 ELSE 0 END) AS high_line_count, SUM(CASE WHEN orders.o_orderpriority <> '1-URGENT' AND orders.o_orderpriority <> '2-HIGH' THEN 1 ELSE 0 END) AS low_line_count FROM orders INNER JOIN (SELECT * FROM lineitem WHERE l_shipmode IN ('RAIL', 'REG AIR') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= DATE '1993-01-01' AND l_receiptdate < (DATE '1993-01-01' + INTERVAL '1' YEAR)) AS t ON orders.o_orderkey = t.l_orderkey GROUP BY t.l_shipmode ORDER BY t.l_shipmode","['SORT_REMOVE', 'FILTER_INTO_JOIN', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN']","[""select o_year, sum(case when nation = 'VIETNAM' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD PLATED COPPER' ) as all_nations group by o_year order by o_year;""]","[""['SORT_REMOVE', 'FILTER_INTO_JOIN', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN']""]"
397,tpch,"select 100.00 * sum(case when p_type like 'PROMO%' then l_extendedprice * (1 - l_discount) else 0 end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from lineitem, part where l_partkey = p_partkey and l_shipdate >= date '1993-07-01' and l_shipdate < date '1993-07-01' + interval '1' month;",SELECT 100.00 * SUM(CASE WHEN part.p_type LIKE 'PROMO%' THEN t.l_extendedprice * (1 - t.l_discount) ELSE 0 END) / SUM(t.l_extendedprice * (1 - t.l_discount)) AS promo_revenue FROM (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1993-07-01' AND l_shipdate < (DATE '1993-07-01' + INTERVAL '1' MONTH)) AS t INNER JOIN part ON t.l_partkey = part.p_partkey,"['FILTER_INTO_JOIN', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_REMOVE']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#53' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 1 and l_quantity <= 1 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#43' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 14 and l_quantity <= 14 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#21' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 29 and l_quantity <= 29 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_INTO_JOIN', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_REMOVE']""]"
398,tpch,"select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#11' and p_type not like 'SMALL BURNISHED%' and p_size in (33, 12, 17, 27, 34, 23, 11, 19) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;","SELECT t6.p_brand, t6.p_type, t6.p_size, COUNT(t6.ps_suppkey) AS supplier_cnt FROM (SELECT t0.p_brand, t0.p_type, t0.p_size, t0.ps_suppkey FROM (SELECT * FROM (SELECT partsupp.ps_partkey, partsupp.ps_suppkey, partsupp.ps_availqty, partsupp.ps_supplycost, partsupp.ps_comment, part.p_partkey, part.p_name, part.p_mfgr, part.p_brand, part.p_type, part.p_size, part.p_container, part.p_retailprice, part.p_comment, partsupp.ps_suppkey AS ps_suppkey0 FROM partsupp, part) AS t WHERE t.p_partkey = t.ps_partkey AND CAST(t.p_brand AS CHAR(8)) <> 'Brand#11' AND t.p_size IN (11, 12, 17, 19, 23, 27, 33, 34) AND t.p_type NOT LIKE 'SMALL BURNISHED%') AS t0 LEFT JOIN (SELECT s_suppkey, MIN(TRUE) AS f1 FROM supplier WHERE s_comment LIKE '%Customer%Complaints%' GROUP BY s_suppkey) AS t3 ON t0.ps_suppkey0 = t3.s_suppkey WHERE t3.f1 IS NOT TRUE GROUP BY t0.p_brand, t0.p_type, t0.p_size, t0.ps_suppkey) AS t6 GROUP BY t6.p_brand, t6.p_type, t6.p_size ORDER BY COUNT(t6.ps_suppkey) DESC, t6.p_brand, t6.p_type, t6.p_size","['FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_CORRELATE', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'PROJECT_REDUCE_EXPRESSIONS']","[""select o_year, sum(case when nation = 'INDIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD ANODIZED NICKEL' ) as all_nations group by o_year order by o_year;""]","[""['FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_CORRELATE', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'JOIN_LEFT_UNION_TRANSPOSE', 'PROJECT_REDUCE_EXPRESSIONS']""]"
399,tpch,"select sum(l_extendedprice) / 7.0 as avg_yearly from lineitem, part where p_partkey = l_partkey and p_brand = 'Brand#12' and p_container = 'JUMBO BOX' and l_quantity < ( select 0.2 * avg(l_quantity) from lineitem where l_partkey = p_partkey );","SELECT SUM(lineitem.l_extendedprice) / 7.0 AS avg_yearly FROM lineitem INNER JOIN (SELECT * FROM part WHERE p_brand = 'Brand#12' AND p_container = 'JUMBO BOX') AS t ON lineitem.l_partkey = t.p_partkey INNER JOIN (SELECT l_partkey, AVG(l_quantity) AS f1 FROM lineitem GROUP BY l_partkey) AS t0 ON t.p_partkey = t0.l_partkey AND lineitem.l_quantity < 0.2 * t0.f1","['FILTER_INTO_JOIN', 'FILTER_CORRELATE', 'AGGREGATE_PROJECT_MERGE']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#21' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 9 and l_quantity <= 9 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#42' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 13 and l_quantity <= 13 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#12' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 21 and l_quantity <= 21 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_INTO_JOIN', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_REMOVE']""]"
400,tpch,"select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#42' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 2 and l_quantity <= 2 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#23' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 13 and l_quantity <= 13 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#42' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 26 and l_quantity <= 26 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );","select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#42' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 2 and l_quantity <= 2 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#23' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 13 and l_quantity <= 13 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#42' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 26 and l_quantity <= 26 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' )",[],"[""select o_year, sum(case when nation = 'IRAQ' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL POLISHED BRASS' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
401,tpch,"select s_name, s_address from supplier, nation where s_suppkey in ( select ps_suppkey from partsupp where ps_partkey in ( select p_partkey from part where p_name like 'cream%' ) and ps_availqty > ( select 0.5 * sum(l_quantity) from lineitem where l_partkey = ps_partkey and l_suppkey = ps_suppkey and l_shipdate >= date '1994-01-01' and l_shipdate < date '1994-01-01' + interval '1' year ) ) and s_nationkey = n_nationkey and n_name = 'JAPAN' order by s_name;","SELECT t0.s_name, t0.s_address FROM (SELECT * FROM supplier, (SELECT * FROM nation WHERE n_name = 'JAPAN') AS t WHERE supplier.s_nationkey = t.n_nationkey) AS t0, (SELECT t4.ps_suppkey FROM (SELECT * FROM partsupp, (SELECT p_partkey FROM part WHERE p_name LIKE 'cream%' GROUP BY p_partkey) AS t3 WHERE partsupp.ps_partkey = t3.p_partkey) AS t4, (SELECT l_partkey, l_suppkey, SUM(l_quantity) AS f2 FROM lineitem WHERE l_shipdate >= DATE '1994-01-01' AND l_shipdate < (DATE '1994-01-01' + INTERVAL '1' YEAR) GROUP BY l_partkey, l_suppkey) AS t7 WHERE t4.ps_partkey = t7.l_partkey AND t4.ps_suppkey = t7.l_suppkey AND t4.ps_availqty > 0.5 * t7.f2 GROUP BY t4.ps_suppkey) AS t11 WHERE t0.s_suppkey = t11.ps_suppkey ORDER BY t0.s_name","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_PROJECT_TRANSPOSE', 'AGGREGATE_ANY_PULL_UP_CONSTANTS']","[""select o_year, sum(case when nation = 'JAPAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD PLATED TIN' ) as all_nations group by o_year order by o_year;""]","[""['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_TO_CALC', 'FILTER_INTO_JOIN']""]"
402,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'GERMANY' group by s_name order by numwait desc, s_name;","select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'GERMANY' group by s_name order by numwait desc, s_name",[],"[""select o_year, sum(case when nation = 'CANADA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE BRUSHED COPPER' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
403,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('32', '36', '30', '25', '29', '37', '41') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('32', '36', '30', '25', '29', '37', '41') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t2.c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(t2.c_phone) + 1) < 1 THEN CHAR_LENGTH(t2.c_phone) + 1 ELSE 1 END FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t2.c_acctbal) AS totacctbal FROM (SELECT * FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '32' OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '36' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '30') OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '25' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '29' OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '37' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '41'))) AS t, (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '32' OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '36' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '30') OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '25' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '29' OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '37' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '41')))) AS t1 WHERE t.c_acctbal > t1.EXPR0) AS t2 LEFT JOIN (SELECT o_custkey, MIN(TRUE) AS f1 FROM orders GROUP BY o_custkey) AS t4 ON t2.c_custkey = t4.o_custkey WHERE t4.f1 IS NULL GROUP BY SUBSTR(t2.c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(t2.c_phone) + 1) < 1 THEN CHAR_LENGTH(t2.c_phone) + 1 ELSE 1 END FOR 2) ORDER BY SUBSTR(t2.c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(t2.c_phone) + 1) < 1 THEN CHAR_LENGTH(t2.c_phone) + 1 ELSE 1 END FOR 2)","['FILTER_PROJECT_TRANSPOSE', 'FILTER_INTO_JOIN', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_UNION_AGGREGATE', 'AGGREGATE_UNION_TRANSPOSE', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'JOIN_EXTRACT_FILTER', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'JOIN_PROJECT_LEFT_TRANSPOSE', 'SORT_JOIN_TRANSPOSE', 'SORT_REMOVE']","[""select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%mint%' ) as profit group by nation, o_year order by nation, o_year desc;""]","[""['FILTER_PROJECT_TRANSPOSE', 'FILTER_INTO_JOIN', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_UNION_AGGREGATE', 'AGGREGATE_UNION_TRANSPOSE', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'JOIN_EXTRACT_FILTER', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'JOIN_PROJECT_LEFT_TRANSPOSE', 'SORT_JOIN_TRANSPOSE', 'SORT_REMOVE']""]"
404,tpch,"select l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order from lineitem where l_shipdate <= date '1998-12-01' - interval '107' day (3) group by l_returnflag, l_linestatus order by l_returnflag, l_linestatus;","SELECT l_returnflag, l_linestatus, SUM(l_quantity) AS sum_qty, SUM(l_extendedprice) AS sum_base_price, SUM(l_extendedprice * (1 - l_discount)) AS sum_disc_price, SUM(l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS sum_charge, AVG(l_quantity) AS avg_qty, AVG(l_extendedprice) AS avg_price, AVG(l_discount) AS avg_disc, COUNT(*) AS count_order FROM lineitem WHERE l_shipdate <= (DATE '1998-12-01' - INTERVAL '107' DAY(3)) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus","['FILTER_SCAN', 'AGGREGATE_PROJECT_MERGE', 'SORT_PROJECT_TRANSPOSE']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#35' and p_type not like 'ECONOMY BURNISHED%' and p_size in (22, 38, 21, 26, 15, 9, 27, 50) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_MERGE', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE']""]"
405,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 48 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;","select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 48 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey",[],"[""select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'BUILDING' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-28' and l_shipdate > date '1995-03-28' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;""]","[""['Empty List']""]"
406,tpch,select sum(l_extendedprice * l_discount) as revenue from lineitem where l_shipdate >= date '1997-01-01' and l_shipdate < date '1997-01-01' + interval '1' year and l_discount between 0.07 - 0.01 and 0.07 + 0.01 and l_quantity < 25;,SELECT SUM(l_extendedprice * l_discount) AS revenue FROM lineitem WHERE l_shipdate >= DATE '1997-01-01' AND l_shipdate < (DATE '1997-01-01' + INTERVAL '1' YEAR) AND l_discount >= 0.07 - 0.01 AND l_discount <= 0.07 + 0.01 AND l_quantity < 25,"['FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#14' and p_type not like 'SMALL POLISHED%' and p_size in (2, 47, 28, 3, 21, 23, 31, 37) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_SCAN', 'FILTER_CORRELATE', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_PROJECT_TRANSPOSE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_ANY_PULL_UP_CONSTANTS', 'JOIN_CONDITION_PUSH', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE']""]"
407,tpch,"select o_year, sum(case when nation = 'PERU' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE BRUSHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t0.o_orderdate) AS o_year, SUM(CASE WHEN nation0.n_name = 'PERU' THEN lineitem.l_extendedprice * (1 - lineitem.l_discount) ELSE 0 END) / SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'LARGE BRUSHED NICKEL') AS t CROSS JOIN supplier INNER JOIN lineitem ON t.p_partkey = lineitem.l_partkey AND supplier.s_suppkey = lineitem.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t0 ON lineitem.l_orderkey = t0.o_orderkey INNER JOIN customer ON t0.o_custkey = customer.c_custkey INNER JOIN nation ON customer.c_nationkey = nation.n_nationkey INNER JOIN nation AS nation0 ON supplier.s_nationkey = nation0.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AMERICA') AS t1 ON nation.n_regionkey = t1.r_regionkey GROUP BY EXTRACT(YEAR FROM t0.o_orderdate) ORDER BY EXTRACT(YEAR FROM t0.o_orderdate)","['FILTER_SCAN', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_PROJECT_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE']","[""select o_year, sum(case when nation = 'FRANCE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO BRUSHED COPPER' ) as all_nations group by o_year order by o_year;""]","[""['FILTER_SCAN', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_CORRELATE', 'JOIN_LEFT_UNION_TRANSPOSE', 'FILTER_PROJECT_TRANSPOSE', 'PROJECT_CORRELATE_TRANSPOSE', 'PROJECT_REMOVE', 'AGGREGATE_PROJECT_MERGE']""]"
408,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%orchid%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation.n_name AS nation, EXTRACT(YEAR FROM orders.o_orderdate) AS o_year, SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount) - partsupp.ps_supplycost * lineitem.l_quantity) AS sum_profit FROM (SELECT * FROM part WHERE p_name LIKE '%orchid%') AS t CROSS JOIN supplier INNER JOIN lineitem ON supplier.s_suppkey = lineitem.l_suppkey AND t.p_partkey = lineitem.l_partkey INNER JOIN partsupp ON lineitem.l_suppkey = partsupp.ps_suppkey AND lineitem.l_partkey = partsupp.ps_partkey INNER JOIN orders ON lineitem.l_orderkey = orders.o_orderkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey GROUP BY nation.n_name, EXTRACT(YEAR FROM orders.o_orderdate) ORDER BY nation.n_name, EXTRACT(YEAR FROM orders.o_orderdate) DESC","['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_AGGREGATE_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#35' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 3 and l_quantity <= 3 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#51' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 20 and l_quantity <= 20 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#12' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 22 and l_quantity <= 22 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_MERGE', 'FILTER_INTO_JOIN', 'FILTER_AGGREGATE_TRANSPOSE', 'PROJECT_REDUCE_EXPRESSIONS', 'AGGREGATE_ANY_PULL_UP_CONSTANTS']""]"
409,tpch,"select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from customer, orders, lineitem, nation where c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate >= date '1993-12-01' and o_orderdate < date '1993-12-01' + interval '3' month and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc;","select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from customer, orders, lineitem, nation where c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate >= date '1993-12-01' and o_orderdate < date '1993-12-01' + interval '3' month and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc",[],"[""select o_year, sum(case when nation = 'MOZAMBIQUE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY PLATED BRASS' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
410,tpch,"select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('REG AIR', 'FOB') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1994-01-01' and l_receiptdate < date '1994-01-01' + interval '1' year group by l_shipmode order by l_shipmode;","select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('REG AIR', 'FOB') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1994-01-01' and l_receiptdate < date '1994-01-01' + interval '1' year group by l_shipmode order by l_shipmode",[],"[""select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'FRANCE' and n2.n_name = 'IRAN') or (n1.n_name = 'IRAN' and n2.n_name = 'FRANCE') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;""]","[""['Empty List']""]"
411,tpch,"select 100.00 * sum(case when p_type like 'PROMO%' then l_extendedprice * (1 - l_discount) else 0 end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from lineitem, part where l_partkey = p_partkey and l_shipdate >= date '1994-12-01' and l_shipdate < date '1994-12-01' + interval '1' month;","select 100.00 * sum(case when p_type like 'PROMO%' then l_extendedprice * (1 - l_discount) else 0 end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from lineitem, part where l_partkey = p_partkey and l_shipdate >= date '1994-12-01' and l_shipdate < date '1994-12-01' + interval '1' month",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 48 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
412,tpch,"select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#14' and p_type not like 'MEDIUM POLISHED%' and p_size in (25, 13, 18, 17, 3, 23, 16, 31) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;","SELECT t5.p_brand, t5.p_type, t5.p_size, COUNT(t5.ps_suppkey) AS supplier_cnt FROM (SELECT t0.ps_suppkey, t0.p_brand, t0.p_type, t0.p_size FROM (SELECT partsupp.ps_partkey, partsupp.ps_suppkey, partsupp.ps_availqty, partsupp.ps_supplycost, partsupp.ps_comment, part.p_partkey, part.p_name, part.p_mfgr, part.p_brand, part.p_type, part.p_size, part.p_container, part.p_retailprice, part.p_comment, partsupp.ps_suppkey AS ps_suppkey0 FROM partsupp, part WHERE part.p_partkey = partsupp.ps_partkey AND CAST(part.p_brand AS CHAR(8)) <> 'Brand#14' AND part.p_size IN (3, 13, 16, 17, 18, 23, 25, 31) AND part.p_type NOT LIKE 'MEDIUM POLISHED%') AS t0 LEFT JOIN (SELECT s_suppkey, MIN(TRUE) AS f1 FROM supplier WHERE s_comment LIKE '%Customer%Complaints%' GROUP BY s_suppkey) AS t3 ON t0.ps_suppkey0 = t3.s_suppkey WHERE t3.f1 IS NOT TRUE GROUP BY t0.ps_suppkey, t0.p_brand, t0.p_type, t0.p_size) AS t5 GROUP BY t5.p_brand, t5.p_type, t5.p_size ORDER BY COUNT(t5.ps_suppkey) DESC, t5.p_brand, t5.p_type, t5.p_size","['FILTER_INTO_JOIN', 'FILTER_PROJECT_TRANSPOSE', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'PROJECT_REMOVE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'AGGREGATE_PROJECT_MERGE', 'SORT_PROJECT_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#11' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 5 and l_quantity <= 5 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#52' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 10 and l_quantity <= 10 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#21' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 30 and l_quantity <= 30 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_INTO_JOIN', 'FILTER_PROJECT_TRANSPOSE', 'JOIN_LEFT_UNION_TRANSPOSE', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'PROJECT_REMOVE', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_REMOVE']""]"
413,tpch,"select sum(l_extendedprice) / 7.0 as avg_yearly from lineitem, part where p_partkey = l_partkey and p_brand = 'Brand#43' and p_container = 'MED JAR' and l_quantity < ( select 0.2 * avg(l_quantity) from lineitem where l_partkey = p_partkey );","SELECT SUM(lineitem.l_extendedprice) / 7.0 AS avg_yearly FROM lineitem INNER JOIN (SELECT * FROM part WHERE p_brand = 'Brand#43' AND p_container = 'MED JAR') AS t ON lineitem.l_partkey = t.p_partkey INNER JOIN (SELECT l_partkey, AVG(l_quantity) AS f1 FROM lineitem GROUP BY l_partkey) AS t0 ON t.p_partkey = t0.l_partkey AND lineitem.l_quantity < 0.2 * t0.f1","['FILTER_CORRELATE', 'AGGREGATE_PROJECT_MERGE', 'FILTER_INTO_JOIN']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#34' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 9 and l_quantity <= 9 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#51' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 10 and l_quantity <= 10 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#24' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 29 and l_quantity <= 29 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_INTO_JOIN', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_REMOVE']""]"
414,tpch,"select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#32' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 3 and l_quantity <= 3 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#22' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 15 and l_quantity <= 15 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#22' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 26 and l_quantity <= 26 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );","SELECT SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS revenue FROM lineitem INNER JOIN part ON lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#32' AND (part.p_container IN ('SM BOX', 'SM CASE', 'SM PACK', 'SM PKG') AND lineitem.l_quantity >= 3) AND (lineitem.l_quantity <= 3 + 10 AND (part.p_size >= 1 AND part.p_size <= 5) AND (lineitem.l_shipmode IN ('AIR', 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON')) OR lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#22' AND (part.p_container IN ('MED BAG', 'MED BOX', 'MED PACK', 'MED PKG') AND lineitem.l_quantity >= 15) AND (lineitem.l_quantity <= 15 + 10 AND (part.p_size >= 1 AND part.p_size <= 10) AND (lineitem.l_shipmode IN ('AIR', 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON')) OR lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#22' AND (part.p_container IN ('LG BOX', 'LG CASE', 'LG PACK', 'LG PKG') AND lineitem.l_quantity >= 26) AND (lineitem.l_quantity <= 26 + 10 AND (part.p_size >= 1 AND part.p_size <= 15) AND (lineitem.l_shipmode IN ('AIR', 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))","['FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_MERGE', 'FILTER_INTO_JOIN', 'AGGREGATE_PROJECT_MERGE']","[""select o_year, sum(case when nation = 'FRANCE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY ANODIZED TIN' ) as all_nations group by o_year order by o_year;""]","[""['FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'JOIN_RIGHT_UNION_TRANSPOSE', 'FILTER_AGGREGATE_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES']""]"
415,tpch,"select s_name, s_address from supplier, nation where s_suppkey in ( select ps_suppkey from partsupp where ps_partkey in ( select p_partkey from part where p_name like 'dark%' ) and ps_availqty > ( select 0.5 * sum(l_quantity) from lineitem where l_partkey = ps_partkey and l_suppkey = ps_suppkey and l_shipdate >= date '1994-01-01' and l_shipdate < date '1994-01-01' + interval '1' year ) ) and s_nationkey = n_nationkey and n_name = 'GERMANY' order by s_name;","SELECT supplier.s_name, supplier.s_address FROM supplier INNER JOIN (SELECT * FROM nation WHERE n_name = 'GERMANY') AS t ON supplier.s_nationkey = t.n_nationkey INNER JOIN (SELECT partsupp.ps_suppkey FROM partsupp INNER JOIN (SELECT p_partkey FROM part WHERE p_name LIKE 'dark%' GROUP BY p_partkey) AS t2 ON partsupp.ps_partkey = t2.p_partkey INNER JOIN (SELECT l_partkey, l_suppkey, SUM(l_quantity) AS f2 FROM lineitem WHERE l_shipdate >= DATE '1994-01-01' AND l_shipdate < (DATE '1994-01-01' + INTERVAL '1' YEAR) GROUP BY l_partkey, l_suppkey) AS t5 ON partsupp.ps_partkey = t5.l_partkey AND partsupp.ps_suppkey = t5.l_suppkey AND partsupp.ps_availqty > 0.5 * t5.f2 GROUP BY partsupp.ps_suppkey) AS t8 ON supplier.s_suppkey = t8.ps_suppkey ORDER BY supplier.s_name","['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_PROJECT_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#15' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 6 and l_quantity <= 6 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#33' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 17 and l_quantity <= 17 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#22' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 21 and l_quantity <= 21 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'JOIN_RIGHT_INSTANCE', 'FILTER_INSTANCE', 'CALC_REMOVE', 'PROJECT_REMOVE', 'AGGREGATE_PROJECT_MERGE']""]"
416,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('27', '28', '30', '20', '35', '37', '21') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('27', '28', '30', '20', '35', '37', '21') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('27', '28', '30', '20', '35', '37', '21') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('27', '28', '30', '20', '35', '37', '21') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('27', '43', '29', '25', '35', '22', '21') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('27', '43', '29', '25', '35', '22', '21') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
417,tpch,"select l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order from lineitem where l_shipdate <= date '1998-12-01' - interval '98' day (3) group by l_returnflag, l_linestatus order by l_returnflag, l_linestatus;","select l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order from lineitem where l_shipdate <= date '1998-12-01' - interval '98' day (3) group by l_returnflag, l_linestatus order by l_returnflag, l_linestatus",[],"[""select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('AIR', 'REG AIR') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1994-01-01' and l_receiptdate < date '1994-01-01' + interval '1' year group by l_shipmode order by l_shipmode;""]","[""['Empty List']""]"
418,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 27 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 27 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('27', '40', '41', '23', '44', '38', '25') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('27', '40', '41', '23', '44', '38', '25') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
419,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'AUTOMOBILE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-05' and l_shipdate > date '1995-03-05' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t1.l_orderkey, SUM(t1.l_extendedprice * (1 - t1.l_discount)) AS revenue, t0.o_orderdate, t0.o_shippriority FROM (SELECT * FROM customer WHERE c_mktsegment = 'AUTOMOBILE') AS t INNER JOIN (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-05') AS t0 ON t.c_custkey = t0.o_custkey INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-05') AS t1 ON t0.o_orderkey = t1.l_orderkey GROUP BY t1.l_orderkey, t0.o_orderdate, t0.o_shippriority ORDER BY SUM(t1.l_extendedprice * (1 - t1.l_discount)) DESC, t0.o_orderdate","['FILTER_INTO_JOIN', 'AGGREGATE_PROJECT_MERGE', 'SORT_PROJECT_TRANSPOSE']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#43' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 10 and l_quantity <= 10 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#22' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 12 and l_quantity <= 12 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#33' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 26 and l_quantity <= 26 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_INTO_JOIN', 'AGGREGATE_PROJECT_MERGE']""]"
420,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1993-10-01' and o_orderdate < date '1993-10-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1993-10-01' and o_orderdate < date '1993-10-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 1 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
421,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'EGYPT' and n2.n_name = 'ETHIOPIA') or (n1.n_name = 'ETHIOPIA' and n2.n_name = 'EGYPT') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation.n_name AS supp_nation, nation0.n_name AS cust_nation, EXTRACT(YEAR FROM t.l_shipdate) AS l_year, SUM(t.l_extendedprice * (1 - t.l_discount)) AS revenue FROM supplier INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t ON supplier.s_suppkey = t.l_suppkey INNER JOIN orders ON t.l_orderkey = orders.o_orderkey INNER JOIN customer ON orders.o_custkey = customer.c_custkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey INNER JOIN nation AS nation0 ON customer.c_nationkey = nation0.n_nationkey AND (nation.n_name = 'EGYPT' AND nation0.n_name = 'ETHIOPIA' OR nation.n_name = 'ETHIOPIA' AND nation0.n_name = 'EGYPT') GROUP BY nation.n_name, nation0.n_name, EXTRACT(YEAR FROM t.l_shipdate) ORDER BY nation.n_name, nation0.n_name, EXTRACT(YEAR FROM t.l_shipdate)","['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_MERGE', 'AGGREGATE_PROJECT_MERGE', 'SORT_PROJECT_TRANSPOSE']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#35' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 6 and l_quantity <= 6 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#24' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 10 and l_quantity <= 10 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#55' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 27 and l_quantity <= 27 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_INTO_JOIN', 'FILTER_MERGE', 'FILTER_CORRELATE', 'JOIN_CONDITION_PUSH', 'JOIN_LEFT_UNION_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE']""]"
422,tpch,"select o_year, sum(case when nation = 'ETHIOPIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY BURNISHED COPPER' ) as all_nations group by o_year order by o_year;","select o_year, sum(case when nation = 'ETHIOPIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY BURNISHED COPPER' ) as all_nations group by o_year order by o_year",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('29', '32', '34', '22', '37', '23', '27') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('29', '32', '34', '22', '37', '23', '27') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
423,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%puff%' ) as profit group by nation, o_year order by nation, o_year desc;","select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%puff%' ) as profit group by nation, o_year order by nation, o_year desc",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('37', '23', '20', '25', '39', '41', '28') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('37', '23', '20', '25', '39', '41', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
424,tpch,"select ps_partkey, sum(ps_supplycost * ps_availqty) as value from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'VIETNAM' group by ps_partkey having sum(ps_supplycost * ps_availqty) > ( select sum(ps_supplycost * ps_availqty) * 0.0001000000 from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'VIETNAM' ) order by value desc;","select ps_partkey, sum(ps_supplycost * ps_availqty) as value from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'VIETNAM' group by ps_partkey having sum(ps_supplycost * ps_availqty) > ( select sum(ps_supplycost * ps_availqty) * 0.0001000000 from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'VIETNAM' ) order by value desc",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('24', '27', '43', '30', '23', '21', '40') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('24', '27', '43', '30', '23', '21', '40') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
425,tpch,"select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('FOB', 'RAIL') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1993-01-01' and l_receiptdate < date '1993-01-01' + interval '1' year group by l_shipmode order by l_shipmode;","SELECT t.l_shipmode, SUM(CASE WHEN orders.o_orderpriority = '1-URGENT' OR orders.o_orderpriority = '2-HIGH' THEN 1 ELSE 0 END) AS high_line_count, SUM(CASE WHEN orders.o_orderpriority <> '1-URGENT' AND orders.o_orderpriority <> '2-HIGH' THEN 1 ELSE 0 END) AS low_line_count FROM orders INNER JOIN (SELECT * FROM lineitem WHERE l_shipmode IN ('FOB', 'RAIL') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= DATE '1993-01-01' AND l_receiptdate < (DATE '1993-01-01' + INTERVAL '1' YEAR)) AS t ON orders.o_orderkey = t.l_orderkey GROUP BY t.l_shipmode ORDER BY t.l_shipmode","['SORT_REMOVE_CONSTANT_KEYS', 'FILTER_INTO_JOIN', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_AGGREGATE_TRANSPOSE']","[""select o_year, sum(case when nation = 'INDIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO PLATED BRASS' ) as all_nations group by o_year order by o_year;""]","[""['SORT_REMOVE_CONSTANT_KEYS', 'JOIN_LEFT_UNION_TRANSPOSE', 'JOIN_RIGHT_UNION_TRANSPOSE', 'FILTER_INTO_JOIN', 'SORT_JOIN_TRANSPOSE', 'FILTER_PROJECT_TRANSPOSE', 'PROJECT_CORRELATE_TRANSPOSE', 'FILTER_AGGREGATE_TRANSPOSE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN']""]"
426,tpch,"select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#34' and p_type not like 'ECONOMY BRUSHED%' and p_size in (21, 5, 47, 29, 19, 16, 32, 43) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;","select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#34' and p_type not like 'ECONOMY BRUSHED%' and p_size in (21, 5, 47, 29, 19, 16, 32, 43) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size",[],"[""select o_year, sum(case when nation = 'FRANCE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE BURNISHED TIN' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
427,tpch,"select sum(l_extendedprice) / 7.0 as avg_yearly from lineitem, part where p_partkey = l_partkey and p_brand = 'Brand#45' and p_container = 'MED CASE' and l_quantity < ( select 0.2 * avg(l_quantity) from lineitem where l_partkey = p_partkey );","SELECT SUM(lineitem.l_extendedprice) / 7.0 AS avg_yearly FROM lineitem INNER JOIN (SELECT * FROM part WHERE p_brand = 'Brand#45' AND p_container = 'MED CASE') AS t ON lineitem.l_partkey = t.p_partkey INNER JOIN (SELECT l_partkey, AVG(l_quantity) AS f1 FROM lineitem GROUP BY l_partkey) AS t1 ON t.p_partkey = t1.l_partkey AND lineitem.l_quantity < 0.2 * t1.f1","['FILTER_AGGREGATE_TRANSPOSE', 'FILTER_INTO_JOIN', 'FILTER_CORRELATE', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_SCAN']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#32' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 5 and l_quantity <= 5 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#22' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 12 and l_quantity <= 12 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#25' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 26 and l_quantity <= 26 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_AGGREGATE_TRANSPOSE', 'FILTER_INTO_JOIN', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_SCAN']""]"
428,tpch,"select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#31' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 6 and l_quantity <= 6 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#53' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 19 and l_quantity <= 19 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#22' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 28 and l_quantity <= 28 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );",SELECT SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS revenue FROM lineitem INNER JOIN part ON lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#31' AND ((part.p_container = 'SM CASE' OR part.p_container = 'SM BOX' OR part.p_container = 'SM PACK' OR part.p_container = 'SM PKG') AND lineitem.l_quantity >= 6) AND (lineitem.l_quantity <= 6 + 10 AND part.p_size >= 1 AND (part.p_size <= 5 AND ((lineitem.l_shipmode = 'AIR' OR lineitem.l_shipmode = 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))) OR lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#53' AND ((part.p_container = 'MED BAG' OR part.p_container = 'MED BOX' OR part.p_container = 'MED PKG' OR part.p_container = 'MED PACK') AND lineitem.l_quantity >= 19) AND (lineitem.l_quantity <= 19 + 10 AND part.p_size >= 1 AND (part.p_size <= 10 AND ((lineitem.l_shipmode = 'AIR' OR lineitem.l_shipmode = 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))) OR lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#22' AND ((part.p_container = 'LG CASE' OR part.p_container = 'LG BOX' OR part.p_container = 'LG PACK' OR part.p_container = 'LG PKG') AND lineitem.l_quantity >= 28) AND (lineitem.l_quantity <= 28 + 10 AND part.p_size >= 1 AND (part.p_size <= 15 AND ((lineitem.l_shipmode = 'AIR' OR lineitem.l_shipmode = 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))),"['FILTER_MERGE', 'FILTER_INTO_JOIN', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#35' and p_type not like 'MEDIUM PLATED%' and p_size in (2, 13, 15, 48, 34, 6, 20, 26) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_PROJECT_MERGE', 'FILTER_INTO_JOIN', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS']""]"
429,tpch,"select s_name, s_address from supplier, nation where s_suppkey in ( select ps_suppkey from partsupp where ps_partkey in ( select p_partkey from part where p_name like 'blanched%' ) and ps_availqty > ( select 0.5 * sum(l_quantity) from lineitem where l_partkey = ps_partkey and l_suppkey = ps_suppkey and l_shipdate >= date '1997-01-01' and l_shipdate < date '1997-01-01' + interval '1' year ) ) and s_nationkey = n_nationkey and n_name = 'JORDAN' order by s_name;","SELECT supplier.s_name, supplier.s_address FROM supplier INNER JOIN (SELECT * FROM nation WHERE n_name = 'JORDAN') AS t ON supplier.s_nationkey = t.n_nationkey INNER JOIN (SELECT partsupp.ps_suppkey FROM partsupp INNER JOIN (SELECT p_partkey FROM part WHERE p_name LIKE 'blanched%' GROUP BY p_partkey) AS t2 ON partsupp.ps_partkey = t2.p_partkey INNER JOIN (SELECT l_partkey, l_suppkey, SUM(l_quantity) AS f2 FROM lineitem WHERE l_shipdate >= DATE '1997-01-01' AND l_shipdate < (DATE '1997-01-01' + INTERVAL '1' YEAR) GROUP BY l_partkey, l_suppkey) AS t5 ON partsupp.ps_partkey = t5.l_partkey AND partsupp.ps_suppkey = t5.l_suppkey AND partsupp.ps_availqty > 0.5 * t5.f2 GROUP BY partsupp.ps_suppkey) AS t8 ON supplier.s_suppkey = t8.ps_suppkey ORDER BY supplier.s_name","['FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'FILTER_REDUCE_EXPRESSIONS', 'SORT_REMOVE_CONSTANT_KEYS']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#44' and p_type not like 'STANDARD ANODIZED%' and p_size in (4, 16, 14, 5, 49, 33, 37, 12) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'FILTER_REDUCE_EXPRESSIONS', 'SORT_REMOVE_CONSTANT_KEYS']""]"
430,tpch,"select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists ( select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey ) and not exists ( select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'UNITED KINGDOM' group by s_name order by numwait desc, s_name;","SELECT t6.s_name, COUNT(*) AS numwait FROM (SELECT supplier.s_suppkey, supplier.s_name, supplier.s_address, supplier.s_nationkey, supplier.s_phone, supplier.s_acctbal, supplier.s_comment, lineitem.l_orderkey, lineitem.l_partkey, lineitem.l_suppkey, lineitem.l_linenumber, lineitem.l_quantity, lineitem.l_extendedprice, lineitem.l_discount, lineitem.l_tax, lineitem.l_returnflag, lineitem.l_linestatus, lineitem.l_shipdate, lineitem.l_commitdate, lineitem.l_receiptdate, lineitem.l_shipinstruct, lineitem.l_shipmode, lineitem.l_comment, orders.o_orderkey, orders.o_custkey, orders.o_orderstatus, orders.o_totalprice, orders.o_orderdate, orders.o_orderpriority, orders.o_clerk, orders.o_shippriority, orders.o_comment, nation.n_nationkey, nation.n_name, nation.n_regionkey, nation.n_comment, t4.f2 AS f0 FROM supplier CROSS JOIN lineitem CROSS JOIN orders CROSS JOIN nation LEFT JOIN (SELECT t0.l_orderkey AS l_orderkey0, t0.l_suppkey AS l_suppkey0, MIN(TRUE) AS f2 FROM lineitem AS lineitem0 INNER JOIN ((SELECT FROM supplier GROUP BY ()) AS t CROSS JOIN (SELECT l_orderkey, l_suppkey FROM lineitem GROUP BY l_orderkey, l_suppkey) AS t0 CROSS JOIN (SELECT FROM orders GROUP BY ()) AS t1 CROSS JOIN (SELECT FROM nation GROUP BY ()) AS t2) ON lineitem0.l_orderkey = t0.l_orderkey AND lineitem0.l_suppkey <> t0.l_suppkey GROUP BY t0.l_orderkey, t0.l_suppkey) AS t4 ON lineitem.l_orderkey = t4.l_orderkey0 AND lineitem.l_suppkey = t4.l_suppkey0 WHERE supplier.s_suppkey = lineitem.l_suppkey AND (orders.o_orderkey = lineitem.l_orderkey AND orders.o_orderstatus = 'F') AND (lineitem.l_receiptdate > lineitem.l_commitdate AND supplier.s_nationkey = nation.n_nationkey AND (nation.n_name = 'UNITED KINGDOM' AND t4.f2 IS NOT NULL))) AS t6 LEFT JOIN (SELECT t15.l_orderkey AS l_orderkey0, t15.l_suppkey AS l_suppkey0, MIN(TRUE) AS f2 FROM (SELECT * FROM lineitem WHERE l_receiptdate > l_commitdate) AS t7 INNER JOIN (SELECT lineitem3.l_orderkey, lineitem3.l_suppkey FROM supplier AS supplier1 CROSS JOIN lineitem AS lineitem3 CROSS JOIN orders AS orders1 CROSS JOIN nation AS nation1 LEFT JOIN (SELECT t9.l_orderkey AS l_orderkey0, t9.l_suppkey AS l_suppkey0, MIN(TRUE) AS f2 FROM lineitem AS lineitem4 INNER JOIN ((SELECT FROM supplier GROUP BY ()) AS t8 CROSS JOIN (SELECT l_orderkey, l_suppkey FROM lineitem GROUP BY l_orderkey, l_suppkey) AS t9 CROSS JOIN (SELECT FROM orders GROUP BY ()) AS t10 CROSS JOIN (SELECT FROM nation GROUP BY ()) AS t11) ON lineitem4.l_orderkey = t9.l_orderkey AND lineitem4.l_suppkey <> t9.l_suppkey GROUP BY t9.l_orderkey, t9.l_suppkey) AS t13 ON lineitem3.l_orderkey = t13.l_orderkey0 AND lineitem3.l_suppkey = t13.l_suppkey0 WHERE supplier1.s_suppkey = lineitem3.l_suppkey AND (orders1.o_orderkey = lineitem3.l_orderkey AND orders1.o_orderstatus = 'F') AND (lineitem3.l_receiptdate > lineitem3.l_commitdate AND supplier1.s_nationkey = nation1.n_nationkey AND (nation1.n_name = 'UNITED KINGDOM' AND t13.f2 IS NOT NULL)) GROUP BY lineitem3.l_orderkey, lineitem3.l_suppkey) AS t15 ON t7.l_orderkey = t15.l_orderkey AND t7.l_suppkey <> t15.l_suppkey GROUP BY t15.l_orderkey, t15.l_suppkey) AS t17 ON t6.l_orderkey = t17.l_orderkey0 AND t6.l_suppkey = t17.l_suppkey0 WHERE t17.f2 IS NULL GROUP BY t6.s_name ORDER BY COUNT(*) DESC, t6.s_name","['FILTER_INTO_JOIN', 'FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_PROJECT_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'SORT_REMOVE_CONSTANT_KEYS']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#15' and p_type not like 'PROMO BURNISHED%' and p_size in (43, 48, 39, 31, 28, 30, 45, 42) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_INTO_JOIN', 'FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_PROJECT_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'AGGREGATE_UNION_TRANSPOSE', 'AGGREGATE_REMOVE', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'SORT_REMOVE_CONSTANT_KEYS']""]"
431,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('33', '28', '27', '35', '41', '40', '43') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('33', '28', '27', '35', '41', '40', '43') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(t.c_phone) + 1) < 1 THEN CHAR_LENGTH(t.c_phone) + 1 ELSE 1 END FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '33' OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '28' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '27') OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '35' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '41' OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '40' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '43'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '33' OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '28' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '27') OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '35' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '41' OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '40' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '43')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, MIN(TRUE) AS f1 FROM orders GROUP BY o_custkey) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f1 IS NULL GROUP BY SUBSTR(t.c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(t.c_phone) + 1) < 1 THEN CHAR_LENGTH(t.c_phone) + 1 ELSE 1 END FOR 2) ORDER BY SUBSTR(t.c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(t.c_phone) + 1) < 1 THEN CHAR_LENGTH(t.c_phone) + 1 ELSE 1 END FOR 2)","['FILTER_REDUCE_EXPRESSIONS', 'FILTER_AGGREGATE_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE']","[""select o_year, sum(case when nation = 'RUSSIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM POLISHED TIN' ) as all_nations group by o_year order by o_year;""]","[""['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_TO_CALC', 'FILTER_INTO_JOIN']""]"
432,tpch,"select l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order from lineitem where l_shipdate <= date '1998-12-01' - interval '76' day (3) group by l_returnflag, l_linestatus order by l_returnflag, l_linestatus;","select l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order from lineitem where l_shipdate <= date '1998-12-01' - interval '76' day (3) group by l_returnflag, l_linestatus order by l_returnflag, l_linestatus",[],"[""select o_year, sum(case when nation = 'CHINA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE ANODIZED NICKEL' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
433,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 26 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 26 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey",[],"[""select o_year, sum(case when nation = 'MOZAMBIQUE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL POLISHED TIN' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
434,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'MACHINERY' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-03' and l_shipdate > date '1995-03-03' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t2.l_orderkey, SUM(t2.l_extendedprice * (1 - t2.l_discount)) AS revenue, t1.o_orderdate, t1.o_shippriority FROM (SELECT * FROM (SELECT * FROM customer WHERE c_mktsegment = 'MACHINERY') AS t, (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-03') AS t0 WHERE t.c_custkey = t0.o_custkey) AS t1, (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-03') AS t2 WHERE t2.l_orderkey = t1.o_orderkey GROUP BY t2.l_orderkey, t1.o_orderdate, t1.o_shippriority ORDER BY SUM(t2.l_extendedprice * (1 - t2.l_discount)) DESC, t1.o_orderdate","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_AGGREGATE_TRANSPOSE']","[""select o_year, sum(case when nation = 'IRAQ' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY BRUSHED TIN' ) as all_nations group by o_year order by o_year;""]","[""['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_TO_CALC', 'FILTER_INTO_JOIN']""]"
435,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1993-05-01' and o_orderdate < date '1993-05-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1993-05-01' and o_orderdate < date '1993-05-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority",[],"[""select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%papaya%' ) as profit group by nation, o_year order by nation, o_year desc;""]","[""['Empty List']""]"
436,tpch,select sum(l_extendedprice * l_discount) as revenue from lineitem where l_shipdate >= date '1993-01-01' and l_shipdate < date '1993-01-01' + interval '1' year and l_discount between 0.04 - 0.01 and 0.04 + 0.01 and l_quantity < 24;,select sum(l_extendedprice * l_discount) as revenue from lineitem where l_shipdate >= date '1993-01-01' and l_shipdate < date '1993-01-01' + interval '1' year and l_discount between 0.04 - 0.01 and 0.04 + 0.01 and l_quantity < 24,[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('34', '27', '38', '29', '25', '41', '26') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('34', '27', '38', '29', '25', '41', '26') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
437,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'INDIA' and n2.n_name = 'VIETNAM') or (n1.n_name = 'VIETNAM' and n2.n_name = 'INDIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation.n_name AS supp_nation, nation0.n_name AS cust_nation, EXTRACT(YEAR FROM lineitem.l_shipdate) AS l_year, SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS revenue FROM supplier, lineitem, orders, customer, nation, nation AS nation0 WHERE supplier.s_suppkey = lineitem.l_suppkey AND (orders.o_orderkey = lineitem.l_orderkey AND customer.c_custkey = orders.o_custkey) AND (supplier.s_nationkey = nation.n_nationkey AND customer.c_nationkey = nation0.n_nationkey AND ((nation.n_name = 'INDIA' AND nation0.n_name = 'VIETNAM' OR nation.n_name = 'VIETNAM' AND nation0.n_name = 'INDIA') AND (lineitem.l_shipdate >= DATE '1995-01-01' AND lineitem.l_shipdate <= DATE '1996-12-31'))) GROUP BY nation.n_name, nation0.n_name, EXTRACT(YEAR FROM lineitem.l_shipdate) ORDER BY nation.n_name, nation0.n_name, EXTRACT(YEAR FROM lineitem.l_shipdate)","['FILTER_MERGE', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_SCAN', 'JOIN_CONDITION_PUSH', 'JOIN_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE', 'SORT_REMOVE']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#32' and p_type not like 'SMALL POLISHED%' and p_size in (48, 26, 6, 13, 47, 37, 18, 2) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_MERGE', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_SCAN', 'JOIN_CONDITION_PUSH', 'JOIN_REDUCE_EXPRESSIONS', 'SORT_REMOVE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_REMOVE']""]"
438,tpch,"select o_year, sum(case when nation = 'INDIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO BURNISHED TIN' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t0.o_orderdate) AS o_year, SUM(CASE WHEN nation0.n_name = 'INDIA' THEN lineitem.l_extendedprice * (1 - lineitem.l_discount) ELSE 0 END) / SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'PROMO BURNISHED TIN') AS t CROSS JOIN supplier INNER JOIN lineitem ON t.p_partkey = lineitem.l_partkey AND supplier.s_suppkey = lineitem.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t0 ON lineitem.l_orderkey = t0.o_orderkey INNER JOIN customer ON t0.o_custkey = customer.c_custkey INNER JOIN nation ON customer.c_nationkey = nation.n_nationkey INNER JOIN nation AS nation0 ON supplier.s_nationkey = nation0.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'ASIA') AS t1 ON nation.n_regionkey = t1.r_regionkey GROUP BY EXTRACT(YEAR FROM t0.o_orderdate) ORDER BY EXTRACT(YEAR FROM t0.o_orderdate)","['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'AGGREGATE_PROJECT_MERGE', 'FILTER_PROJECT_TRANSPOSE']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#45' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 8 and l_quantity <= 8 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#43' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 18 and l_quantity <= 18 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#13' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 26 and l_quantity <= 26 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH']""]"
439,tpch,"select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from customer, orders, lineitem, nation where c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate >= date '1994-08-01' and o_orderdate < date '1994-08-01' + interval '3' month and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc;","SELECT customer.c_custkey, customer.c_name, SUM(t0.l_extendedprice * (1 - t0.l_discount)) AS revenue, customer.c_acctbal, nation.n_name, customer.c_address, customer.c_phone, customer.c_comment FROM customer INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1994-08-01' AND o_orderdate < (DATE '1994-08-01' + INTERVAL '3' MONTH)) AS t ON customer.c_custkey = t.o_custkey INNER JOIN (SELECT * FROM lineitem WHERE l_returnflag = 'R') AS t0 ON t.o_orderkey = t0.l_orderkey INNER JOIN nation ON customer.c_nationkey = nation.n_nationkey GROUP BY customer.c_custkey, customer.c_name, customer.c_acctbal, customer.c_phone, nation.n_name, customer.c_address, customer.c_comment ORDER BY SUM(t0.l_extendedprice * (1 - t0.l_discount)) DESC","['FILTER_INTO_JOIN', 'FILTER_AGGREGATE_TRANSPOSE', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#53' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 10 and l_quantity <= 10 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#45' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 16 and l_quantity <= 16 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#13' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 20 and l_quantity <= 20 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_INTO_JOIN', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_REMOVE']""]"
440,tpch,"select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('MAIL', 'REG AIR') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1993-01-01' and l_receiptdate < date '1993-01-01' + interval '1' year group by l_shipmode order by l_shipmode;","SELECT t.l_shipmode, SUM(CASE WHEN orders.o_orderpriority = '1-URGENT' OR orders.o_orderpriority = '2-HIGH' THEN 1 ELSE 0 END) AS high_line_count, SUM(CASE WHEN orders.o_orderpriority <> '1-URGENT' AND orders.o_orderpriority <> '2-HIGH' THEN 1 ELSE 0 END) AS low_line_count FROM orders INNER JOIN (SELECT * FROM lineitem WHERE l_shipmode IN ('MAIL', 'REG AIR') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= DATE '1993-01-01' AND l_receiptdate < (DATE '1993-01-01' + INTERVAL '1' YEAR)) AS t ON orders.o_orderkey = t.l_orderkey GROUP BY t.l_shipmode ORDER BY t.l_shipmode","['FILTER_AGGREGATE_TRANSPOSE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE']","[""select o_year, sum(case when nation = 'GERMANY' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO POLISHED STEEL' ) as all_nations group by o_year order by o_year;""]","[""['AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'AGGREGATE_PROJECT_MERGE', 'FILTER_AGGREGATE_TRANSPOSE', 'FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'SEMI_JOIN_REMOVE', 'JOIN_REDUCE_EXPRESSIONS', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'SORT_UNION_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE']""]"
441,tpch,"select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#21' and p_type not like 'ECONOMY POLISHED%' and p_size in (7, 42, 20, 12, 44, 37, 9, 15) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;","select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#21' and p_type not like 'ECONOMY POLISHED%' and p_size in (7, 42, 20, 12, 44, 37, 9, 15) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size",[],"[""select o_year, sum(case when nation = 'PERU' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY POLISHED COPPER' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
442,tpch,"select sum(l_extendedprice) / 7.0 as avg_yearly from lineitem, part where p_partkey = l_partkey and p_brand = 'Brand#14' and p_container = 'SM PKG' and l_quantity < ( select 0.2 * avg(l_quantity) from lineitem where l_partkey = p_partkey );","SELECT SUM(lineitem.l_extendedprice) / 7.0 AS avg_yearly FROM lineitem INNER JOIN (SELECT * FROM part WHERE p_brand = 'Brand#14' AND p_container = 'SM PKG') AS t ON lineitem.l_partkey = t.p_partkey INNER JOIN (SELECT l_partkey, AVG(l_quantity) AS f1 FROM lineitem GROUP BY l_partkey) AS t0 ON t.p_partkey = t0.l_partkey AND lineitem.l_quantity < 0.2 * t0.f1","['FILTER_SCAN', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'JOIN_PROJECT_RIGHT_TRANSPOSE', 'AGGREGATE_ANY_PULL_UP_CONSTANTS', 'AGGREGATE_PROJECT_MERGE']","[""select 100.00 * sum(case when p_type like 'PROMO%' then l_extendedprice * (1 - l_discount) else 0 end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from lineitem, part where l_partkey = p_partkey and l_shipdate >= date '1994-06-01' and l_shipdate < date '1994-06-01' + interval '1' month;""]","[""['FILTER_SCAN', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'JOIN_PROJECT_RIGHT_TRANSPOSE', 'PROJECT_CALC_MERGE', 'PROJECT_CORRELATE_TRANSPOSE', 'CALC_MERGE', 'CALC_REMOVE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_PROJECT_MERGE']""]"
443,tpch,"select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#15' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 1 and l_quantity <= 1 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#21' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 12 and l_quantity <= 12 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#54' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 23 and l_quantity <= 23 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );",SELECT SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS revenue FROM lineitem INNER JOIN part ON lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#15' AND ((part.p_container = 'SM CASE' OR part.p_container = 'SM BOX' OR part.p_container = 'SM PACK' OR part.p_container = 'SM PKG') AND lineitem.l_quantity >= 1) AND (lineitem.l_quantity <= 1 + 10 AND part.p_size >= 1 AND (part.p_size <= 5 AND ((lineitem.l_shipmode = 'AIR' OR lineitem.l_shipmode = 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))) OR lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#21' AND ((part.p_container = 'MED BAG' OR part.p_container = 'MED BOX' OR part.p_container = 'MED PKG' OR part.p_container = 'MED PACK') AND lineitem.l_quantity >= 12) AND (lineitem.l_quantity <= 12 + 10 AND part.p_size >= 1 AND (part.p_size <= 10 AND ((lineitem.l_shipmode = 'AIR' OR lineitem.l_shipmode = 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))) OR lineitem.l_partkey = part.p_partkey AND part.p_brand = 'Brand#54' AND ((part.p_container = 'LG CASE' OR part.p_container = 'LG BOX' OR part.p_container = 'LG PACK' OR part.p_container = 'LG PKG') AND lineitem.l_quantity >= 23) AND (lineitem.l_quantity <= 23 + 10 AND part.p_size >= 1 AND (part.p_size <= 15 AND ((lineitem.l_shipmode = 'AIR' OR lineitem.l_shipmode = 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))),"['FILTER_MERGE', 'FILTER_INTO_JOIN', 'PROJECT_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#55' and p_type not like 'LARGE POLISHED%' and p_size in (48, 35, 37, 8, 38, 3, 6, 1) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_INTO_JOIN', 'FILTER_AGGREGATE_TRANSPOSE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_REMOVE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE']""]"
444,tpch,"select s_name, s_address from supplier, nation where s_suppkey in ( select ps_suppkey from partsupp where ps_partkey in ( select p_partkey from part where p_name like 'seashell%' ) and ps_availqty > ( select 0.5 * sum(l_quantity) from lineitem where l_partkey = ps_partkey and l_suppkey = ps_suppkey and l_shipdate >= date '1994-01-01' and l_shipdate < date '1994-01-01' + interval '1' year ) ) and s_nationkey = n_nationkey and n_name = 'EGYPT' order by s_name;","SELECT supplier.s_name, supplier.s_address FROM supplier INNER JOIN (SELECT * FROM nation WHERE n_name = 'EGYPT') AS t ON supplier.s_nationkey = t.n_nationkey INNER JOIN (SELECT partsupp.ps_suppkey FROM partsupp INNER JOIN (SELECT p_partkey FROM part WHERE p_name LIKE 'seashell%' GROUP BY p_partkey) AS t2 ON partsupp.ps_partkey = t2.p_partkey INNER JOIN (SELECT l_partkey, l_suppkey, SUM(l_quantity) AS f2 FROM lineitem WHERE l_shipdate >= DATE '1994-01-01' AND l_shipdate < (DATE '1994-01-01' + INTERVAL '1' YEAR) GROUP BY l_partkey, l_suppkey) AS t5 ON partsupp.ps_partkey = t5.l_partkey AND partsupp.ps_suppkey = t5.l_suppkey AND partsupp.ps_availqty > 0.5 * t5.f2 GROUP BY partsupp.ps_suppkey) AS t8 ON supplier.s_suppkey = t8.ps_suppkey ORDER BY supplier.s_name","['FILTER_SCAN', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_CORRELATE']","[""select o_year, sum(case when nation = 'FRANCE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'EUROPE' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY POLISHED BRASS' ) as all_nations group by o_year order by o_year;""]","[""['FILTER_SCAN', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'JOIN_LEFT_UNION_TRANSPOSE', 'FILTER_PROJECT_TRANSPOSE', 'PROJECT_CORRELATE_TRANSPOSE', 'PROJECT_REMOVE', 'AGGREGATE_PROJECT_MERGE']""]"
445,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('24', '41', '37', '20', '27', '31', '21') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('24', '41', '37', '20', '27', '31', '21') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","SELECT SUBSTR(t.c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(t.c_phone) + 1) < 1 THEN CHAR_LENGTH(t.c_phone) + 1 ELSE 1 END FOR 2) AS cntrycode, COUNT(*) AS numcust, SUM(t.c_acctbal) AS totacctbal FROM (SELECT * FROM customer WHERE SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '24' OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '41' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '37') OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '20' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '27' OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '31' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '21'))) AS t INNER JOIN (SELECT AVG(c_acctbal) AS EXPR0 FROM customer WHERE c_acctbal > 0.00 AND (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '24' OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '41' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '37') OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '20' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '27' OR (SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '31' OR SUBSTR(c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(c_phone) + 1) < 1 THEN CHAR_LENGTH(c_phone) + 1 ELSE 1 END FOR 2) = '21')))) AS t1 ON t.c_acctbal > t1.EXPR0 LEFT JOIN (SELECT o_custkey, MIN(TRUE) AS f1 FROM orders GROUP BY o_custkey) AS t3 ON t.c_custkey = t3.o_custkey WHERE t3.f1 IS NULL GROUP BY SUBSTR(t.c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(t.c_phone) + 1) < 1 THEN CHAR_LENGTH(t.c_phone) + 1 ELSE 1 END FOR 2) ORDER BY SUBSTR(t.c_phone FROM CASE WHEN 1 + (CHAR_LENGTH(t.c_phone) + 1) < 1 THEN CHAR_LENGTH(t.c_phone) + 1 ELSE 1 END FOR 2)","['FILTER_REDUCE_EXPRESSIONS', 'FILTER_AGGREGATE_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE']","[""select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'HOUSEHOLD' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-16' and l_shipdate > date '1995-03-16' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;""]","[""['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_INTO_JOIN', 'PROJECT_TO_CALC', 'JOIN_EXTRACT_FILTER']""]"
446,tpch,"select l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order from lineitem where l_shipdate <= date '1998-12-01' - interval '88' day (3) group by l_returnflag, l_linestatus order by l_returnflag, l_linestatus;","SELECT l_returnflag, l_linestatus, SUM(l_quantity) AS sum_qty, SUM(l_extendedprice) AS sum_base_price, SUM(l_extendedprice * (1 - l_discount)) AS sum_disc_price, SUM(l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS sum_charge, AVG(l_quantity) AS avg_qty, AVG(l_extendedprice) AS avg_price, AVG(l_discount) AS avg_disc, COUNT(*) AS count_order FROM lineitem WHERE l_shipdate <= (DATE '1998-12-01' - INTERVAL '88' DAY(3)) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus","['FILTER_SCAN', 'AGGREGATE_PROJECT_MERGE']","[""select o_year, sum(case when nation = 'MOZAMBIQUE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL BRUSHED TIN' ) as all_nations group by o_year order by o_year;""]","[""['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_TO_CALC', 'FILTER_INTO_JOIN']""]"
447,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 20 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 20 and p_type like '%STEEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 28 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
448,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'AUTOMOBILE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-03' and l_shipdate > date '1995-03-03' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t1.l_orderkey, SUM(t1.l_extendedprice * (1 - t1.l_discount)) AS revenue, t0.o_orderdate, t0.o_shippriority FROM (SELECT * FROM customer WHERE c_mktsegment = 'AUTOMOBILE') AS t INNER JOIN (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-03') AS t0 ON t.c_custkey = t0.o_custkey INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-03') AS t1 ON t0.o_orderkey = t1.l_orderkey GROUP BY t1.l_orderkey, t0.o_orderdate, t0.o_shippriority ORDER BY SUM(t1.l_extendedprice * (1 - t1.l_discount)) DESC, t0.o_orderdate","['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_MERGE', 'AGGREGATE_PROJECT_MERGE', 'SORT_REMOVE', 'SORT_PROJECT_TRANSPOSE', 'PROJECT_REDUCE_EXPRESSIONS']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#42' and p_type not like 'MEDIUM ANODIZED%' and p_size in (30, 17, 13, 1, 33, 47, 24, 48) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'FILTER_INTO_JOIN', 'FILTER_MERGE', 'JOIN_CONDITION_PUSH', 'SORT_REMOVE', 'SORT_PROJECT_TRANSPOSE', 'PROJECT_REDUCE_EXPRESSIONS', 'PROJECT_MERGE']""]"
449,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1993-06-01' and o_orderdate < date '1993-06-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","SELECT t.o_orderpriority, COUNT(*) AS order_count FROM (SELECT * FROM orders WHERE o_orderdate >= DATE '1993-06-01' AND o_orderdate < (DATE '1993-06-01' + INTERVAL '3' MONTH)) AS t INNER JOIN (SELECT l_orderkey, MIN(TRUE) AS f1 FROM lineitem WHERE l_commitdate < l_receiptdate GROUP BY l_orderkey) AS t2 ON t.o_orderkey = t2.l_orderkey GROUP BY t.o_orderpriority ORDER BY t.o_orderpriority","['FILTER_AGGREGATE_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#13' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 5 and l_quantity <= 5 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#51' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 13 and l_quantity <= 13 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#41' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 29 and l_quantity <= 29 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['AGGREGATE_PROJECT_MERGE', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH']""]"
450,tpch,select sum(l_extendedprice * l_discount) as revenue from lineitem where l_shipdate >= date '1997-01-01' and l_shipdate < date '1997-01-01' + interval '1' year and l_discount between 0.05 - 0.01 and 0.05 + 0.01 and l_quantity < 25;,SELECT SUM(l_extendedprice * l_discount) AS revenue FROM lineitem WHERE l_shipdate >= DATE '1997-01-01' AND l_shipdate < (DATE '1997-01-01' + INTERVAL '1' YEAR) AND l_discount >= 0.05 - 0.01 AND l_discount <= 0.05 + 0.01 AND l_quantity < 25,['FILTER_REDUCE_EXPRESSIONS'],"[""select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and o_orderdate >= date '1993-01-01' and o_orderdate < date '1993-01-01' + interval '1' year group by n_name order by revenue desc;""]","[""['FILTER_INTO_JOIN']""]"
451,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'IRAQ' and n2.n_name = 'MOROCCO') or (n1.n_name = 'MOROCCO' and n2.n_name = 'IRAQ') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'IRAQ' and n2.n_name = 'MOROCCO') or (n1.n_name = 'MOROCCO' and n2.n_name = 'IRAQ') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 6 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
452,tpch,"select o_year, sum(case when nation = 'MOROCCO' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO PLATED STEEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t0.o_orderdate) AS o_year, SUM(CASE WHEN nation0.n_name = 'MOROCCO' THEN lineitem.l_extendedprice * (1 - lineitem.l_discount) ELSE 0 END) / SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'PROMO PLATED STEEL') AS t CROSS JOIN supplier INNER JOIN lineitem ON t.p_partkey = lineitem.l_partkey AND supplier.s_suppkey = lineitem.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t0 ON lineitem.l_orderkey = t0.o_orderkey INNER JOIN customer ON t0.o_custkey = customer.c_custkey INNER JOIN nation ON customer.c_nationkey = nation.n_nationkey INNER JOIN nation AS nation0 ON supplier.s_nationkey = nation0.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1 ON nation.n_regionkey = t1.r_regionkey GROUP BY EXTRACT(YEAR FROM t0.o_orderdate) ORDER BY EXTRACT(YEAR FROM t0.o_orderdate)","['FILTER_INTO_JOIN', 'FILTER_SCAN', 'AGGREGATE_PROJECT_MERGE', 'PROJECT_REDUCE_EXPRESSIONS']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#33' and p_type not like 'PROMO ANODIZED%' and p_size in (36, 17, 26, 46, 41, 40, 12, 28) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_INTO_JOIN', 'FILTER_SCAN', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_REMOVE', 'PROJECT_REDUCE_EXPRESSIONS', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE']""]"
453,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%thistle%' ) as profit group by nation, o_year order by nation, o_year desc;","SELECT nation.n_name AS nation, EXTRACT(YEAR FROM orders.o_orderdate) AS o_year, SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount) - partsupp.ps_supplycost * lineitem.l_quantity) AS sum_profit FROM part, supplier, lineitem, partsupp, orders, nation WHERE supplier.s_suppkey = lineitem.l_suppkey AND (partsupp.ps_suppkey = lineitem.l_suppkey AND partsupp.ps_partkey = lineitem.l_partkey) AND (part.p_partkey = lineitem.l_partkey AND orders.o_orderkey = lineitem.l_orderkey AND (supplier.s_nationkey = nation.n_nationkey AND part.p_name LIKE '%thistle%')) GROUP BY nation.n_name, EXTRACT(YEAR FROM orders.o_orderdate) ORDER BY nation.n_name, EXTRACT(YEAR FROM orders.o_orderdate) DESC","['FILTER_SCAN', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_MERGE', 'JOIN_CONDITION_PUSH', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_ANY_PULL_UP_CONSTANTS', 'PROJECT_REDUCE_EXPRESSIONS', 'SORT_REMOVE_CONSTANT_KEYS']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#52' and p_type not like 'PROMO BURNISHED%' and p_size in (4, 48, 16, 3, 43, 1, 21, 44) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_SCAN', 'FILTER_TABLE_FUNCTION_TRANSPOSE', 'FILTER_REDUCE_EXPRESSIONS', 'FILTER_PROJECT_TRANSPOSE', 'FILTER_MERGE', 'JOIN_CONDITION_PUSH', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'JOIN_RIGHT_UNION_TRANSPOSE', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'AGGREGATE_REMOVE', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_ANY_PULL_UP_CONSTANTS', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_UNION_TRANSPOSE', 'AGGREGATE_VALUES', 'PROJECT_REDUCE_EXPRESSIONS', 'SORT_REMOVE_CONSTANT_KEYS']""]"
454,tpch,"select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from customer, orders, lineitem, nation where c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate >= date '1994-04-01' and o_orderdate < date '1994-04-01' + interval '3' month and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc;","select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from customer, orders, lineitem, nation where c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate >= date '1994-04-01' and o_orderdate < date '1994-04-01' + interval '3' month and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc",[],"[""select o_year, sum(case when nation = 'PERU' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL POLISHED NICKEL' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
455,tpch,"select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('SHIP', 'MAIL') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1993-01-01' and l_receiptdate < date '1993-01-01' + interval '1' year group by l_shipmode order by l_shipmode;","select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('SHIP', 'MAIL') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1993-01-01' and l_receiptdate < date '1993-01-01' + interval '1' year group by l_shipmode order by l_shipmode",[],"[""select o_year, sum(case when nation = 'BRAZIL' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'SMALL BURNISHED STEEL' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
456,tpch,"select 100.00 * sum(case when p_type like 'PROMO%' then l_extendedprice * (1 - l_discount) else 0 end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from lineitem, part where l_partkey = p_partkey and l_shipdate >= date '1993-05-01' and l_shipdate < date '1993-05-01' + interval '1' month;","select 100.00 * sum(case when p_type like 'PROMO%' then l_extendedprice * (1 - l_discount) else 0 end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from lineitem, part where l_partkey = p_partkey and l_shipdate >= date '1993-05-01' and l_shipdate < date '1993-05-01' + interval '1' month",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 39 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AMERICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
457,tpch,"select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#54' and p_type not like 'LARGE PLATED%' and p_size in (30, 7, 9, 2, 27, 6, 11, 4) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;","select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#54' and p_type not like 'LARGE PLATED%' and p_size in (30, 7, 9, 2, 27, 6, 11, 4) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 21 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
458,tpch,"select sum(l_extendedprice) / 7.0 as avg_yearly from lineitem, part where p_partkey = l_partkey and p_brand = 'Brand#43' and p_container = 'MED DRUM' and l_quantity < ( select 0.2 * avg(l_quantity) from lineitem where l_partkey = p_partkey );","SELECT SUM(lineitem.l_extendedprice) / 7.0 AS avg_yearly FROM lineitem INNER JOIN (SELECT * FROM part WHERE p_brand = 'Brand#43' AND p_container = 'MED DRUM') AS t ON lineitem.l_partkey = t.p_partkey INNER JOIN (SELECT l_partkey, AVG(l_quantity) AS f1 FROM lineitem GROUP BY l_partkey) AS t1 ON t.p_partkey = t1.l_partkey AND lineitem.l_quantity < 0.2 * t1.f1","['FILTER_INTO_JOIN', 'FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'FILTER_AGGREGATE_TRANSPOSE']","[""select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'AUTOMOBILE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-16' and l_shipdate > date '1995-03-16' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;""]","[""['FILTER_INTO_JOIN', 'FILTER_AGGREGATE_TRANSPOSE', 'JOIN_CONDITION_PUSH', 'FILTER_SCAN', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'JOIN_EXTRACT_FILTER', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'PROJECT_REMOVE', 'CALC_REMOVE', 'SORT_REMOVE', 'AGGREGATE_REMOVE']""]"
459,tpch,"select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#31' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 2 and l_quantity <= 2 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#11' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 10 and l_quantity <= 10 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#31' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 20 and l_quantity <= 20 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );","select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#31' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 2 and l_quantity <= 2 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#11' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 10 and l_quantity <= 10 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#31' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 20 and l_quantity <= 20 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' )",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 32 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
460,tpch,"select s_name, s_address from supplier, nation where s_suppkey in ( select ps_suppkey from partsupp where ps_partkey in ( select p_partkey from part where p_name like 'brown%' ) and ps_availqty > ( select 0.5 * sum(l_quantity) from lineitem where l_partkey = ps_partkey and l_suppkey = ps_suppkey and l_shipdate >= date '1993-01-01' and l_shipdate < date '1993-01-01' + interval '1' year ) ) and s_nationkey = n_nationkey and n_name = 'ARGENTINA' order by s_name;","SELECT supplier.s_name, supplier.s_address FROM supplier INNER JOIN (SELECT * FROM nation WHERE n_name = 'ARGENTINA') AS t ON supplier.s_nationkey = t.n_nationkey INNER JOIN (SELECT partsupp.ps_suppkey FROM partsupp INNER JOIN (SELECT p_partkey FROM part WHERE p_name LIKE 'brown%' GROUP BY p_partkey) AS t2 ON partsupp.ps_partkey = t2.p_partkey INNER JOIN (SELECT l_partkey, l_suppkey, SUM(l_quantity) AS f2 FROM lineitem WHERE l_shipdate >= DATE '1993-01-01' AND l_shipdate < (DATE '1993-01-01' + INTERVAL '1' YEAR) GROUP BY l_partkey, l_suppkey) AS t5 ON partsupp.ps_partkey = t5.l_partkey AND partsupp.ps_suppkey = t5.l_suppkey AND partsupp.ps_availqty > 0.5 * t5.f2 GROUP BY partsupp.ps_suppkey) AS t8 ON supplier.s_suppkey = t8.ps_suppkey ORDER BY supplier.s_name","['FILTER_INTO_JOIN', 'FILTER_PROJECT_TRANSPOSE', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#45' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 10 and l_quantity <= 10 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#13' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 12 and l_quantity <= 12 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#41' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 29 and l_quantity <= 29 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_INTO_JOIN', 'FILTER_PROJECT_TRANSPOSE', 'JOIN_LEFT_UNION_TRANSPOSE', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'PROJECT_REMOVE', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_REMOVE']""]"
461,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('21', '32', '22', '25', '23', '24', '37') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('21', '32', '22', '25', '23', '24', '37') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('21', '32', '22', '25', '23', '24', '37') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('21', '32', '22', '25', '23', '24', '37') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode",[],"[""select o_year, sum(case when nation = 'JAPAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'LARGE ANODIZED COPPER' ) as all_nations group by o_year order by o_year;""]","[""['Empty List']""]"
462,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 5 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t3.s_acctbal, t3.s_name, t3.n_name, t3.p_partkey, t3.p_mfgr, t3.s_address, t3.s_phone, t3.s_comment FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM part WHERE p_size = 5 AND p_type LIKE '%COPPER') AS t, supplier, partsupp WHERE t.p_partkey = partsupp.ps_partkey AND supplier.s_suppkey = partsupp.ps_suppkey) AS t0, nation WHERE t0.s_nationkey = nation.n_nationkey) AS t1, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t2 WHERE t1.n_regionkey = t2.r_regionkey) AS t3, (SELECT t5.ps_partkey, MIN(t5.ps_supplycost) AS EXPR0 FROM (SELECT * FROM (SELECT * FROM partsupp AS partsupp0, supplier AS supplier0 WHERE supplier0.s_suppkey = partsupp0.ps_suppkey) AS t4, nation AS nation0 WHERE t4.s_nationkey = nation0.n_nationkey) AS t5, (SELECT * FROM region WHERE r_name = 'AFRICA') AS t6 WHERE t5.n_regionkey = t6.r_regionkey GROUP BY t5.ps_partkey) AS t9 WHERE t3.p_partkey = t9.ps_partkey AND t3.ps_supplycost = t9.EXPR0 ORDER BY t3.s_acctbal DESC, t3.n_name, t3.s_name, t3.p_partkey","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_REDUCE_EXPRESSIONS', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED']","[""select o_year, sum(case when nation = 'CANADA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD POLISHED TIN' ) as all_nations group by o_year order by o_year;""]","[""['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_TO_CALC', 'FILTER_INTO_JOIN', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'AGGREGATE_PROJECT_MERGE']""]"
463,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'MACHINERY' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-05' and l_shipdate > date '1995-03-05' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","SELECT t1.l_orderkey, SUM(t1.l_extendedprice * (1 - t1.l_discount)) AS revenue, t0.o_orderdate, t0.o_shippriority FROM (SELECT * FROM customer WHERE c_mktsegment = 'MACHINERY') AS t INNER JOIN (SELECT * FROM orders WHERE o_orderdate < DATE '1995-03-05') AS t0 ON t.c_custkey = t0.o_custkey INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate > DATE '1995-03-05') AS t1 ON t0.o_orderkey = t1.l_orderkey GROUP BY t1.l_orderkey, t0.o_orderdate, t0.o_shippriority ORDER BY SUM(t1.l_extendedprice * (1 - t1.l_discount)) DESC, t0.o_orderdate","['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'AGGREGATE_PROJECT_MERGE']","[""select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1994-02-01' and o_orderdate < date '1994-02-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;""]","[""['AGGREGATE_PROJECT_MERGE']""]"
464,tpch,select sum(l_extendedprice * l_discount) as revenue from lineitem where l_shipdate >= date '1996-01-01' and l_shipdate < date '1996-01-01' + interval '1' year and l_discount between 0.07 - 0.01 and 0.07 + 0.01 and l_quantity < 25;,SELECT SUM(l_extendedprice * l_discount) AS revenue FROM lineitem WHERE l_shipdate >= DATE '1996-01-01' AND l_shipdate < (DATE '1996-01-01' + INTERVAL '1' YEAR) AND l_discount >= 0.07 - 0.01 AND l_discount <= 0.07 + 0.01 AND l_quantity < 25,"['FILTER_REDUCE_EXPRESSIONS', 'FILTER_AGGREGATE_TRANSPOSE']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#44' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 3 and l_quantity <= 3 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#23' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 19 and l_quantity <= 19 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#21' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 25 and l_quantity <= 25 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH']""]"
465,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'MOROCCO' and n2.n_name = 'SAUDI ARABIA') or (n1.n_name = 'SAUDI ARABIA' and n2.n_name = 'MOROCCO') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'MOROCCO' and n2.n_name = 'SAUDI ARABIA') or (n1.n_name = 'SAUDI ARABIA' and n2.n_name = 'MOROCCO') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('21', '34', '27', '36', '31', '30', '25') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('21', '34', '27', '36', '31', '30', '25') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
466,tpch,"select o_year, sum(case when nation = 'SAUDI ARABIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY BRUSHED COPPER' ) as all_nations group by o_year order by o_year;","select o_year, sum(case when nation = 'SAUDI ARABIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'ECONOMY BRUSHED COPPER' ) as all_nations group by o_year order by o_year",[],"[""select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1995-09-01' and o_orderdate < date '1995-09-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;""]","[""['Empty List']""]"
467,tpch,"select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%seashell%' ) as profit group by nation, o_year order by nation, o_year desc;","select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%seashell%' ) as profit group by nation, o_year order by nation, o_year desc",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('44', '39', '29', '31', '26', '22', '27') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('44', '39', '29', '31', '26', '22', '27') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
468,tpch,"select ps_partkey, sum(ps_supplycost * ps_availqty) as value from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'UNITED STATES' group by ps_partkey having sum(ps_supplycost * ps_availqty) > ( select sum(ps_supplycost * ps_availqty) * 0.0001000000 from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'UNITED STATES' ) order by value desc;","select ps_partkey, sum(ps_supplycost * ps_availqty) as value from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'UNITED STATES' group by ps_partkey having sum(ps_supplycost * ps_availqty) > ( select sum(ps_supplycost * ps_availqty) * 0.0001000000 from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'UNITED STATES' ) order by value desc",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('33', '38', '29', '42', '26', '22', '25') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('33', '38', '29', '42', '26', '22', '25') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
469,tpch,"select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#13' and p_type not like 'STANDARD BRUSHED%' and p_size in (45, 1, 16, 9, 44, 47, 26, 28) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;","select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#13' and p_type not like 'STANDARD BRUSHED%' and p_size in (45, 1, 16, 9, 44, 47, 26, 28) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('31', '23', '22', '38', '30', '25', '44') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('31', '23', '22', '38', '30', '25', '44') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
470,tpch,"select sum(l_extendedprice) / 7.0 as avg_yearly from lineitem, part where p_partkey = l_partkey and p_brand = 'Brand#31' and p_container = 'WRAP JAR' and l_quantity < ( select 0.2 * avg(l_quantity) from lineitem where l_partkey = p_partkey );","SELECT SUM(lineitem.l_extendedprice) / 7.0 AS avg_yearly FROM lineitem INNER JOIN (SELECT * FROM part WHERE p_brand = 'Brand#31' AND p_container = 'WRAP JAR') AS t ON lineitem.l_partkey = t.p_partkey INNER JOIN (SELECT l_partkey, AVG(l_quantity) AS f1 FROM lineitem GROUP BY l_partkey) AS t1 ON t.p_partkey = t1.l_partkey AND lineitem.l_quantity < 0.2 * t1.f1","['FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'FILTER_REDUCE_EXPRESSIONS', 'AGGREGATE_ANY_PULL_UP_CONSTANTS']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#12' and p_type not like 'MEDIUM BRUSHED%' and p_size in (39, 25, 44, 35, 1, 47, 5, 15) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN', 'FILTER_CORRELATE', 'FILTER_INTO_JOIN', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REMOVE', 'SORT_REMOVE_CONSTANT_KEYS']""]"
471,tpch,"select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#55' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 5 and l_quantity <= 5 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#21' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 15 and l_quantity <= 15 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#55' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 21 and l_quantity <= 21 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );","SELECT SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS revenue FROM lineitem, part WHERE part.p_partkey = lineitem.l_partkey AND part.p_brand = 'Brand#55' AND (part.p_container IN ('SM BOX', 'SM CASE', 'SM PACK', 'SM PKG') AND lineitem.l_quantity >= 5) AND (lineitem.l_quantity <= 5 + 10 AND (part.p_size >= 1 AND part.p_size <= 5) AND (lineitem.l_shipmode IN ('AIR', 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON')) OR part.p_partkey = lineitem.l_partkey AND part.p_brand = 'Brand#21' AND (part.p_container IN ('MED BAG', 'MED BOX', 'MED PACK', 'MED PKG') AND lineitem.l_quantity >= 15) AND (lineitem.l_quantity <= 15 + 10 AND (part.p_size >= 1 AND part.p_size <= 10) AND (lineitem.l_shipmode IN ('AIR', 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON')) OR part.p_partkey = lineitem.l_partkey AND part.p_brand = 'Brand#55' AND (part.p_container IN ('LG BOX', 'LG CASE', 'LG PACK', 'LG PKG') AND lineitem.l_quantity >= 21) AND (lineitem.l_quantity <= 21 + 10 AND (part.p_size >= 1 AND part.p_size <= 15) AND (lineitem.l_shipmode IN ('AIR', 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))","['FILTER_MERGE', 'FILTER_REDUCE_EXPRESSIONS', 'JOIN_CONDITION_PUSH']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#52' and p_type not like 'STANDARD POLISHED%' and p_size in (36, 9, 31, 39, 27, 33, 26, 13) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'FILTER_INTO_JOIN', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS']""]"
472,tpch,"select s_name, s_address from supplier, nation where s_suppkey in ( select ps_suppkey from partsupp where ps_partkey in ( select p_partkey from part where p_name like 'smoke%' ) and ps_availqty > ( select 0.5 * sum(l_quantity) from lineitem where l_partkey = ps_partkey and l_suppkey = ps_suppkey and l_shipdate >= date '1994-01-01' and l_shipdate < date '1994-01-01' + interval '1' year ) ) and s_nationkey = n_nationkey and n_name = 'BRAZIL' order by s_name;","SELECT supplier.s_name, supplier.s_address FROM supplier INNER JOIN (SELECT * FROM nation WHERE n_name = 'BRAZIL') AS t ON supplier.s_nationkey = t.n_nationkey INNER JOIN (SELECT partsupp.ps_suppkey FROM partsupp INNER JOIN (SELECT p_partkey FROM part WHERE p_name LIKE 'smoke%' GROUP BY p_partkey) AS t2 ON partsupp.ps_partkey = t2.p_partkey INNER JOIN (SELECT l_partkey, l_suppkey, SUM(l_quantity) AS f2 FROM lineitem WHERE l_shipdate >= DATE '1994-01-01' AND l_shipdate < (DATE '1994-01-01' + INTERVAL '1' YEAR) GROUP BY l_partkey, l_suppkey) AS t5 ON partsupp.ps_partkey = t5.l_partkey AND partsupp.ps_suppkey = t5.l_suppkey AND partsupp.ps_availqty > 0.5 * t5.f2 GROUP BY partsupp.ps_suppkey) AS t8 ON supplier.s_suppkey = t8.ps_suppkey ORDER BY supplier.s_name","['FILTER_SCAN', 'JOIN_CONDITION_PUSH', 'FILTER_INTO_JOIN', 'FILTER_MULTI_JOIN_MERGE', 'JOIN_REDUCE_EXPRESSIONS', 'PROJECT_CORRELATE_TRANSPOSE', 'PROJECT_REDUCE_EXPRESSIONS', 'FILTER_AGGREGATE_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE']","[""select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#44' and p_type not like 'LARGE BRUSHED%' and p_size in (6, 19, 13, 9, 17, 16, 10, 41) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;""]","[""['FILTER_SCAN', 'JOIN_CONDITION_PUSH', 'FILTER_INTO_JOIN', 'FILTER_MULTI_JOIN_MERGE', 'JOIN_REDUCE_EXPRESSIONS', 'PROJECT_CORRELATE_TRANSPOSE', 'PROJECT_REDUCE_EXPRESSIONS', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES', 'AGGREGATE_JOIN_TRANSPOSE_EXTENDED', 'AGGREGATE_PROJECT_MERGE', 'FILTER_AGGREGATE_TRANSPOSE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE']""]"
473,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('22', '41', '43', '32', '34', '27', '29') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('22', '41', '43', '32', '34', '27', '29') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('22', '41', '43', '32', '34', '27', '29') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('22', '41', '43', '32', '34', '27', '29') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 8 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
474,tpch,"select l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order from lineitem where l_shipdate <= date '1998-12-01' - interval '120' day (3) group by l_returnflag, l_linestatus order by l_returnflag, l_linestatus;","select l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order from lineitem where l_shipdate <= date '1998-12-01' - interval '120' day (3) group by l_returnflag, l_linestatus order by l_returnflag, l_linestatus",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 29 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
475,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 36 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey;","select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 36 and p_type like '%COPPER' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' ) order by s_acctbal desc, n_name, s_name, p_partkey",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('32', '26', '23', '33', '44', '24', '25') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('32', '26', '23', '33', '44', '24', '25') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
476,tpch,"select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'FURNITURE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-30' and l_shipdate > date '1995-03-30' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate;","select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'FURNITURE' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date '1995-03-30' and l_shipdate > date '1995-03-30' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate",[],"[""select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'UNITED STATES' and n2.n_name = 'ALGERIA') or (n1.n_name = 'ALGERIA' and n2.n_name = 'UNITED STATES') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;""]","[""['Empty List']""]"
477,tpch,"select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1997-09-01' and o_orderdate < date '1997-09-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority;","select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1997-09-01' and o_orderdate < date '1997-09-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 26 and p_type like '%NICKEL' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
478,tpch,"select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and o_orderdate >= date '1994-01-01' and o_orderdate < date '1994-01-01' + interval '1' year group by n_name order by revenue desc;","SELECT t3.n_name, SUM(t3.l_extendedprice * (1 - t3.l_discount)) AS revenue FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM (SELECT * FROM customer, (SELECT * FROM orders WHERE o_orderdate >= DATE '1994-01-01' AND o_orderdate < (DATE '1994-01-01' + INTERVAL '1' YEAR)) AS t WHERE customer.c_custkey = t.o_custkey) AS t0, lineitem WHERE lineitem.l_orderkey = t0.o_orderkey) AS t1, supplier WHERE t1.l_suppkey = supplier.s_suppkey AND t1.c_nationkey = supplier.s_nationkey) AS t2, nation WHERE t2.s_nationkey = nation.n_nationkey) AS t3, (SELECT * FROM region WHERE r_name = 'ASIA') AS t4 WHERE t3.n_regionkey = t4.r_regionkey GROUP BY t3.n_name ORDER BY SUM(t3.l_extendedprice * (1 - t3.l_discount)) DESC","['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'FILTER_REDUCE_EXPRESSIONS']","[""select o_year, sum(case when nation = 'SAUDI ARABIA' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'MIDDLE EAST' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'PROMO POLISHED COPPER' ) as all_nations group by o_year order by o_year;""]","[""['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_TO_CALC', 'FILTER_INTO_JOIN']""]"
479,tpch,select sum(l_extendedprice * l_discount) as revenue from lineitem where l_shipdate >= date '1994-01-01' and l_shipdate < date '1994-01-01' + interval '1' year and l_discount between 0.04 - 0.01 and 0.04 + 0.01 and l_quantity < 25;,SELECT SUM(l_extendedprice * l_discount) AS revenue FROM lineitem WHERE l_shipdate >= DATE '1994-01-01' AND l_shipdate < (DATE '1994-01-01' + INTERVAL '1' YEAR) AND l_discount >= 0.04 - 0.01 AND l_discount <= 0.04 + 0.01 AND l_quantity < 25,['FILTER_REDUCE_EXPRESSIONS'],"[""select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'EGYPT' and n2.n_name = 'JORDAN') or (n1.n_name = 'JORDAN' and n2.n_name = 'EGYPT') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;""]","[""['FILTER_INTO_JOIN']""]"
480,tpch,"select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'INDONESIA' and n2.n_name = 'JAPAN') or (n1.n_name = 'JAPAN' and n2.n_name = 'INDONESIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;","SELECT nation.n_name AS supp_nation, nation0.n_name AS cust_nation, EXTRACT(YEAR FROM t.l_shipdate) AS l_year, SUM(t.l_extendedprice * (1 - t.l_discount)) AS revenue FROM supplier INNER JOIN (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1995-01-01' AND l_shipdate <= DATE '1996-12-31') AS t ON supplier.s_suppkey = t.l_suppkey INNER JOIN orders ON t.l_orderkey = orders.o_orderkey INNER JOIN customer ON orders.o_custkey = customer.c_custkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey INNER JOIN nation AS nation0 ON customer.c_nationkey = nation0.n_nationkey AND (nation.n_name = 'INDONESIA' AND nation0.n_name = 'JAPAN' OR nation.n_name = 'JAPAN' AND nation0.n_name = 'INDONESIA') GROUP BY nation.n_name, nation0.n_name, EXTRACT(YEAR FROM t.l_shipdate) ORDER BY nation.n_name, nation0.n_name, EXTRACT(YEAR FROM t.l_shipdate)","['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS']","[""select supp_nation, cust_nation, l_year, sum(volume) as revenue from ( select n1.n_name as supp_nation, n2.n_name as cust_nation, extract(year from l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ( (n1.n_name = 'INDIA' and n2.n_name = 'IRAN') or (n1.n_name = 'IRAN' and n2.n_name = 'INDIA') ) and l_shipdate between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year;""]","[""['FILTER_INTO_JOIN']""]"
481,tpch,"select o_year, sum(case when nation = 'JAPAN' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'ASIA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'STANDARD BRUSHED NICKEL' ) as all_nations group by o_year order by o_year;","SELECT EXTRACT(YEAR FROM t0.o_orderdate) AS o_year, SUM(CASE WHEN nation0.n_name = 'JAPAN' THEN lineitem.l_extendedprice * (1 - lineitem.l_discount) ELSE 0 END) / SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS mkt_share FROM (SELECT * FROM part WHERE p_type = 'STANDARD BRUSHED NICKEL') AS t CROSS JOIN supplier INNER JOIN lineitem ON t.p_partkey = lineitem.l_partkey AND supplier.s_suppkey = lineitem.l_suppkey INNER JOIN (SELECT * FROM orders WHERE o_orderdate >= DATE '1995-01-01' AND o_orderdate <= DATE '1996-12-31') AS t0 ON lineitem.l_orderkey = t0.o_orderkey INNER JOIN customer ON t0.o_custkey = customer.c_custkey INNER JOIN nation ON customer.c_nationkey = nation.n_nationkey INNER JOIN nation AS nation0 ON supplier.s_nationkey = nation0.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'ASIA') AS t1 ON nation.n_regionkey = t1.r_regionkey GROUP BY EXTRACT(YEAR FROM t0.o_orderdate) ORDER BY EXTRACT(YEAR FROM t0.o_orderdate)","['FILTER_PROJECT_TRANSPOSE', 'FILTER_INTO_JOIN', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'JOIN_CONDITION_PUSH', 'PROJECT_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#23' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 2 and l_quantity <= 2 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#35' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 11 and l_quantity <= 11 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#31' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 20 and l_quantity <= 20 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_PROJECT_TRANSPOSE', 'FILTER_INTO_JOIN', 'JOIN_PROJECT_BOTH_TRANSPOSE', 'JOIN_CONDITION_PUSH', 'PROJECT_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE', 'AGGREGATE_EXPAND_DISTINCT_AGGREGATES']""]"
482,tpch,"select ps_partkey, sum(ps_supplycost * ps_availqty) as value from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'RUSSIA' group by ps_partkey having sum(ps_supplycost * ps_availqty) > ( select sum(ps_supplycost * ps_availqty) * 0.0001000000 from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'RUSSIA' ) order by value desc;","SELECT t1.ps_partkey, t1.value FROM (SELECT partsupp.ps_partkey, SUM(partsupp.ps_supplycost * partsupp.ps_availqty) AS value FROM partsupp, supplier, nation WHERE partsupp.ps_suppkey = supplier.s_suppkey AND supplier.s_nationkey = nation.n_nationkey AND nation.n_name = 'RUSSIA' GROUP BY partsupp.ps_partkey) AS t1 LEFT JOIN (SELECT SUM(partsupp0.ps_supplycost * partsupp0.ps_availqty) * 0.0001000000 AS EXPR0 FROM partsupp AS partsupp0, supplier AS supplier0, nation AS nation0 WHERE partsupp0.ps_suppkey = supplier0.s_suppkey AND supplier0.s_nationkey = nation0.n_nationkey AND nation0.n_name = 'RUSSIA') AS t5 ON TRUE WHERE t1.value > t5.EXPR0 ORDER BY t1.value DESC","['JOIN_CONDITION_PUSH', 'FILTER_REDUCE_EXPRESSIONS', 'AGGREGATE_PROJECT_MERGE', 'SORT_REMOVE_CONSTANT_KEYS']","[""select o_year, sum(case when nation = 'MOZAMBIQUE' then volume else 0 end) / sum(volume) as mkt_share from ( select extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AFRICA' and s_nationkey = n2.n_nationkey and o_orderdate between date '1995-01-01' and date '1996-12-31' and p_type = 'MEDIUM POLISHED NICKEL' ) as all_nations group by o_year order by o_year;""]","[""['JOIN_CONDITION_PUSH', 'FILTER_REDUCE_EXPRESSIONS', 'PROJECT_REDUCE_EXPRESSIONS', 'SORT_REMOVE_CONSTANT_KEYS', 'FILTER_INTO_JOIN']""]"
483,tpch,"select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('MAIL', 'TRUCK') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1994-01-01' and l_receiptdate < date '1994-01-01' + interval '1' year group by l_shipmode order by l_shipmode;","SELECT t.l_shipmode, SUM(CASE WHEN orders.o_orderpriority = '1-URGENT' OR orders.o_orderpriority = '2-HIGH' THEN 1 ELSE 0 END) AS high_line_count, SUM(CASE WHEN orders.o_orderpriority <> '1-URGENT' AND orders.o_orderpriority <> '2-HIGH' THEN 1 ELSE 0 END) AS low_line_count FROM orders INNER JOIN (SELECT * FROM lineitem WHERE l_shipmode IN ('MAIL', 'TRUCK') AND l_commitdate < l_receiptdate AND l_shipdate < l_commitdate AND l_receiptdate >= DATE '1994-01-01' AND l_receiptdate < (DATE '1994-01-01' + INTERVAL '1' YEAR)) AS t ON orders.o_orderkey = t.l_orderkey GROUP BY t.l_shipmode ORDER BY t.l_shipmode","['FILTER_INTO_JOIN', 'FILTER_PROJECT_TRANSPOSE', 'AGGREGATE_PROJECT_MERGE', 'SORT_PROJECT_TRANSPOSE']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#15' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 9 and l_quantity <= 9 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#54' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 15 and l_quantity <= 15 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#14' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 24 and l_quantity <= 24 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_INTO_JOIN', 'AGGREGATE_PROJECT_MERGE']""]"
484,tpch,"select 100.00 * sum(case when p_type like 'PROMO%' then l_extendedprice * (1 - l_discount) else 0 end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from lineitem, part where l_partkey = p_partkey and l_shipdate >= date '1994-04-01' and l_shipdate < date '1994-04-01' + interval '1' month;",SELECT 100.00 * SUM(CASE WHEN part.p_type LIKE 'PROMO%' THEN t.l_extendedprice * (1 - t.l_discount) ELSE 0 END) / SUM(t.l_extendedprice * (1 - t.l_discount)) AS promo_revenue FROM (SELECT * FROM lineitem WHERE l_shipdate >= DATE '1994-04-01' AND l_shipdate < (DATE '1994-04-01' + INTERVAL '1' MONTH)) AS t INNER JOIN part ON t.l_partkey = part.p_partkey,"['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'PROJECT_REDUCE_EXPRESSIONS']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#35' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 9 and l_quantity <= 9 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#35' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 19 and l_quantity <= 19 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#41' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 30 and l_quantity <= 30 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH']""]"
485,tpch,"select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#12' and p_type not like 'LARGE BURNISHED%' and p_size in (17, 46, 40, 6, 44, 16, 15, 49) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size;","select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#12' and p_type not like 'LARGE BURNISHED%' and p_size in (17, 46, 40, 6, 44, 16, 15, 49) and ps_suppkey not in ( select s_suppkey from supplier where s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size",[],"[""select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('SHIP', 'FOB') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date '1996-01-01' and l_receiptdate < date '1996-01-01' + interval '1' year group by l_shipmode order by l_shipmode;""]","[""['Empty List']""]"
486,tpch,"select sum(l_extendedprice) / 7.0 as avg_yearly from lineitem, part where p_partkey = l_partkey and p_brand = 'Brand#23' and p_container = 'LG PACK' and l_quantity < ( select 0.2 * avg(l_quantity) from lineitem where l_partkey = p_partkey );","SELECT SUM(lineitem.l_extendedprice) / 7.0 AS avg_yearly FROM lineitem INNER JOIN (SELECT * FROM part WHERE p_brand = 'Brand#23' AND p_container = 'LG PACK') AS t ON lineitem.l_partkey = t.p_partkey INNER JOIN (SELECT l_partkey, AVG(l_quantity) AS f1 FROM lineitem GROUP BY l_partkey) AS t1 ON t.p_partkey = t1.l_partkey AND lineitem.l_quantity < 0.2 * t1.f1","['FILTER_INTO_JOIN', 'FILTER_SCAN', 'PROJECT_REDUCE_EXPRESSIONS']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#12' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 1 and l_quantity <= 1 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#32' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 20 and l_quantity <= 20 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#55' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 27 and l_quantity <= 27 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_INTO_JOIN', 'FILTER_SCAN', 'PROJECT_REDUCE_EXPRESSIONS']""]"
487,tpch,"select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#25' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 2 and l_quantity <= 2 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#41' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 20 and l_quantity <= 20 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#52' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 28 and l_quantity <= 28 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );","SELECT SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS revenue FROM lineitem, part WHERE part.p_partkey = lineitem.l_partkey AND part.p_brand = 'Brand#25' AND (part.p_container IN ('SM BOX', 'SM CASE', 'SM PACK', 'SM PKG') AND lineitem.l_quantity >= 2) AND (lineitem.l_quantity <= 2 + 10 AND (part.p_size >= 1 AND part.p_size <= 5) AND (lineitem.l_shipmode IN ('AIR', 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON')) OR part.p_partkey = lineitem.l_partkey AND part.p_brand = 'Brand#41' AND (part.p_container IN ('MED BAG', 'MED BOX', 'MED PACK', 'MED PKG') AND lineitem.l_quantity >= 20) AND (lineitem.l_quantity <= 20 + 10 AND (part.p_size >= 1 AND part.p_size <= 10) AND (lineitem.l_shipmode IN ('AIR', 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON')) OR part.p_partkey = lineitem.l_partkey AND part.p_brand = 'Brand#52' AND (part.p_container IN ('LG BOX', 'LG CASE', 'LG PACK', 'LG PKG') AND lineitem.l_quantity >= 28) AND (lineitem.l_quantity <= 28 + 10 AND (part.p_size >= 1 AND part.p_size <= 15) AND (lineitem.l_shipmode IN ('AIR', 'AIR REG') AND lineitem.l_shipinstruct = 'DELIVER IN PERSON'))","['FILTER_INTO_JOIN', 'FILTER_MERGE', 'JOIN_EXTRACT_FILTER', 'PROJECT_REDUCE_EXPRESSIONS']","[""select nation, o_year, sum(amount) as sum_profit from ( select n_name as nation, extract(year from o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%purple%' ) as profit group by nation, o_year order by nation, o_year desc;""]","[""['FILTER_INTO_JOIN', 'JOIN_EXTRACT_FILTER', 'PROJECT_TO_CALC', 'SORT_REMOVE_CONSTANT_KEYS']""]"
488,tpch,"select s_name, s_address from supplier, nation where s_suppkey in ( select ps_suppkey from partsupp where ps_partkey in ( select p_partkey from part where p_name like 'tan%' ) and ps_availqty > ( select 0.5 * sum(l_quantity) from lineitem where l_partkey = ps_partkey and l_suppkey = ps_suppkey and l_shipdate >= date '1996-01-01' and l_shipdate < date '1996-01-01' + interval '1' year ) ) and s_nationkey = n_nationkey and n_name = 'ARGENTINA' order by s_name;","select s_name, s_address from supplier, nation where s_suppkey in ( select ps_suppkey from partsupp where ps_partkey in ( select p_partkey from part where p_name like 'tan%' ) and ps_availqty > ( select 0.5 * sum(l_quantity) from lineitem where l_partkey = ps_partkey and l_suppkey = ps_suppkey and l_shipdate >= date '1996-01-01' and l_shipdate < date '1996-01-01' + interval '1' year ) ) and s_nationkey = n_nationkey and n_name = 'ARGENTINA' order by s_name",[],"[""select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('41', '31', '22', '39', '43', '35', '28') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('41', '31', '22', '39', '43', '35', '28') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;""]","[""['Empty List']""]"
489,tpch,"select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('21', '41', '27', '22', '44', '40', '34') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('21', '41', '27', '22', '44', '40', '34') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode;","select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from ( select substring(c_phone from 1 for 2) as cntrycode, c_acctbal from customer where substring(c_phone from 1 for 2) in ('21', '41', '27', '22', '44', '40', '34') and c_acctbal > ( select avg(c_acctbal) from customer where c_acctbal > 0.00 and substring(c_phone from 1 for 2) in ('21', '41', '27', '22', '44', '40', '34') ) and not exists ( select * from orders where o_custkey = c_custkey ) ) as custsale group by cntrycode order by cntrycode",[],"[""select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 40 and p_type like '%TIN' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' ) order by s_acctbal desc, n_name, s_name, p_partkey;""]","[""['Empty List']""]"
490,tpch,"select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 12 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' and ps_supplycost = ( select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'AFRICA' ) order by s_acctbal desc, n_name, s_name, p_partkey;","SELECT t5.s_acctbal, t5.s_name, t5.n_name, t5.p_partkey, t5.p_mfgr, t5.s_address, t5.s_phone, t5.s_comment FROM (SELECT t.p_partkey, t.p_name, t.p_mfgr, t.p_brand, t.p_type, t.p_size, t.p_container, t.p_retailprice, t.p_comment, supplier.s_suppkey, supplier.s_name, supplier.s_address, supplier.s_nationkey, supplier.s_phone, supplier.s_acctbal, supplier.s_comment, partsupp.ps_partkey, partsupp.ps_suppkey, partsupp.ps_availqty, partsupp.ps_supplycost, partsupp.ps_comment, nation.n_nationkey, nation.n_name, nation.n_regionkey, nation.n_comment, t0.r_regionkey, t0.r_name, t0.r_comment, CAST(t3.ps_partkey AS INTEGER) AS ps_partkey0, CAST(t3.EXPR0 AS DECIMAL(19, 0)) AS EXPR0 FROM (SELECT * FROM part WHERE p_size = 12 AND p_type LIKE '%BRASS') AS t CROSS JOIN supplier INNER JOIN partsupp ON t.p_partkey = partsupp.ps_partkey AND supplier.s_suppkey = partsupp.ps_suppkey INNER JOIN nation ON supplier.s_nationkey = nation.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t0 ON nation.n_regionkey = t0.r_regionkey INNER JOIN (SELECT partsupp0.ps_partkey, MIN(partsupp0.ps_supplycost) AS EXPR0 FROM partsupp AS partsupp0 INNER JOIN supplier AS supplier0 ON partsupp0.ps_suppkey = supplier0.s_suppkey INNER JOIN nation AS nation0 ON supplier0.s_nationkey = nation0.n_nationkey INNER JOIN (SELECT * FROM region WHERE r_name = 'AFRICA') AS t1 ON nation0.n_regionkey = t1.r_regionkey GROUP BY partsupp0.ps_partkey) AS t3 ON t.p_partkey = t3.ps_partkey AND partsupp.ps_supplycost = t3.EXPR0 ORDER BY supplier.s_acctbal DESC, nation.n_name, supplier.s_name, t.p_partkey) AS t5","['FILTER_INTO_JOIN', 'JOIN_CONDITION_PUSH', 'FILTER_AGGREGATE_TRANSPOSE', 'SORT_JOIN_TRANSPOSE', 'SORT_PROJECT_TRANSPOSE']","[""select sum(l_extendedprice* (1 - l_discount)) as revenue from lineitem, part where ( p_partkey = l_partkey and p_brand = 'Brand#31' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 10 and l_quantity <= 10 + 10 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#25' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 17 and l_quantity <= 17 + 10 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' ) or ( p_partkey = l_partkey and p_brand = 'Brand#13' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 20 and l_quantity <= 20 + 10 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON' );""]","[""['FILTER_INTO_JOIN', 'FILTER_AGGREGATE_TRANSPOSE', 'JOIN_CONDITION_PUSH', 'PROJECT_CORRELATE_TRANSPOSE', 'PROJECT_INSTANCE', 'CALC_MERGE', 'CALC_REMOVE', 'SORT_REMOVE_CONSTANT_KEYS', 'SORT_REMOVE']""]"
